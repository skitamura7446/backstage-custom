"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9783],{9783:(xt,re,n)=>{n.r(re),n.d(re,{LegacyRouter:()=>bt});var e=n(14041),P=n(18690),g=n(23180),R=n(11638),L=n(7877),ye=n(58054),I=n(92651),j=n(29835),Pe=n(10015),F=n(58837),x=n(72501),G=n(71677),Ce=n(54917),X=n(40703),Me=n(57369),q=n(48653),Q=n(77125),Te=n(67720),Re=n(59469),z=n(29365),Le=n(4321),$=n(64947),Ie=n(78733),Ue=n(21619),Be=n(37877),Se=n(41045),le=n(88951),oe=n(95061),se=n(48543),ie=n(81215),V=n(26343),ce=n(45685),me=n(33478),Ee=n(23127),We=n(77225),y=n(56703),Ke=n(99993),be=n(17899),ee=n(46423),te=n(5951),xe=n(28233),Ne=n(55197),Fe=n(4832),we=n(75625),je=n(20353),ze=n(71407),Nt=n(63177),$e=n(45810),de=n.n($e),ue=n(91638),Y=n(16732),_e=n(77189),ke=n(43157),Ve=n(94384),Ye=n(46108),He=n.n(Ye),pe=n(94403),fe=n(97093),U=n(29743),Je=n(16983),ae=n(51419),ve=n(32881),Ge=n(29587),Qe=n(69561),Ze=n(98269),Xe=n(96403),Ft=n.n(Xe),qe=n(4237),wt=n.n(qe),et=n(56005),jt=n.n(et),tt=n(53373),zt=n.n(tt),$t=n(52950),at=n(4794),kt=n.n(at);const nt=(0,F.A)(t=>({cardHeader:{position:"relative"},title:{backgroundImage:({backgroundImage:a})=>a,color:({fontColor:a})=>a},box:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":10,"-webkit-box-orient":"vertical"},label:{color:t.palette.text.secondary,textTransform:"uppercase",fontSize:"0.65rem",fontWeight:"bold",letterSpacing:.5,lineHeight:1,paddingBottom:"0.2rem"},linksLabel:{padding:"0 16px"},description:{"& p":{margin:"0px"}},leftButton:{marginRight:"auto"},starButton:{position:"absolute",top:t.spacing(.5),right:t.spacing(.5),padding:"0.25rem",color:({fontColor:a})=>a}})),Ae=({icon:t})=>e.createElement(t,null),rt=(0,F.A)(t=>({deprecationIcon:{position:"absolute",top:t.spacing(.5),right:t.spacing(3.5),padding:"0.25rem"},link:{color:t.palette.warning.light}})),lt=t=>{var a,l,s,r,i,c;return{key:t.metadata.uid,name:t.metadata.name,title:`${(a=t.metadata.title||t.metadata.name)!=null?a:""}`,type:(l=t.spec.type)!=null?l:"",description:(s=t.metadata.description)!=null?s:"-",tags:(i=(r=t.metadata)==null?void 0:r.tags)!=null?i:[],links:(c=t.metadata.links)!=null?c:[]}},ot=()=>{const t=rt(),a=e.createElement(x.A,{style:{padding:10,maxWidth:300}},"This template uses a syntax that has been deprecated, and should be migrated to a newer syntax. Click for more info.");return e.createElement("div",{className:t.deprecationIcon},e.createElement(G.Ay,{title:a},e.createElement(g.N_,{to:"https://backstage.io/docs/features/software-templates/migrating-from-v1beta2-to-v1beta3",className:t.link},e.createElement(We.A,null))))},st=({template:t,deprecated:a})=>{var l,s,r;const i=(0,R.nm)(),c=(0,Ce.A)(),m=(0,R.Sf)(y.o),o=lt(t),p=(0,ye.g)(t,j.vv),E=c.getPageTheme({themeId:o.type})?o.type:"other",f=c.getPageTheme({themeId:E}),u=nt({fontColor:f.fontColor,backgroundImage:f.backgroundImage}),{name:h,namespace:_}=(0,j.KU)((0,j.U2)(t)),A=m({templateName:h,namespace:_}),D=(0,R.Sf)(y.v),d=!!((l=t.metadata.annotations)==null?void 0:l["backstage.io/techdocs-ref"])&&!!D&&D({namespace:t.metadata.namespace||j.oQ,kind:t.kind,name:t.metadata.name}),v=M=>{var N;return M&&(N=i.getSystemIcon(M))!=null?N:Ee.A},W=(0,L.u)(me.YT),B=(0,I.Cr)(t,W);return e.createElement(X.A,null,e.createElement(Me.A,{className:u.cardHeader},e.createElement(I.uR,{className:u.starButton,entity:t}),a&&e.createElement(ot,null),e.createElement(g.f1,{title:o.title,subtitle:o.type,classes:{root:u.title}})),e.createElement(q.A,{style:{display:"flex",flexDirection:"column",gap:"16px"}},e.createElement(Q.A,{className:u.box},e.createElement(x.A,{variant:"body2",className:u.label},"Description"),e.createElement(g.h2,{className:u.description,content:o.description})),e.createElement(Q.A,{className:u.box},e.createElement(x.A,{variant:"body2",className:u.label},"Owner"),e.createElement(I.iI,{entityRefs:p,defaultKind:"Group",hideIcons:!0})),e.createElement(Q.A,null,e.createElement(x.A,{style:{marginBottom:"4px"},variant:"body2",className:u.label},"Tags"),(s=o.tags)==null?void 0:s.map(M=>e.createElement(Te.A,{size:"small",label:M,key:M})))),e.createElement(x.A,{variant:"body2",className:[u.label,u.linksLabel].join(" ")},"Links"),e.createElement(Re.A,null,e.createElement("div",{className:u.leftButton},B&&e.createElement(G.Ay,{title:B.integrationType||B.locationTargetUrl},e.createElement(z.A,{className:u.leftButton,href:B.locationTargetUrl},e.createElement(me.L7,{type:B.integrationType}))),d&&e.createElement(G.Ay,{title:"View TechDocs"},e.createElement(z.A,{className:u.leftButton,href:d},e.createElement(Ae,{icon:v("docs")}))),(r=o.links)==null?void 0:r.map((M,N)=>e.createElement(G.Ay,{key:`${M.url}_${N}`,title:M.title||M.url},e.createElement(z.A,{size:"medium",href:M.url},e.createElement(Ae,{icon:v(M.icon)}))))),e.createElement(g.z9,{color:"primary",to:A,"aria-label":`Choose ${o.title}`},"Choose")))},ge=({TemplateCardComponent:t,group:a,templateFilter:l})=>{const{loading:s,error:r,entities:i}=(0,I.nK)(),c=t||st,m=i.filter(Pe.c),o=(a?m.filter(a.filter):m).filter(E=>l?l(E):!0),p=(()=>a&&a.title?typeof a.title=="string"?e.createElement(g.dv,{title:a.title}):a.title:e.createElement(g.dv,{title:"Other Templates"}))();return a&&o.length===0?null:e.createElement(e.Fragment,null,s&&e.createElement(g.ke,null),r&&e.createElement(g.Bp,{title:"Oops! Something went wrong loading the templates"},r.message),!r&&!s&&!i.length&&e.createElement(x.A,{variant:"body2"},"No templates found that match your filter. Learn more about"," ",e.createElement(g.N_,{to:"https://backstage.io/docs/features/software-templates/adding-templates"},"adding templates"),"."),e.createElement(g.UC,null,p,e.createElement(g.s3,null,o&&(o==null?void 0:o.length)>0&&o.map(E=>e.createElement(c,{key:(0,j.U2)(E),template:E,deprecated:E.apiVersion==="backstage.io/v1beta2"})))))},it=(0,F.A)(t=>({button:{color:t.page.fontColor}}));function ct(t){const a=it(),[l,s]=(0,e.useState)(),r=(0,R.Sf)(y.p),i=(0,R.Sf)(y.q),c=(0,R.Sf)(y.t),m=(0,P.Zp)(),o=t.editor!==!1,p=t.actions!==!1,E=t.tasks!==!1;if(!o&&!p)return null;const f=h=>{s(h.currentTarget)},u=()=>{s(void 0)};return e.createElement(e.Fragment,null,e.createElement(z.A,{id:"long-menu","aria-label":"more","aria-controls":"long-menu","aria-expanded":!!l,"aria-haspopup":"true",role:"button",onClick:f,"data-testid":"menu-button",color:"inherit",className:a.button},e.createElement(ze.A,null)),e.createElement(Ne.Ay,{"aria-labelledby":"long-menu",open:Boolean(l),onClose:u,anchorEl:l,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},e.createElement(xe.A,null,o&&e.createElement(V.A,{onClick:()=>m(r())},e.createElement(ee.A,null,e.createElement(we.A,{fontSize:"small"})),e.createElement(te.A,{primary:"Template Editor"})),p&&e.createElement(V.A,{onClick:()=>m(i())},e.createElement(ee.A,null,e.createElement(Fe.A,{fontSize:"small"})),e.createElement(te.A,{primary:"Installed Actions"})),E&&e.createElement(V.A,{onClick:()=>m(c())},e.createElement(ee.A,null,e.createElement(je.A,{fontSize:"small"})),e.createElement(te.A,{primary:"Task List"})))))}const mt=({TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r})=>{const i=(0,R.Sf)(y.u),c={title:a?"Other Templates":"Templates",filter:o=>!(a!=null?a:[]).map(E=>E.filter(o)).some(E=>E===!0)},{allowed:m}=(0,be.JT)({permission:Ke.C4});return e.createElement(g.YW,{themeId:"home"},e.createElement(g.Y9,{pageTitleOverride:"Create a New Component",title:"Create a New Component",subtitle:"Create new software components using standard templates",...r},e.createElement(ct,{...s})),e.createElement(g.UC,null,e.createElement(g.dv,{title:"Available Templates"},m&&e.createElement(g.ly,{title:"Register Existing Component",to:i&&i()}),e.createElement(g.Yl,null,"Create new software components using standard templates. Different templates create different kinds of components (services, websites, documentation, ...).")),e.createElement(I.GI,null,e.createElement(I.GI.Filters,null,e.createElement(I.lD,null),e.createElement(I.mb,{initialFilter:"template",hidden:!0}),e.createElement(I.y2,{initialFilter:"all",availableFilters:["all","starred"]}),e.createElement(y.T,null),e.createElement(I.mo,null)),e.createElement(I.GI.Content,null,a&&a.map((o,p)=>e.createElement(ge,{key:p,TemplateCardComponent:t,group:o,templateFilter:l})),e.createElement(ge,{key:"other",TemplateCardComponent:t,templateFilter:l,group:c})))))},Et=({TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r})=>e.createElement(I.B9,null,e.createElement(mt,{TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r}));function b(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function w(t,a){if(!b(t))return;const{properties:l,items:s,anyOf:r,oneOf:i,allOf:c,dependencies:m}=t;for(const o in t)t.hasOwnProperty(o)&&o.startsWith("ui:")&&(a[o]=t[o],delete t[o]);if(b(l))for(const o in l){if(!l.hasOwnProperty(o))continue;const p=l[o];if(!b(p))continue;const E={};a[o]=a[o]||E,w(p,E)}if(b(s)){const o={};a.items=o,w(s,o)}if(Array.isArray(r))for(const o of r)b(o)&&w(o,a);if(Array.isArray(i))for(const o of i)b(o)&&w(o,a);if(Array.isArray(c))for(const o of c)b(o)&&w(o,a);if(b(m))for(const o of Object.keys(m)){const p=m[o];b(p)&&w(p,a)}}function dt(t,a=[]){var l;const s=t["ui:ObjectFieldTemplate"];t.type=t.type||"object";const r=JSON.parse(JSON.stringify(t));delete r.title;const i={};if(w(r,i),s){const c=(l=a.find(m=>m.name===s))==null?void 0:l.component;c&&(i["ui:ObjectFieldTemplate"]=c)}return{schema:r,uiSchema:i}}var ut=Object.freeze({__proto__:null,DescriptionField:({description:t})=>t&&e.createElement(g.h2,{content:t,linkTarget:"_blank"})});function _t(t,a){const l={},s=new Set(a.map(r=>r.name).concat(Object.getOwnPropertyNames(t)));for(const r of s){const i=a.find(m=>m.name===r);if(!i){l[r]=t[r];continue}if(i["ui:widget"]==="password"){l[r]="******";continue}if(!i["ui:backstage"]||!i["ui:backstage"].review){l[r]=t[r];continue}const c=i["ui:backstage"].review;if(c.mask){l[r]=c.mask;continue}c.show&&(l[r]=t[r])}return l}function pt(t){const a=[];return t.forEach(l=>{const s=l.schema.properties;for(const r in s)if(s.hasOwnProperty(r)){const i=s[r];i.name=r,a.push(i)}}),a}const ft=t=>{const{disableButtons:a,formData:l,handleBack:s,handleCreate:r,handleReset:i,steps:c}=t;return e.createElement(g.UC,null,e.createElement(Le.A,{square:!0,elevation:0},e.createElement(x.A,{variant:"h6"},"Review and create"),e.createElement(g.tA,{dense:!0,metadata:_t(l,pt(c.map(({mergedSchema:m})=>({schema:m}))))}),e.createElement(Q.A,{mb:4}),e.createElement($.A,{onClick:s,disabled:a},"Back"),e.createElement($.A,{onClick:i,disabled:a},"Reset"),e.createElement($.A,{variant:"contained",color:"primary",onClick:r,disabled:a},"Create")))},vt=(0,ke.SL)(Ve.Sx);function At(t){return t.map(({schema:a})=>({mergedSchema:a,...(0,fe.bO)(a)}))}const he=t=>{const{formData:a,onChange:l,onReset:s,onFinish:r,fields:i,widgets:c,layouts:m,ReviewStepComponent:o}=t,{templateName:p}=(0,R.KS)(y.o),E=(0,R.st)(),[f,u]=(0,e.useState)(0),[h,_]=(0,e.useState)(!1),A=(0,L.u)(L.r),D=(0,L.u)(L.f),C="backstage:featureFlag",d=O=>{var K;const S=He()(O),Z=[];return S.schema.properties&&(S.schema.properties=Object.fromEntries(Object.entries(S.schema.properties).filter(([J,De])=>De[C]?D.isActive(De[C])?!0:(Z.push(J),!1):!0)),S.schema.required=Array.isArray(S.schema.required)?(K=S.schema.required)==null?void 0:K.filter(J=>!Z.includes(J)):S.schema.required),S},v=t.steps.filter(O=>{const K=O.schema[C];return typeof K!="string"||D.isActive(K)}).map(d),W=()=>{u(0),s()},B=()=>{const O=Math.min(f+1,v.length);u(O),E.captureEvent("click",`Next Step (${O})`)},M=()=>u(Math.max(f-1,0)),N=async()=>{if(r){_(!0);try{await r(),E.captureEvent("create",a.name||`new ${p}`)}catch(O){A.post(O)}finally{_(!1)}}},T=o!=null?o:ft;return e.createElement(e.Fragment,null,e.createElement(Ie.A,{activeStep:f,orientation:"vertical"},v.map(({title:O,schema:K,...S},Z)=>e.createElement(Ue.A,{key:O},e.createElement(Be.A,{"aria-label":`Step ${Z+1} ${O}`,"aria-disabled":"false",tabIndex:0},e.createElement(x.A,{variant:"h6",component:"h2"},O)),e.createElement(Se.A,{key:O},e.createElement(vt,{validator:pe.Ay,showErrorList:!1,fields:{...ut,...i},widgets:c,noHtml5Validate:!0,formData:a,formContext:{formData:a},onChange:l,onSubmit:J=>{J.errors.length===0&&B()},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},...S,...dt(K,m)},e.createElement($.A,{disabled:f===0,onClick:M},"Back"),e.createElement($.A,{variant:"contained",color:"primary",type:"submit"},"Next step")))))),f===v.length&&e.createElement(T,{disableButtons:h,handleBack:M,handleCreate:N,handleReset:W,formData:a,steps:At(v)}))};function k(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function gt(t){return typeof t=="object"&&t!==null&&Array.isArray(t)}const Oe=(t,a,l)=>{function s(r,i,c){var m;const o=r.properties,p=r.type==="object"&&o===void 0;if(!(!k(o)&&!p)){if(o)for(const[E,f]of Object.entries(i)){const u=c[E],h=A=>{if(A&&k(A)){const D=A["ui:field"];D&&typeof a[D]=="function"&&a[D](f,u,l)}},_=o[E];if(k(f)&&k(_))s(_,f,u);else if(gt(f)){if(k(_)){const{items:A}=_;if(k(A))if(A.type==="object"){const D=(m=A==null?void 0:A.properties)!=null?m:[];for(const[,C]of Object.entries(D))h(C)}else h(A)}}else h(_)}else if(p){const E=r["ui:field"];E&&typeof a[E]=="function"&&a[E](i,c,l)}}}return(r,i)=>(s(t,r,i),i)},ht=t=>{const a=(0,L.u)(Y.s),{value:l,loading:s,error:r}=(0,ue.default)(()=>a.getTemplateParameterSchema(t),[a,t]);return{schema:l,loading:s,error:r}},Ot=({ReviewStepComponent:t,customFieldExtensions:a=[],layouts:l=[],headerOptions:s})=>{const r=(0,L.b)(),i=(0,Y.u)(),c=(0,L.u)(L.r),m=(0,L.u)(Y.s),{templateName:o,namespace:p}=(0,R.KS)(y.o),E=(0,j.U2)({name:o,kind:"template",namespace:p}),f=(0,P.Zp)(),u=(0,R.Sf)(y.w),h=(0,R.Sf)(y.r),{schema:_,loading:A,error:D}=ht(E),[C,d]=(0,e.useState)(()=>{var T;const O=de().parse(window.location.search,{ignoreQueryPrefix:!0});try{return JSON.parse(O.formData)}catch{return(T=O.formData)!=null?T:{}}}),v=()=>d({}),W=(0,e.useCallback)(T=>d(T.formData),[d]),B=async()=>{var T;const{taskId:O}=await m.scaffold({templateRef:E,values:C,secrets:i==null?void 0:i.secrets}),K=de().stringify({formData:C},{addQueryPrefix:!0}),S=`${window.location.pathname}${K}`;(T=window.history)==null||T.replaceState(null,document.title,S),f(u({taskId:O}))};if(D)return c.post(new Error(`Failed to load template, ${D}`)),e.createElement(P.C5,{to:h()});if(!A&&!_)return c.post(new Error("Template was not found.")),e.createElement(P.C5,{to:h()});const M=Object.fromEntries(a.map(({name:T,component:O})=>[T,O])),N=Object.fromEntries(a.map(({name:T,validation:O})=>[T,O]));return e.createElement(R.Ig,{attributes:{entityRef:E}},e.createElement(g.YW,{themeId:"home"},e.createElement(g.Y9,{pageTitleOverride:"Create a New Component",title:"Create a New Component",subtitle:"Create new software components using standard templates",...s}),e.createElement(g.UC,null,A&&e.createElement(le.A,{"data-testid":"loading-progress"}),_&&e.createElement(g.nO,{title:_.title,noPadding:!0,titleTypographyProps:{component:"h2"}},e.createElement(he,{ReviewStepComponent:t,formData:C,fields:M,onChange:W,onReset:v,onFinish:B,layouts:l,steps:_.steps.map(T=>({...T,validate:Oe(T.schema,N,{apiHolder:r})}))})))))};var Dt=Object.defineProperty,yt=(t,a,l)=>a in t?Dt(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,Pt=(t,a,l)=>(yt(t,typeof a!="symbol"?a+"":a,l),l);const Ct=(0,F.A)({containerWrapper:{position:"relative",width:"100%",height:"100%"},container:{position:"absolute",top:0,bottom:0,left:0,right:0,overflow:"auto"}});class Mt extends e.Component{constructor(){super(...arguments),Pt(this,"state",{shouldRender:!0})}componentDidUpdate(a){a.invalidator!==this.props.invalidator&&this.setState({shouldRender:!0})}componentDidCatch(a){this.props.setErrorText(a.message),this.setState({shouldRender:!1})}render(){return this.state.shouldRender?this.props.children:null}}function ne(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function H(t){const{content:a,contentIsSpec:l,data:s,onUpdate:r,onDryRun:i,setErrorText:c,fieldExtensions:m=[],layouts:o=[]}=t,p=Ct(),E=(0,L.b)(),[f,u]=(0,e.useState)(),h=(0,e.useMemo)(()=>Object.fromEntries(m.map(({name:_,component:A})=>[_,A])),[m]);return(0,Je.A)(()=>{try{if(!a){u(void 0);return}const _=ae.Ay.parseAllDocuments(a).filter(d=>d).map(d=>d.toJSON())[0];if(!ne(_)){u(void 0);return}let A=_;if(!l){if(!(String(_.kind).toLocaleLowerCase("en-US")==="template")){u(void 0);return}A=ne(_.spec)?_.spec:{}}const{parameters:D}=A;if(!Array.isArray(D)){c("Template parameters must be an array"),u(void 0);return}const C=Object.fromEntries(m.map(({name:d,validation:v})=>[d,v]));c(),u(D.flatMap(d=>ne(d)?[{title:String(d.title),schema:d,validate:Oe(d,C,{apiHolder:E})}]:[]))}catch(_){c(_.message)}},250,[l,a,E]),f?e.createElement("div",{className:p.containerWrapper},e.createElement("div",{className:p.container},e.createElement(Mt,{invalidator:f,setErrorText:c},e.createElement(he,{steps:f,fields:h,formData:s,onChange:_=>r(_.formData),onReset:()=>r({}),finishButtonLabel:i&&"Try It",onFinish:i&&(()=>i(s)),layouts:o})))):null}function Tt(t){const{setErrorText:a,fieldExtensions:l=[],layouts:s}=t,r=(0,U.u)(),i=(0,U.a)(),{selectedFile:c}=i,[m,o]=(0,e.useState)({}),p=async()=>{if(c)try{await r.execute({templateContent:c.content,values:m,files:i.files}),a()}catch(f){throw a(String(f.cause||f)),f}},E=c&&c.path.match(/\.ya?ml$/)?c.content:void 0;return e.createElement(H,{onDryRun:p,fieldExtensions:l,setErrorText:a,content:E,data:m,onUpdate:o,layouts:s})}H.DirectoryEditorDryRun=Tt;const Rt=(0,F.A)({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "browser editor preview"
      "results results results"
    `,gridTemplateColumns:"1fr 3fr 2fr",gridTemplateRows:"1fr auto"},browser:{gridArea:"browser",overflow:"auto"},editor:{gridArea:"editor",overflow:"auto"},preview:{gridArea:"preview",overflow:"auto"},results:{gridArea:"results"}}),Lt=t=>{const a=Rt(),[l,s]=(0,e.useState)();return e.createElement(U.D,{directory:t.directory},e.createElement(U.b,null,e.createElement("main",{className:a.root},e.createElement("section",{className:a.browser},e.createElement(U.T,{onClose:t.onClose})),e.createElement("section",{className:a.editor},e.createElement(U.c.DirectoryEditor,{errorText:l})),e.createElement("section",{className:a.preview},e.createElement(H.DirectoryEditorDryRun,{setErrorText:s,fieldExtensions:t.fieldExtensions,layouts:t.layouts})),e.createElement("section",{className:a.results},e.createElement(U.d,null)))))},It=`# Edit the template parameters below to see how they will render in the scaffolder form UI
parameters:
  - title: Fill in some steps
    required:
      - name
    properties:
      name:
        title: Name
        type: string
        description: Unique name of the component
      owner:
        title: Owner
        type: string
        description: Owner of the component
        ui:field: OwnerPicker
        ui:options:
          catalogFilter:
            kind: Group
  - title: Choose a location
    required:
      - repoUrl
    properties:
      repoUrl:
        title: Repository Location
        type: string
        ui:field: RepoUrlPicker
        ui:options:
          allowedHosts:
            - github.com
steps:
  - id: fetch-base
    name: Fetch Base
    action: fetch:template
    input:
      url: ./template
      values:
        name: \${{parameters.name}}
`,Ut=(0,F.A)(t=>({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "controls controls"
      "textArea preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center",margin:t.spacing(1)},textArea:{gridArea:"textArea"},preview:{gridArea:"preview"}})),Bt=({defaultPreviewTemplate:t=It,customFieldExtensions:a=[],onClose:l,layouts:s=[]})=>{const r=Ut(),i=(0,L.u)(L.l),c=(0,L.u)(I.vp),[m,o]=(0,e.useState)(""),[p,E]=(0,e.useState)(),[f,u]=(0,e.useState)([]),[h,_]=(0,e.useState)(t),[A,D]=(0,e.useState)({}),{loading:C}=(0,ue.default)(()=>c.getEntities({filter:{kind:"template"},fields:["kind","metadata.namespace","metadata.name","metadata.title","spec.parameters","spec.steps","spec.output"]}).then(({items:v})=>u(v.map(W=>{var B;return{label:(B=W.metadata.title)!=null?B:(0,I.SE)(W,{defaultKind:"template"}),value:W}}))).catch(v=>i.post({message:`Error loading exisiting templates: ${v.message}`,severity:"error"})),[c]),d=(0,e.useCallback)(v=>{o(v),_(ae.Ay.stringify(v.spec))},[_]);return e.createElement(e.Fragment,null,C&&e.createElement(le.A,null),e.createElement("main",{className:r.root},e.createElement("div",{className:r.controls},e.createElement(oe.A,{variant:"outlined",size:"small",fullWidth:!0},e.createElement(se.A,{id:"select-template-label"},"Load Existing Template"),e.createElement(ie.A,{value:m,label:"Load Existing Template",labelId:"select-template-label",onChange:v=>d(v.target.value)},f.map((v,W)=>e.createElement(V.A,{key:W,value:v.value},v.label)))),e.createElement(z.A,{size:"medium",onClick:l},e.createElement(ve.A,null))),e.createElement("div",{className:r.textArea},e.createElement(U.c,{content:h,onUpdate:_,errorText:p})),e.createElement("div",{className:r.preview},e.createElement(H,{data:A,onUpdate:D,content:h,contentIsSpec:!0,fieldExtensions:a,setErrorText:E,layouts:s}))))},St=(0,F.A)(t=>({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "controls controls"
      "fieldForm preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center",margin:t.spacing(1)},fieldForm:{gridArea:"fieldForm"},preview:{gridArea:"preview"}})),Wt=({customFieldExtensions:t=[],onClose:a})=>{var l,s;const r=St(),i=t.filter(d=>!!d.schema),[c,m]=(0,e.useState)(i[0]),[o,p]=(0,e.useState)({}),[E,f]=(0,e.useState)(Date.now()),[u,h]=(0,e.useState)({}),_=(0,e.useMemo)(()=>{var d,v;return ae.Ay.stringify({parameters:[{title:`${c.name} Example`,properties:{[c.name]:{type:(v=(d=c.schema)==null?void 0:d.returnValue)==null?void 0:v.type,"ui:field":c.name,"ui:options":o}}}]})},[o,c]),A=(0,e.useMemo)(()=>Object.fromEntries(t.map(({name:d,component:v})=>[d,v])),[t]),D=(0,e.useCallback)(d=>{m(d),p({}),h({})},[p,m,h]),C=(0,e.useCallback)(d=>{p(d),f(Date.now())},[p,f]);return e.createElement("main",{className:r.root},e.createElement("div",{className:r.controls},e.createElement(oe.A,{variant:"outlined",size:"small",fullWidth:!0},e.createElement(se.A,{id:"select-field-label"},"Choose Custom Field Extension"),e.createElement(ie.A,{value:c,label:"Choose Custom Field Extension",labelId:"select-field-label",onChange:d=>D(d.target.value)},i.map((d,v)=>e.createElement(V.A,{key:v,value:d},d.name)))),e.createElement(z.A,{size:"medium",onClick:a,"aria-label":"Close"},e.createElement(ve.A,null))),e.createElement("div",{className:r.fieldForm},e.createElement(X.A,null,e.createElement(ce.A,{title:"Field Options"}),e.createElement(q.A,null,e.createElement(fe.lV,{showErrorList:!1,fields:{...A},noHtml5Validate:!0,formData:o,formContext:{fieldFormState:o},onSubmit:d=>C(d.formData),validator:pe.Ay,schema:((l=c.schema)==null?void 0:l.uiOptions)||{},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"}},e.createElement($.A,{variant:"contained",color:"primary",type:"submit",disabled:!((s=c.schema)!=null&&s.uiOptions)},"Apply"))))),e.createElement("div",{className:r.preview},e.createElement(X.A,null,e.createElement(ce.A,{title:"Example Template Spec"}),e.createElement(q.A,null,e.createElement(Ze.Ay,{readOnly:!0,theme:"dark",height:"100%",extensions:[Ge.Tg.define(Qe.o)],value:_}))),e.createElement(H,{data:u,onUpdate:h,key:E,content:_,contentIsSpec:!0,fieldExtensions:t,setErrorText:()=>null})))};function Kt(t){const[a,l]=(0,e.useState)();let s=null;return(a==null?void 0:a.type)==="local"?s=e.createElement(Lt,{directory:a.directory,fieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0),layouts:t.layouts}):(a==null?void 0:a.type)==="form"?s=e.createElement(Bt,{defaultPreviewTemplate:t.defaultPreviewTemplate,customFieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0),layouts:t.layouts}):(a==null?void 0:a.type)==="field-explorer"?s=e.createElement(Wt,{customFieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0)}):s=e.createElement(g.UC,null,e.createElement(U.e,{onSelect:r=>{r==="local"?U.W.requestDirectoryAccess().then(i=>l({type:"local",directory:i})).catch(()=>{}):r==="form"?l({type:"form"}):r==="field-explorer"&&l({type:"field-explorer"})}})),e.createElement(g.YW,{themeId:"home"},e.createElement(g.Y9,{title:"Template Editor",subtitle:"Edit, preview, and try out templates and template forms"}),s)}const bt=t=>{const{groups:a,templateFilter:l,components:s={},defaultPreviewTemplate:r}=t,{ReviewStepComponent:i,TemplateCardComponent:c,TaskPageComponent:m}=s,o=(0,P.P1)(),p=m!=null?m:U.g,E=(0,_e.l3)(o),f=[...E,...U.f.filter(({name:_})=>!E.some(A=>A.name===_))],u=(0,_e.cw)(o),h=()=>{const{templateName:_}=(0,R.KS)(y.x),A=(0,R.Sf)(y.o);return(0,e.useEffect)(()=>console.warn("The route /template/:templateName is deprecated, please use the new /template/:namespace/:templateName route instead"),[]),e.createElement(P.C5,{to:A({namespace:"default",templateName:_})})};return e.createElement(P.BV,null,e.createElement(P.qh,{path:"/",element:e.createElement(Et,{groups:a,templateFilter:l,TemplateCardComponent:c,contextMenu:t.contextMenu,headerOptions:t.headerOptions})}),e.createElement(P.qh,{path:y.x.path,element:e.createElement(h,null)}),e.createElement(P.qh,{path:y.o.path,element:e.createElement(Y.S,null,e.createElement(Ot,{ReviewStepComponent:i,customFieldExtensions:f,layouts:u,headerOptions:t.headerOptions}))}),e.createElement(P.qh,{path:y.t.path,element:e.createElement(U.L,null)}),e.createElement(P.qh,{path:y.w.path,element:e.createElement(p,null)}),e.createElement(P.qh,{path:y.q.path,element:e.createElement(U.A,null)}),e.createElement(P.qh,{path:y.p.path,element:e.createElement(Y.S,null,e.createElement(Kt,{defaultPreviewTemplate:r,customFieldExtensions:f,layouts:u}))}),e.createElement(P.qh,{path:"preview",element:e.createElement(P.C5,{to:"../edit"})}))}}}]);})();

//# sourceMappingURL=9783.645a517d.chunk.js.map