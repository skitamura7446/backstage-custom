"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9743],{29743:(yn,Wt,q)=>{q.d(Wt,{A:()=>Ys,D:()=>hr,L:()=>Tr,T:()=>nn,W:()=>w,a:()=>ri,b:()=>Dr,c:()=>fr,d:()=>Kn,e:()=>N,f:()=>An,g:()=>Rn,u:()=>$n});var m=q(14041),Se=q(91638),he=q(16732),B=q(77189),X=q(77125),Ae=q(58837),Fe=q(42899),wt=q(72501),ht=q(78467),xt=q(54819),Ke=q(4321),it=q(64947),_e=q(10985),gt=q(61009),fi=q(47625),Zt=q(9719),ge=q(54801),ct=q(13677),Yt=q(69621),wi=q(8973),ui=q(29655),Dt=q(91567),di=q(48543),Li=q(63301),It=q(40703),Lt=q(58007),Pt=q(26343),St=q(46423),ci=q(5951),ii=q(71677),ni=q(29365),Ye=q(37197),Ti=q(53373),Je=q.n(Ti),ce=q(6924),xe=q(23164),ze=q(11638),Me=q(7877),Oe=q(23180),$t=q(67720),Ne=q(56703),_t=q(97093),et=q(92651),Bi=q(9684),zt=q(53364),yt=q(52950),oi=q(4794),en=q.n(oi),Gi=q(29835),te=q(67349),S=q(48653),A=q(89031),I=q(99703),F=q(32881),$=q(10010),ee=q(71108),re=q(29587),we=q(69561),He=q(83173);const Le=z=>(z+1)%Number.MAX_SAFE_INTEGER;function Qe(){const[,z]=(0,m.useState)(0);return(0,m.useCallback)(()=>{z(Le)},[])}var tt=q(15166),ft=q(16609),si=q(33742),ei=q(13059);function Kt(z,...V){const Q=(0,si.a)(),ie=(0,ft.J)(V[1]),fe=(0,m.useMemo)(()=>function(...me){Q()&&(typeof ie.current=="function"?ie.current.apply(this,me):typeof ie.current.handleEvent=="function"&&ie.current.handleEvent.apply(this,me))},[]);(0,m.useEffect)(()=>{const me=z&&(0,ei.mQ)(z,"current")?z.current:z;if(!me)return;const be=V.slice(2);return(0,ei.on)(me,V[0],fe,...be),()=>{(0,ei.AU)(me,V[0],fe,...be)}},[z,V[0]])}var Ut=q(29636);const Mt=z=>typeof z=="function"?z:typeof z=="string"?V=>V.key===z:z?ei.ud:ei.HD,Ft=Ut.Bd?window:null;function Si(z,V,Q,ie={}){const{event:fe="keydown",target:me=Ft,eventOptions:be}=ie,Ve=(0,ft.J)(V),Tt=(0,m.useMemo)(()=>{const kt=Mt(z);return function(Ze){kt(Ze)&&Ve.current.call(this,Ze)}},Q);Kt(me,fe,Tt,be)}function nt(z){const V=(0,m.useRef)();return(0,m.useEffect)(()=>{V.current=z}),V.current}var Xe=q(98269),We=q(51419),Jt=q(8109),rt=q(65569),st=q(92399),vt=q(62461),ot=q(39590),Gt=q(12326),Ht=q(38605),ut=q(31653),bt=q(89575),qt=q(90689),pi=q(39850),tn=q(9546),Ni=q(7031),Bt=q(45065),ji=m.createContext({});const li=ji;var Zi={root:{padding:0,margin:0,listStyle:"none"}};function vn(z,V){if(z.length!==V.length)return!0;for(var Q=0;Q<z.length;Q+=1)if(z[Q]!==V[Q])return!0;return!1}var Ii=function(V,Q,ie){for(var fe=Q;fe<V.length;fe+=1)if(ie===V[fe])return fe;return-1},Oi=[],Et=[],Wn=m.forwardRef(function(V,Q){var ie=V.children,fe=V.classes,me=V.className,be=V.defaultCollapseIcon,Ve=V.defaultEndIcon,Tt=V.defaultExpanded,kt=Tt===void 0?Oi:Tt,Ze=V.defaultExpandIcon,Te=V.defaultParentIcon,ke=V.defaultSelected,lt=ke===void 0?Et:ke,Ue=V.disableSelection,ai=Ue===void 0?!1:Ue,Xt=V.multiSelect,Vt=Xt===void 0?!1:Xt,Yi=V.expanded,Di=V.onNodeSelect,Pi=V.onNodeToggle,Fi=V.selected,jt=(0,pi.A)(V,["children","classes","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disableSelection","multiSelect","expanded","onNodeSelect","onNodeToggle","selected"]),Un=m.useState(null),vi=Un[0],Hi=Un[1],Ui=m.useState(null),dn=Ui[0],Cn=Ui[1],hi=m.useRef({}),xn=m.useRef({}),Ri=m.useRef([]),is=(0,Bt.A)({controlled:Yi,default:kt,name:"TreeView",state:"expanded"}),Qs=(0,qt.A)(is,2),wn=Qs[0],Ji=Qs[1],Mn=(0,Bt.A)({controlled:Fi,default:lt,name:"TreeView",state:"selected"}),En=(0,qt.A)(Mn,2),Wi=En[0],Tn=En[1],pn=m.useCallback(function(qe){return Array.isArray(wn)?wn.indexOf(qe)!==-1:!1},[wn]),ws=m.useCallback(function(qe){return Array.isArray(Wi)?Wi.indexOf(qe)!==-1:Wi===qe},[Wi]),Ss=function(Ee){return vi===Ee},cn=function(Ee){return dn===Ee},_s=function(Ee){var Ce=Ri.current.indexOf(Ee);return Ce!==-1&&Ce+1<Ri.current.length?Ri.current[Ce+1]:null},Nn=function(Ee){var Ce=Ri.current.indexOf(Ee);return Ce!==-1&&Ce-1>=0?Ri.current[Ce-1]:null},ks=function(){return Ri.current[Ri.current.length-1]},Gn=function(){return Ri.current[0]},sn=function(Ee){return hi.current[Ee].parent},As=function(Ee,Ce){var je=Ri.current.indexOf(Ee),At=Ri.current.indexOf(Ce),Ct=Math.min(je,At),xi=Math.max(je,At);return Ri.current.slice(Ct,xi+1)},In=function(Ee){Ee&&(Hi(Ee),Cn(Ee))},On=function(Ee){return In(_s(Ee))},Yn=function(Ee){return In(Nn(Ee))},Jn=function(){return In(Gn())},Fn=function(){return In(ks())},ns=function(Ee,Ce){var je,At,Ct=Ce.toLowerCase(),xi=[],Mi=[];Object.keys(xn.current).forEach(function(fn){var mr=xn.current[fn],Ws=hi.current[fn],gr=Ws.parent?pn(Ws.parent):!0;gr&&(xi.push(fn),Mi.push(mr))}),je=xi.indexOf(Ee)+1,je===hi.current.length&&(je=0),At=Ii(Mi,je,Ct),At===-1&&(At=Ii(Mi,0,Ct)),At>-1&&In(xi[At])},Fs=function(Ee){var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dn,je;wn.indexOf(Ce)!==-1?(je=wn.filter(function(At){return At!==Ce}),Hi(function(At){var Ct=hi.current[At];return At&&(Ct&&Ct.parent?Ct.parent.id:null)===Ce?Ce:At})):je=[Ce].concat(wn),Pi&&Pi(Ee,je),Ji(je)},bi=function(Ee,Ce){var je=hi.current[Ce],At=hi.current[je.parent],Ct;if(At)Ct=At.children.filter(function(fn){return!pn(fn)});else{var xi=hi.current[-1].children;Ct=xi.filter(function(fn){return!pn(fn)})}var Mi=wn.concat(Ct);Ct.length>0&&(Ji(Mi),Pi&&Pi(Ee,Mi))},mn=m.useRef(null),Hn=m.useRef(!1),gn=m.useRef([]),Rt=function(Ee,Ce){var je=Wi,At=Ce.start,Ct=Ce.next,xi=Ce.current;!Ct||!xi||(gn.current.indexOf(xi)===-1&&(gn.current=[]),Hn.current?gn.current.indexOf(Ct)!==-1?(je=je.filter(function(Mi){return Mi===At||Mi!==xi}),gn.current=gn.current.filter(function(Mi){return Mi===At||Mi!==xi})):(je.push(Ct),gn.current.push(Ct)):(je.push(Ct),gn.current.push(xi,Ct)),Di&&Di(Ee,je),Tn(je))},er=function(Ee,Ce){var je=Wi,At=Ce.start,Ct=Ce.end;Hn.current&&(je=Wi.filter(function(fn){return gn.current.indexOf(fn)===-1}));var xi=As(At,Ct);gn.current=xi;var Mi=je.concat(xi);Mi=Mi.filter(function(fn,mr){return Mi.indexOf(fn)===mr}),Di&&Di(Ee,Mi),Tn(Mi)},tr=function(Ee,Ce){var je=[];Wi.indexOf(Ce)!==-1?je=Wi.filter(function(At){return At!==Ce}):je=[Ce].concat(Wi),Di&&Di(Ee,je),Tn(je)},Cs=function(Ee,Ce){var je=Vt?[Ce]:Ce;Di&&Di(Ee,je),Tn(je)},ss=function(Ee,Ce){var je=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return Ce?(je?tr(Ee,Ce):Cs(Ee,Ce),mn.current=Ce,Hn.current=!1,gn.current=[],!0):!1},qi=function(Ee,Ce){var je=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,At=Ce.start,Ct=At===void 0?mn.current:At,xi=Ce.end,Mi=Ce.current;return je?Rt(Ee,{start:Ct,next:xi,current:Mi}):er(Ee,{start:Ct,end:xi}),Hn.current=!0,!0},Pe=function(Ee,Ce){mn.current||(mn.current=Ce);var je=Hn.current?mn.current:Ce;return qi(Ee,{start:je,end:Gn()})},Qt=function(Ee,Ce){mn.current||(mn.current=Ce);var je=Hn.current?mn.current:Ce;return qi(Ee,{start:je,end:ks()})},rs=function(Ee,Ce){return qi(Ee,{end:_s(Ce),current:Ce},!0)},os=function(Ee,Ce){return qi(Ee,{end:Nn(Ce),current:Ce},!0)},dr=function(Ee){return qi(Ee,{start:Gn(),end:ks()})},zr=function(Ee,Ce){var je=hi.current[Ee];hi.current[Ee]=(0,bt.A)({},je,{children:Ce,id:Ee}),Ce.forEach(function(At){var Ct=hi.current[At];hi.current[At]=(0,bt.A)({},Ct,{parent:Ee,id:At})})},Hs=m.useCallback(function(qe){var Ee=hi.current[qe],Ce=[];return Ee&&(Ce.push(qe),Ee.children&&(Ce.concat(Ee.children),Ee.children.forEach(function(je){Ce.concat(Hs(je))}))),Ce},[]),ki=m.useCallback(function(qe){var Ee=(0,bt.A)({},xn.current);qe.forEach(function(Ce){Ee[Ce]&&delete Ee[Ce]}),xn.current=Ee},[]),Ms=m.useCallback(function(qe){var Ee=Hs(qe);ki(Ee);var Ce=(0,bt.A)({},hi.current);Ee.forEach(function(je){var At=Ce[je];if(At){if(At.parent){var Ct=Ce[At.parent];if(Ct&&Ct.children){var xi=Ct.children.filter(function(Mi){return Mi!==je});Ce[At.parent]=(0,bt.A)({},Ct,{children:xi})}}delete Ce[je]}}),hi.current=Ce,Cn(function(je){return je===qe?null:je})},[Hs,ki]),lo=function(Ee,Ce){xn.current[Ee]=Ce},ir=m.useRef([]),Xn=m.useState(!1),zi=Xn[0],pr=Xn[1];m.useEffect(function(){var qe=[];m.Children.forEach(ie,function(Ee){m.isValidElement(Ee)&&Ee.props.nodeId&&qe.push(Ee.props.nodeId)}),vn(ir.current,qe)&&(hi.current[-1]={parent:null,children:qe},qe.forEach(function(Ee,Ce){Ce===0&&Hi(Ee)}),Ri.current=hi.current[-1].children,ir.current=qe,pr(!0))},[ie]),m.useEffect(function(){var qe=function Ee(Ce){for(var je=[],At=0;At<Ce.length;At+=1){var Ct=Ce[At];je.push(Ct);var xi=hi.current[Ct].children;pn(Ct)&&xi&&(je=je.concat(Ee(xi)))}return je};zi&&(Ri.current=qe(hi.current[-1].children))},[wn,zi,pn,ie]);var ls=function(){return!1};return m.createElement(li.Provider,{value:{icons:{defaultCollapseIcon:be,defaultExpandIcon:Ze,defaultParentIcon:Te,defaultEndIcon:Ve},focus:In,focusFirstNode:Jn,focusLastNode:Fn,focusNextNode:On,focusPreviousNode:Yn,focusByFirstCharacter:ns,expandAllSiblings:bi,toggleExpansion:Fs,isExpanded:pn,isFocused:cn,isSelected:ws,selectNode:ai?ls:ss,selectRange:ai?ls:qi,selectNextNode:ai?ls:rs,selectPreviousNode:ai?ls:os,rangeSelectToFirst:ai?ls:Pe,rangeSelectToLast:ai?ls:Qt,selectAllNodes:ai?ls:dr,isTabbable:Ss,multiSelect:Vt,getParent:sn,mapFirstChar:lo,addNodeToNodeMap:zr,removeNodeFromNodeMap:Ms}},m.createElement("ul",(0,bt.A)({role:"tree","aria-multiselectable":Vt,className:(0,tn.default)(fe.root,me),ref:Q},jt),ie))});const Pn=(0,Ni.A)(Zi,{name:"MuiTreeView"})(Wn);var qn=q(63798),Sn=q(268),bn=q(54917),Ls=q(19878),us=function(V){return{root:{listStyle:"none",margin:0,padding:0,outline:0,WebkitTapHighlightColor:"transparent","&:focus > $content $label":{backgroundColor:V.palette.action.hover},"&$selected > $content $label":{backgroundColor:(0,Sn.X4)(V.palette.primary.main,V.palette.action.selectedOpacity)},"&$selected > $content $label:hover, &$selected:focus > $content $label":{backgroundColor:(0,Sn.X4)(V.palette.primary.main,V.palette.action.selectedOpacity+V.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},expanded:{},selected:{},group:{margin:0,padding:0,marginLeft:17},content:{width:"100%",display:"flex",alignItems:"center",cursor:"pointer"},iconContainer:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},label:{width:"100%",paddingLeft:4,position:"relative","&:hover":{backgroundColor:V.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}}},R=function(V){return V&&V.length===1&&V.match(/\S/)},a=m.forwardRef(function(V,Q){var ie=V.children,fe=V.classes,me=V.className,be=V.collapseIcon,Ve=V.endIcon,Tt=V.expandIcon,kt=V.icon,Ze=V.label,Te=V.nodeId,ke=V.onClick,lt=V.onLabelClick,Ue=V.onIconClick,ai=V.onFocus,Xt=V.onKeyDown,Vt=V.onMouseDown,Yi=V.TransitionComponent,Di=Yi===void 0?Yt.A:Yi,Pi=V.TransitionProps,Fi=(0,pi.A)(V,["children","classes","className","collapseIcon","endIcon","expandIcon","icon","label","nodeId","onClick","onLabelClick","onIconClick","onFocus","onKeyDown","onMouseDown","TransitionComponent","TransitionProps"]),jt=m.useContext(li),Un=jt.icons,vi=jt.focus,Hi=jt.focusFirstNode,Ui=jt.focusLastNode,dn=jt.focusNextNode,Cn=jt.focusPreviousNode,hi=jt.focusByFirstCharacter,xn=jt.selectNode,Ri=jt.selectRange,is=jt.selectNextNode,Qs=jt.selectPreviousNode,wn=jt.rangeSelectToFirst,Ji=jt.rangeSelectToLast,Mn=jt.selectAllNodes,En=jt.expandAllSiblings,Wi=jt.toggleExpansion,Tn=jt.isExpanded,pn=jt.isFocused,ws=jt.isSelected,Ss=jt.isTabbable,cn=jt.multiSelect,_s=jt.getParent,Nn=jt.mapFirstChar,ks=jt.addNodeToNodeMap,Gn=jt.removeNodeFromNodeMap,sn=m.useRef(null),As=m.useRef(null),In=(0,Ls.A)(sn,Q),On=kt,Yn=Boolean(Array.isArray(ie)?ie.length:ie),Jn=Tn?Tn(Te):!1,Fn=pn?pn(Te):!1,ns=Ss?Ss(Te):!1,Fs=ws?ws(Te):!1,bi=Un||{},mn=(0,bn.A)();On||(Yn?(Jn?On=be||bi.defaultCollapseIcon:On=Tt||bi.defaultExpandIcon,On||(On=bi.defaultParentIcon)):On=Ve||bi.defaultEndIcon);var Hn=function(Pe){Fn||vi(Te);var Qt=cn&&(Pe.shiftKey||Pe.ctrlKey||Pe.metaKey);Yn&&!Pe.defaultPrevented&&!(Qt&&Tn(Te))&&Wi(Pe,Te),Qt?Pe.shiftKey?Ri(Pe,{end:Te}):xn(Pe,Te,!0):xn(Pe,Te),ke&&ke(Pe)},gn=function(Pe){(Pe.shiftKey||Pe.ctrlKey||Pe.metaKey)&&Pe.preventDefault(),Vt&&Vt(Pe)},Rt=function(Pe){return Yn&&(Jn?dn(Te):Wi(Pe)),!0},er=function(Pe){if(Jn)return Wi(Pe,Te),!0;var Qt=_s(Te);return Qt?(vi(Qt),!0):!1},tr=function(Pe){var Qt=!1,rs=Pe.key;if(!(Pe.altKey||Pe.currentTarget!==Pe.target)){var os=Pe.ctrlKey||Pe.metaKey;switch(rs){case" ":sn.current===Pe.currentTarget&&(cn&&Pe.shiftKey?Qt=Ri(Pe,{end:Te}):cn?Qt=xn(Pe,Te,!0):Qt=xn(Pe,Te)),Pe.stopPropagation();break;case"Enter":sn.current===Pe.currentTarget&&Yn&&(Wi(Pe),Qt=!0),Pe.stopPropagation();break;case"ArrowDown":cn&&Pe.shiftKey&&is(Pe,Te),dn(Te),Qt=!0;break;case"ArrowUp":cn&&Pe.shiftKey&&Qs(Pe,Te),Cn(Te),Qt=!0;break;case"ArrowRight":mn.direction==="rtl"?Qt=er(Pe):Qt=Rt(Pe);break;case"ArrowLeft":mn.direction==="rtl"?Qt=Rt(Pe):Qt=er(Pe);break;case"Home":cn&&os&&Pe.shiftKey&&wn(Pe,Te),Hi(),Qt=!0;break;case"End":cn&&os&&Pe.shiftKey&&Ji(Pe,Te),Ui(),Qt=!0;break;default:rs==="*"?(En(Pe,Te),Qt=!0):cn&&os&&rs.toLowerCase()==="a"?Qt=Mn(Pe):!os&&!Pe.shiftKey&&R(rs)&&(hi(Te,rs),Qt=!0)}Qt&&(Pe.preventDefault(),Pe.stopPropagation()),Xt&&Xt(Pe)}},Cs=function(Pe){!Fn&&Pe.currentTarget===Pe.target&&vi(Te),ai&&ai(Pe)};m.useEffect(function(){if(ks){var qi=[];m.Children.forEach(ie,function(Pe){m.isValidElement(Pe)&&Pe.props.nodeId&&qi.push(Pe.props.nodeId)}),ks(Te,qi)}},[ie,Te,ks]),m.useEffect(function(){if(Gn)return function(){Gn(Te)}},[Te,Gn]),m.useEffect(function(){Nn&&Ze&&Nn(Te,As.current.textContent.substring(0,1).toLowerCase())},[Nn,Te,Ze]),m.useEffect(function(){Fn&&sn.current.focus()},[Fn]);var ss;return cn?ss=Fs:Fs&&(ss=!0),m.createElement("li",(0,bt.A)({className:(0,tn.default)(fe.root,me,Jn&&fe.expanded,Fs&&fe.selected),role:"treeitem",onKeyDown:tr,onFocus:Cs,"aria-expanded":Yn?Jn:null,"aria-selected":ss,ref:In,tabIndex:ns?0:-1},Fi),m.createElement("div",{className:fe.content,onClick:Hn,onMouseDown:gn,ref:As},m.createElement("div",{onClick:Ue,className:fe.iconContainer},On),m.createElement(wt.A,{onClick:lt,component:"div",className:fe.label},Ze)),ie&&m.createElement(Di,(0,bt.A)({unmountOnExit:!0,className:fe.group,in:Jn,component:"ul",role:"group"},Pi),ie))});const u=(0,Ni.A)(us,{name:"MuiTreeItem"})(a);var v=q(23127),x=q(21619),O=q(37877),D=q(78733),W=q(3380),U=q(45810),se=q.n(U),ue=q(18690),ve=q(39221);const Re=({error:z})=>{const V=(0,m.useRef)("");return(0,m.useEffect)(()=>{V.current=String(Math.random())},[z]),z?m.createElement(X.A,null,m.createElement(Oe.zZ,{id:V.current,variant:"warning",message:z.message})):null},De=(0,Ae.A)({svgIcon:{display:"inline-block","& svg":{display:"inline-block",fontSize:"inherit",verticalAlign:"baseline"}}}),Nt=z=>{const{href:V,text:Q,Icon:ie,...fe}=z,me=De();return m.createElement(Fe.A,{container:!0,direction:"row",spacing:1},m.createElement(Fe.A,{item:!0},m.createElement(wt.A,{component:"div",className:me.svgIcon},ie?m.createElement(ie,null):m.createElement(v.A,null))),m.createElement(Fe.A,{item:!0},m.createElement(Oe.N_,{to:V,...fe},Q||V)))},$i=({output:z})=>{const{links:V=[]}=z,Q=(0,ze.nm)(),ie=(0,ze.Sf)(et.sF),fe=me=>{var be;return me&&(be=Q.getSystemIcon(me))!=null?be:v.A};return m.createElement(X.A,{px:3,pb:3},V.filter(({url:me,entityRef:be})=>me||be).map(({url:me,entityRef:be,title:Ve,icon:Tt})=>{if(be){const kt=(0,Gi.KU)(be,{defaultKind:"<unknown>",defaultNamespace:"<unknown>"}),Ze=ie(kt);return{title:Ve,icon:Tt,url:Ze}}return{title:Ve,icon:Tt,url:me}}).map(({url:me,title:be,icon:Ve},Tt)=>m.createElement(Nt,{key:`output-link-${Tt}`,href:me,text:be!=null?be:me,Icon:fe(Ve),target:"_blank"})))},mi=(0,Ae.A)(z=>(0,I.A)({root:{width:"100%"},button:{marginBottom:z.spacing(2),marginLeft:z.spacing(2)},actionsContainer:{marginBottom:z.spacing(2)},resetContainer:{padding:z.spacing(3)},labelWrapper:{display:"flex",flex:1,flexDirection:"row",justifyContent:"space-between"},stepWrapper:{width:"100%"}})),un=({step:z})=>{const[V,Q]=(0,m.useState)("");return(0,ve.A)(()=>{if(!z.startedAt){Q("");return}const ie=z.endedAt?yt.c9.fromISO(z.endedAt):yt.c9.local(),fe=yt.c9.fromISO(z.startedAt),me=yt.IX.fromDateTimes(fe,ie).toDuration().valueOf();Q(en()(me,{round:!0}))},1e3),m.createElement(wt.A,{variant:"caption"},V)},Ai=(0,Ae.A)(z=>(0,I.A)({root:{color:z.palette.text.disabled,display:"flex",height:22,alignItems:"center"},completed:{color:z.palette.status.ok},error:{color:z.palette.status.error}}));function kn(z){const V=Ai(),{active:Q,completed:ie,error:fe}=z,me=()=>Q?m.createElement(ht.A,{size:"24px"}):ie?m.createElement(vt.A,null):fe?m.createElement(st.A,null):m.createElement(W.A,null);return m.createElement("div",{className:Je()(V.root,{[V.completed]:ie,[V.error]:fe})},me())}const ds=(0,m.memo)(z=>{const{steps:V,currentStepId:Q,onUserStepChange:ie}=z,fe=mi(z);return m.createElement("div",{className:fe.root},m.createElement(D.A,{activeStep:V.findIndex(me=>me.id===Q),orientation:"vertical",nonLinear:!0},V.map((me,be)=>{const Ve=me.status==="cancelled",Tt=me.status==="processing",kt=me.status==="completed",Ze=me.status==="failed",Te=me.status==="skipped";return m.createElement(x.A,{key:String(be),expanded:!0},m.createElement(xt.A,{onClick:()=>ie(me.id)},m.createElement(O.A,{StepIconProps:{completed:kt,error:Ze||Ve,active:Tt},StepIconComponent:kn,className:fe.stepWrapper},m.createElement("div",{className:fe.labelWrapper},m.createElement(wt.A,{variant:"subtitle2"},me.name),Te?m.createElement(wt.A,{variant:"caption"},"Skipped"):m.createElement(un,{step:me})))))})))}),zn=({links:z=[]})=>z.length>0,Rn=z=>{const{loadingText:V}=z,Q=mi(),ie=(0,ue.Zp)(),fe=(0,ze.Sf)(Ne.r),me=(0,Me.u)(he.s),be=(0,ze.Sf)(Ne.o),[Ve,Tt]=(0,m.useState)(void 0),[kt,Ze]=(0,m.useState)(!1),[Te,ke]=(0,m.useState)(void 0),{taskId:lt}=(0,ze.KS)(Ne.w),Ue=(0,B.TA)(lt),ai=Ue.completed,Xt=Ue.cancelled,Vt=(0,m.useMemo)(()=>{var vi,Hi;return(Hi=(vi=Ue.task)==null?void 0:vi.spec.steps.map(Ui=>{var dn;return{...Ui,...(dn=Ue==null?void 0:Ue.steps)==null?void 0:dn[Ui.id]}}))!=null?Hi:[]},[Ue]);(0,m.useEffect)(()=>{var vi;const Hi=Vt.find(Ui=>["failed","processing"].includes(Ui.status));if(ai&&!Hi){ke((vi=Vt[Vt.length-1])==null?void 0:vi.id);return}ke(Hi==null?void 0:Hi.id)},[Vt,ai]);const Yi=Ve!=null?Ve:Te,Di=(0,m.useMemo)(()=>{if(!Yi)return V||"Loading...";const vi=Ue.stepLogs[Yi];return vi!=null&&vi.length?vi.join(`
`):"Waiting for logs..."},[Ue.stepLogs,Yi,V]),Pi=Ue.completed&&!Ue.loading&&!Ue.task,{output:Fi}=Ue,jt=()=>{var vi,Hi,Ui;if(!Ue.task||!((Hi=(vi=Ue.task)==null?void 0:vi.spec.templateInfo)!=null&&Hi.entityRef)){ie(fe());return}const dn=Ue.task.spec.parameters,{name:Cn,namespace:hi}=(0,Gi.KU)((Ui=Ue.task.spec.templateInfo)==null?void 0:Ui.entityRef);ie(`${be({templateName:Cn,namespace:hi})}?${se().stringify({formData:JSON.stringify(dn)})}`)},Un=async()=>{Ze(!0),await me.cancelTask(lt)};return m.createElement(Oe.YW,{themeId:"home"},m.createElement(Oe.Y9,{pageTitleOverride:`Task ${lt}`,title:"Task Activity",subtitle:`Activity for task: ${lt}`}),m.createElement(Oe.UC,null,Pi?m.createElement(Oe.M,{status:"404",statusMessage:"Task not found",additionalInfo:"No task found with this ID"}):m.createElement("div",null,m.createElement(Fe.A,{container:!0},m.createElement(Fe.A,{item:!0,xs:3},m.createElement(Ke.A,null,m.createElement(ds,{steps:Vt,currentStepId:Yi,onUserStepChange:Tt}),Fi&&zn(Fi)&&m.createElement($i,{output:Fi}),m.createElement(it.A,{className:Q.button,onClick:jt,disabled:!ai,variant:"contained",color:"primary"},"Start Over"),m.createElement(it.A,{className:Q.button,onClick:Un,disabled:ai||Xt||kt,variant:"outlined",color:"secondary"},(Xt||kt)&&!ai?"Cancelling...":"Cancel"))),m.createElement(Fe.A,{item:!0,xs:9},!Yi&&m.createElement(Oe.ke,null),m.createElement("div",{style:{height:"80vh"}},m.createElement(Re,{error:Ue.error}),m.createElement(Oe.rW,{text:Di})))))))},Bs=(0,Ae.A)(z=>({code:{fontFamily:"Menlo, monospace",padding:z.spacing(1),backgroundColor:z.palette.type==="dark"?z.palette.grey[700]:z.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${z.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:z.spacing(.5),fontWeight:"bolder",color:z.palette.error.light}}})),ps=z=>m.createElement(Fe.A,{container:!0},z.examples.map((V,Q)=>m.createElement(m.Fragment,{key:`example-${Q}`},m.createElement(Fe.A,{item:!0,lg:3},m.createElement(X.A,{padding:4},m.createElement(wt.A,null,V.description))),m.createElement(Fe.A,{item:!0,lg:9},m.createElement(X.A,{padding:1},m.createElement(Oe.z7,{text:V.example,showLineNumbers:!0,showCopyCodeButton:!0,language:"yaml"})))))),Ys=()=>{const z=(0,Me.u)(he.s),V=Bs(),{loading:Q,value:ie,error:fe}=(0,Se.default)(async()=>z.listActions()),[me,be]=(0,m.useState)({});if(Q)return m.createElement(Oe.ke,null);if(fe)return m.createElement(Oe.M,{statusMessage:"Failed to load installed actions",status:"500"});const Ve=ke=>!ke||ke.length<1?m.createElement(wt.A,null,"No schema defined"):m.createElement(_e.A,{component:Ke.A},m.createElement(gt.A,{size:"small"},m.createElement(fi.A,null,m.createElement(Zt.A,null,m.createElement(ge.A,null,"Name"),m.createElement(ge.A,null,"Title"),m.createElement(ge.A,null,"Description"),m.createElement(ge.A,null,"Type"))),m.createElement(ct.A,null,ke))),Tt=ke=>{var lt,Ue;return ke.type?ke.type!=="array"?[ke.type].flat():[`${ke.type}(${(Ue=(lt=ke.items)==null?void 0:lt.type)!=null?Ue:"unknown"})`]:["unknown"]},kt=(ke,lt)=>{const Ue=lt==null?void 0:lt.properties;if(Ue)return Object.entries(Ue).map(ai=>{var Xt,Vt,Yi;const[Di]=ai,Pi=`${ke}.${Di}`,Fi=ai[1],jt=Je()(V.code,{[V.codeRequired]:(Xt=lt.required)==null?void 0:Xt.includes(Di)}),Un=Tt(Fi);return m.createElement(m.Fragment,{key:Pi},m.createElement(Zt.A,{key:Pi},m.createElement(ge.A,null,m.createElement("div",{className:jt},Di)),m.createElement(ge.A,null,Fi.title),m.createElement(ge.A,null,Fi.description),m.createElement(ge.A,null,Un.map(vi=>vi.includes("object")?m.createElement($t.A,{label:vi,key:vi,icon:me[Pi]?m.createElement(xe.A,null):m.createElement(ce.A,null),variant:"outlined",onClick:()=>be(Hi=>{const Ui={...Hi};return Ui[Pi]=!Hi[Pi],Ui})}):m.createElement($t.A,{label:vi,key:vi,variant:"outlined"})))),m.createElement(Zt.A,null,m.createElement(ge.A,{style:{paddingBottom:0,paddingTop:0},colSpan:6},m.createElement(Yt.A,{in:me[Pi],timeout:"auto",unmountOnExit:!0},m.createElement(X.A,{sx:{margin:1}},m.createElement(wt.A,{variant:"h6",component:"div"},Di),Ve(kt(Pi,Fi.type==="array"?{properties:(Yi=(Vt=Fi.items)==null?void 0:Vt.properties)!=null?Yi:{}}:Fi)))))))})},Ze=(ke,lt,Ue)=>{if(Ue)return m.createElement(m.Fragment,null,m.createElement(wt.A,{variant:"h6",component:"h4"},ke),Ue.map((ai,Xt)=>m.createElement("div",{key:Xt},Ve(kt(`${lt}.${Xt}`,ai)))))},Te=ie==null?void 0:ie.map(ke=>{var lt,Ue,ai,Xt,Vt,Yi;if(ke.id.startsWith("legacy:"))return;const Di=Ze("oneOf",`${ke.id}.input`,(Ue=(lt=ke.schema)==null?void 0:lt.input)==null?void 0:Ue.oneOf);return m.createElement(X.A,{pb:4,key:ke.id},m.createElement(wt.A,{variant:"h4",component:"h2",className:V.code},ke.id),ke.description&&m.createElement(Oe.h2,{content:ke.description}),((ai=ke.schema)==null?void 0:ai.input)&&m.createElement(X.A,{pb:2},m.createElement(wt.A,{variant:"h5",component:"h3"},"Input"),Ve(kt(`${ke.id}.input`,(Xt=ke==null?void 0:ke.schema)==null?void 0:Xt.input)),Di),((Vt=ke.schema)==null?void 0:Vt.output)&&m.createElement(X.A,{pb:2},m.createElement(wt.A,{variant:"h5",component:"h3"},"Output"),Ve(kt(`${ke.id}.output`,(Yi=ke==null?void 0:ke.schema)==null?void 0:Yi.output))),ke.examples&&m.createElement(wi.A,null,m.createElement(ui.A,{expandIcon:m.createElement(ce.A,null)},m.createElement(wt.A,{variant:"h5",component:"h3"},"Examples")),m.createElement(Dt.A,null,m.createElement(X.A,{pb:2},m.createElement(ps,{examples:ke.examples})))))});return m.createElement(Oe.YW,{themeId:"home"},m.createElement(Oe.Y9,{pageTitleOverride:"Create a New Component",title:"Installed actions",subtitle:"This is the collection of all installed actions"}),m.createElement(Oe.UC,null,Te))},ms=z=>{var V;const{setSecrets:Q,secrets:ie}=(0,he.u)(),{name:fe,onChange:me,schema:{title:be,description:Ve},rawErrors:Tt,disabled:kt,errors:Ze,required:Te}=z;return m.createElement(_t.gZ,{rawErrors:Tt,rawDescription:Ve,disabled:kt,errors:Ze,required:Te},m.createElement(di.A,{htmlFor:be},be),m.createElement(Li.A,{id:be,"aria-describedby":be,onChange:ke=>{var lt,Ue;me(Array((lt=ke.target)==null?void 0:lt.value.length).fill("*").join("")),Q({[fe]:(Ue=ke.target)==null?void 0:Ue.value})},value:(V=ie[fe])!=null?V:"",type:"password",autoComplete:"off"}))},An=[{component:Ne.y,name:"EntityPicker",schema:Ne.z},{component:Ne.A,name:"EntityNamePicker",validation:Ne.B,schema:Ne.C},{component:Ne.D,name:"EntityTagsPicker",schema:Ne.F},{component:Ne.G,name:"RepoUrlPicker",validation:Ne.i,schema:Ne.H},{component:Ne.I,name:"OwnerPicker",schema:Ne.J},{component:Ne.K,name:"OwnedEntityPicker",schema:Ne.N},{component:Ne.P,name:"MyGroupsPicker",schema:Ne.l},{component:ms,name:"Secret"}],Qn=(0,Ae.A)(z=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:z.spacing(1,0,1,0)},title:{margin:z.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:z.palette.text.primary},menuItem:{minHeight:z.spacing(6)},groupWrapper:{margin:z.spacing(1,1,2,1)}}),{name:"ScaffolderReactOwnerListPicker"});function Ln(){return[{name:"Task Owner",items:[{id:"owned",label:"Owned",icon:Bi.A},{id:"all",label:"All",icon:zt.A}]}]}const Ki=z=>{const{filter:V,onSelectOwner:Q}=z,ie=Qn(),fe=Ln();return m.createElement(It.A,{className:ie.root},fe.map(me=>m.createElement(m.Fragment,{key:me.name},m.createElement(wt.A,{variant:"subtitle2",component:"span",className:ie.title},me.name),m.createElement(It.A,{className:ie.groupWrapper},m.createElement(Lt.A,{disablePadding:!0,dense:!0,role:"menu"},me.items.map(be=>m.createElement(Pt.A,{key:be.id,divider:!0,ContainerProps:{role:"menuitem"},onClick:()=>Q(be.id),selected:be.id===V,className:ie.menuItem,"data-testid":`owner-picker-${be.id}`},be.icon&&m.createElement(St.A,{className:ie.listIcon},m.createElement(be.icon,{fontSize:"small"})),m.createElement(ci.A,null,m.createElement(wt.A,{variant:"body1"},be.label)))))))))},_n=({createdAt:z})=>{const V=yt.c9.fromISO(z),Q=yt.IX.fromDateTimes(V,yt.c9.local()).toDuration().valueOf();return m.createElement(wt.A,{paragraph:!0},en()(Q,{round:!0})," ago")},es=({entityRef:z})=>{var V,Q,ie;const fe=(0,Me.u)(et.vp),{value:me,loading:be,error:Ve}=(0,Se.default)(()=>fe.getEntityByRef(z||""),[fe,z]);return z?be||Ve?null:m.createElement(et.zI,{entityRef:(0,Gi.KU)(z),title:(ie=(Q=(V=me==null?void 0:me.spec)==null?void 0:V.profile)==null?void 0:Q.displayName)!=null?ie:me==null?void 0:me.metadata.name}):m.createElement(wt.A,{paragraph:!0},"Unknown")},or=({status:z})=>{switch(z){case"processing":return m.createElement(Oe.Ek,null,z);case"completed":return m.createElement(Oe.So,null,z);case"error":default:return m.createElement(Oe.Xs,null,z)}},Js=({entityRef:z})=>{const V=(0,Me.u)(he.s),{value:Q,loading:ie,error:fe}=(0,Se.default)(()=>V.getTemplateParameterSchema(z||""),[V,z]);return ie||fe||!z?null:m.createElement(et.zI,{entityRef:(0,Gi.KU)(z),title:Q==null?void 0:Q.title})},Ns=z=>{var V;const{initiallySelectedFilter:Q="owned"}=z,ie=(0,Me.u)(he.s),fe=(0,ze.Sf)(Ne.r),[me,be]=(0,m.useState)(Q),{value:Ve,loading:Tt,error:kt}=(0,Se.default)(()=>{var Ze;return ie.listTasks?(Ze=ie.listTasks)==null?void 0:Ze.call(ie,{filterByOwnership:me}):(console.warn("listTasks is not implemented in the scaffolderApi, please make sure to implement this method."),Promise.resolve({tasks:[]}))},[ie,me]);return Tt?m.createElement(Oe.ke,null):kt?m.createElement(m.Fragment,null,m.createElement(Oe.bJ,{error:kt}),m.createElement(Oe.pp,{missing:"info",title:"No information to display",description:"There is no Tasks or there was an issue communicating with backend."})):m.createElement(et.GI,null,m.createElement(et.GI.Filters,null,m.createElement(Ki,{filter:me,onSelectOwner:Ze=>be(Ze)})),m.createElement(et.GI.Content,null,m.createElement(Oe.XI,{data:(V=Ve==null?void 0:Ve.tasks)!=null?V:[],title:"Tasks",columns:[{title:"Task ID",field:"id",render:Ze=>m.createElement(Oe.N_,{to:`${fe()}/tasks/${Ze.id}`},Ze.id)},{title:"Template",render:Ze=>{var Te;return m.createElement(Js,{entityRef:(Te=Ze.spec.templateInfo)==null?void 0:Te.entityRef})}},{title:"Created",field:"createdAt",render:Ze=>m.createElement(_n,{createdAt:Ze.createdAt})},{title:"Owner",field:"createdBy",render:Ze=>{var Te,ke;return m.createElement(es,{entityRef:(ke=(Te=Ze.spec)==null?void 0:Te.user)==null?void 0:ke.ref})}},{title:"Status",field:"status",render:Ze=>m.createElement(or,{status:Ze.status})}]})))},Tr=z=>m.createElement(Oe.YW,{themeId:"home"},m.createElement(Oe.Y9,{pageTitleOverride:"Templates Tasks",title:m.createElement(m.Fragment,null,"List template tasks ",m.createElement(Oe.v0,{shorthand:!0,alpha:!0})),subtitle:"All tasks that have been started"}),m.createElement(Oe.UC,null,m.createElement(Ns,{...z}))),gs=window.showDirectoryPicker;class T{constructor(V,Q){this.path=V,this.handle=Q}file(){return this.handle.getFile()}async save(V){const Q=await this.handle.createWritable();await Q.write(V),await Q.close()}}class g{constructor(V){this.handle=V}async listFiles(){const V=[];for await(const Q of this.listDirectoryContents(this.handle))V.push(Q);return V}async*listDirectoryContents(V,Q=[]){for await(const ie of V.values())if(ie.kind==="file")yield new T([...Q,ie.name].join("/"),ie);else if(ie.kind==="directory"){if(ie.name===".git")continue;yield*this.listDirectoryContents(ie,[...Q,ie.name])}}}class w{static isSupported(){return Boolean(gs)}static async requestDirectoryAccess(){if(!gs)throw new Error("File system access is not supported");const V=await gs();return new g(V)}constructor(){}}const P=(0,Ae.A)(z=>({introText:{textAlign:"center",marginTop:z.spacing(2)},card:{position:"relative",maxWidth:340,marginTop:z.spacing(4),margin:z.spacing(0,2)},infoIcon:{position:"absolute",top:z.spacing(1),right:z.spacing(1)}}));function N(z){const V=P(),Q=w.isSupported(),ie=m.createElement(It.A,{className:V.card,elevation:4},m.createElement(te.A,{disabled:!Q,onClick:()=>{var be;return(be=z.onSelect)==null?void 0:be.call(z,"local")}},m.createElement(S.A,null,m.createElement(wt.A,{variant:"h4",component:"h3",gutterBottom:!0,color:Q?void 0:"textSecondary",style:{display:"flex",flexFlow:"row nowrap"}},"Load Template Directory"),m.createElement(wt.A,{variant:"body1",color:Q?void 0:"textSecondary"},"Load a local template directory, allowing you to both edit and try executing your own template."))),!Q&&m.createElement("div",{className:V.infoIcon},m.createElement(ii.Ay,{placement:"top",title:"Only supported in some Chromium-based browsers"},m.createElement(A.A,null)))),fe=m.createElement(It.A,{className:V.card,elevation:4},m.createElement(te.A,{onClick:()=>{var be;return(be=z.onSelect)==null?void 0:be.call(z,"form")}},m.createElement(S.A,null,m.createElement(wt.A,{variant:"h4",component:"h3",gutterBottom:!0},"Edit Template Form"),m.createElement(wt.A,{variant:"body1"},"Preview and edit a template form, either using a sample template or by loading a template from the catalog.")))),me=m.createElement(It.A,{className:V.card,elevation:4},m.createElement(te.A,{onClick:()=>{var be;return(be=z.onSelect)==null?void 0:be.call(z,"field-explorer")}},m.createElement(S.A,null,m.createElement(wt.A,{variant:"h4",component:"h3",gutterBottom:!0},"Custom Field Explorer"),m.createElement(wt.A,{variant:"body1"},"View and play around with available installed custom field extensions."))));return m.createElement("div",{style:z.style},m.createElement(wt.A,{variant:"h4",component:"h2",className:V.introText},"Get started by choosing one of the options below"),m.createElement("div",{style:{display:"flex",flexFlow:"row wrap",alignItems:"flex-start",justifyContent:"center",alignContent:"flex-start"}},Q&&ie,fe,!Q&&ie,me))}var K=Object.defineProperty,G=(z,V,Q)=>V in z?K(z,V,{enumerable:!0,configurable:!0,writable:!0,value:Q}):z[V]=Q,le=(z,V,Q)=>(G(z,typeof V!="symbol"?V+"":V,Q),Q),oe=(z,V,Q)=>{if(!V.has(z))throw TypeError("Cannot "+Q)},pe=(z,V,Q)=>(oe(z,V,"read from private field"),Q?Q.call(z):V.get(z)),Be=(z,V,Q)=>{if(V.has(z))throw TypeError("Cannot add the same private member more than once");V instanceof WeakSet?V.add(z):V.set(z,Q)},dt=(z,V,Q,ie)=>(oe(z,V,"write to private field"),ie?ie.call(z,Q):V.set(z,Q),Q),Ci,gi,yi,ln,ts,an,Vn,Bn,ys;const Co=1024*1024,Xs="This file is too large to be displayed";class lr{constructor(V,Q){Be(this,Ci,void 0),Be(this,gi,void 0),Be(this,yi,void 0),Be(this,ln,void 0),dt(this,Ci,V),dt(this,gi,Q)}get path(){return pe(this,Ci).path}get content(){var V;return(V=pe(this,yi))!=null?V:Xs}updateContent(V){pe(this,yi)!==void 0&&(dt(this,yi,V),pe(this,gi).call(this))}get dirty(){return pe(this,yi)!==pe(this,ln)}async save(){pe(this,yi)!==void 0&&(await pe(this,Ci).save(pe(this,yi)),dt(this,ln,pe(this,yi)),pe(this,gi).call(this))}async reload(){const V=await pe(this,Ci).file();if(V.size>Co){pe(this,yi)!==void 0&&(dt(this,yi,void 0),dt(this,ln,void 0),pe(this,gi).call(this));return}const Q=await V.text();pe(this,yi)!==Q&&(dt(this,yi,Q),dt(this,ln,Q),pe(this,gi).call(this))}}Ci=new WeakMap,gi=new WeakMap,yi=new WeakMap,ln=new WeakMap;class no{constructor(V){Be(this,ts,void 0),Be(this,an,new Set),Be(this,Vn,[]),Be(this,Bn,void 0),le(this,"setSelectedFile",Q=>{const ie=pe(this,Bn),fe=pe(this,Vn).find(me=>me.path===Q);ie!==fe&&(dt(this,Bn,fe),pe(this,ys).call(this))}),Be(this,ys,()=>{pe(this,an).forEach(Q=>Q())}),dt(this,ts,V)}get files(){return pe(this,Vn)}get selectedFile(){return pe(this,Bn)}get dirty(){return pe(this,Vn).some(V=>V.dirty)}async save(){await Promise.all(pe(this,Vn).map(V=>V.save()))}async reload(){var V;const Q=(V=pe(this,Bn))==null?void 0:V.path,ie=await pe(this,ts).listFiles(),fe=await Promise.all(ie.map(async me=>{const be=new lr(me,pe(this,ys));return await be.reload(),be}));pe(this,Vn).length=0,pe(this,Vn).push(...fe),this.setSelectedFile(Q),pe(this,ys).call(this)}subscribe(V){return pe(this,an).add(V),()=>{pe(this,an).delete(V)}}}ts=new WeakMap,an=new WeakMap,Vn=new WeakMap,Bn=new WeakMap,ys=new WeakMap;const ar=(0,m.createContext)(void 0);function ri(){const z=(0,m.useContext)(ar),V=Qe();if((0,m.useEffect)(()=>z==null?void 0:z.subscribe(V),[z,V]),!z)throw new Error("must be used within a DirectoryEditorProvider");return z}function hr(z){const{directory:V}=z,[{result:Q,error:ie},{execute:fe}]=(0,tt.Y)(async me=>{const be=new no(me);await be.reload();const Ve=be.files.find(Tt=>Tt.path.match(/\.ya?ml$/));return Ve&&be.setSelectedFile(Ve.path),be});return(0,m.useEffect)(()=>{fe(V)},[fe,V]),ie?m.createElement(Oe.bJ,{error:ie}):Q?m.createElement(ar.Provider,{value:Q},z.children):m.createElement(Oe.ke,null)}const Or=64*1024,jn=32*1024,vs=(0,m.createContext)(void 0);function bs(z){if(z.length>Or)return window.btoa("<file too large>");try{return window.btoa(z)}catch{const Q=new TextEncoder().encode(z),ie=new Array;for(let fe=0;fe<Q.length;fe+=jn)ie.push(String.fromCharCode(...Q.slice(fe,fe+jn)));return window.btoa(ie.join(""))}}function Dr(z){const V=(0,Me.u)(he.s),[Q,ie]=(0,m.useState)({results:[],selectedResult:void 0}),fe=(0,m.useRef)(1),me=(0,m.useCallback)(kt=>{ie(Ze=>{const Te=Ze.results.find(ke=>ke.id===kt);return Te===Ze.selectedResult?Ze:{results:Ze.results,selectedResult:Te}})},[]),be=(0,m.useCallback)(kt=>{ie(Ze=>{var Te;const ke=Ze.results.findIndex(ai=>ai.id===kt);if(ke===-1)return Ze;const lt=Ze.results.slice(),[Ue]=lt.splice(ke,1);return{results:lt,selectedResult:((Te=Ze.selectedResult)==null?void 0:Te.id)===Ue.id?lt[0]:Ze.selectedResult}})},[]),Ve=(0,m.useCallback)(async kt=>{if(!V.dryRun)throw new Error("Scaffolder API does not support dry-run");const Ze=We.Ay.parse(kt.templateContent),ke={...await V.dryRun({template:Ze,values:kt.values,secrets:{},directoryContents:kt.files.map(lt=>({path:lt.path,base64Content:bs(lt.content)}))}),id:fe.current++};ie(lt=>{var Ue;return{results:[...lt.results,ke],selectedResult:(Ue=lt.selectedResult)!=null?Ue:ke}})},[V]),Tt=(0,m.useMemo)(()=>({...Q,selectResult:me,deleteResult:be,execute:Ve}),[Q,me,be,Ve]);return m.createElement(vs.Provider,{value:Tt},z.children)}function $n(){const z=(0,m.useContext)(vs);if(!z)throw new Error("must be used within a DryRunProvider");return z}const xs=(0,Ae.A)({root:{whiteSpace:"nowrap",overflowY:"auto"}});function Pr(z){const V={type:"directory",name:"",path:"",children:[]};for(const Q of z.slice().sort()){const ie=Q.split("/");let fe=V;for(let me=0;me<ie.length;me++){const be=ie[me];if(be==="")throw new Error("Invalid path part: ''");const Ve=ie.slice(0,me+1).join("/"),Tt=fe.children.find(kt=>kt.name===be);if((Tt==null?void 0:Tt.type)==="file")throw new Error(`Duplicate filename at '${Ve}'`);if(Tt)fe=Tt;else if(me<ie.length-1){const kt={type:"directory",name:be,path:Ve,children:[]},Ze=fe.children.findIndex(Te=>Te.type==="file");fe.children.splice(Ze,0,kt),fe=kt}else fe.children.push({type:"file",name:be,path:Ve})}}return V.children}function Rr({entry:z}){return z.type==="file"?m.createElement(u,{nodeId:z.path,label:z.name}):m.createElement(u,{nodeId:z.path,label:z.name},z.children.map(V=>m.createElement(Rr,{key:V.path,entry:V})))}function Is(z){const V=xs(),Q=(0,m.useMemo)(()=>Pr(z.filePaths),[z.filePaths]);return m.createElement(Pn,{selected:z.selected,className:V.root,defaultCollapseIcon:m.createElement(ce.A,null),defaultExpandIcon:m.createElement(qn.A,null),onNodeSelect:(ie,fe)=>{z.onSelect&&z.filePaths.includes(fe)&&z.onSelect(fe)}},Q.map(ie=>m.createElement(Rr,{key:ie.path,entry:ie})))}const hn=(0,Ae.A)(z=>({button:{padding:z.spacing(1)},buttons:{display:"flex",flexFlow:"row nowrap",alignItems:"center",justifyContent:"flex-start"},buttonsGap:{flex:"1 1 auto"},buttonsDivider:{marginBottom:z.spacing(1)}}));function nn(z){var V,Q;const ie=hn(),fe=ri(),me=fe.files.filter(Ve=>Ve.dirty),be=()=>{z.onClose&&(me.length>0&&!window.confirm("Are you sure? Unsaved changes will be lost")||z.onClose())};return m.createElement(m.Fragment,null,m.createElement("div",{className:ie.buttons},m.createElement(ii.Ay,{title:"Save all files"},m.createElement(ni.A,{className:ie.button,disabled:fe.files.every(Ve=>!Ve.dirty),onClick:()=>fe.save()},m.createElement(ee.A,null))),m.createElement(ii.Ay,{title:"Reload directory"},m.createElement(ni.A,{className:ie.button,onClick:()=>fe.reload()},m.createElement($.A,null))),m.createElement("div",{className:ie.buttonsGap}),m.createElement(ii.Ay,{title:"Close directory"},m.createElement(ni.A,{className:ie.button,onClick:be},m.createElement(F.A,null)))),m.createElement(Ye.A,{className:ie.buttonsDivider}),m.createElement(Is,{selected:(Q=(V=fe.selectedFile)==null?void 0:V.path)!=null?Q:"",onSelect:fe.setSelectedFile,filePaths:fe.files.map(Ve=>Ve.path)}))}const cr=(0,Ae.A)(z=>({container:{position:"relative",width:"100%",height:"100%"},codeMirror:{position:"absolute",top:0,bottom:0,left:0,right:0},errorPanel:{color:z.palette.error.main,lineHeight:2,margin:z.spacing(0,1)},floatingButtons:{position:"absolute",top:z.spacing(1),right:z.spacing(3)},floatingButton:{padding:z.spacing(1)}}));function fr(z){const{errorText:V}=z,Q=cr(),ie=(0,m.useMemo)(()=>{if(!V)return He.S7.of(null);const fe=document.createElement("div");return fe.classList.add(Q.errorPanel),fe.textContent=V,He.S7.of(()=>({dom:fe,bottom:!0}))},[Q,V]);return Si(fe=>fe.key==="s"&&(fe.ctrlKey||fe.metaKey),fe=>{fe.preventDefault(),z.onSave&&z.onSave()}),m.createElement("div",{className:Q.container},m.createElement(Xe.Ay,{className:Q.codeMirror,theme:"dark",height:"100%",extensions:[re.Tg.define(we.o),ie],value:z.content,onChange:z.onUpdate}),(z.onSave||z.onReload)&&m.createElement("div",{className:Q.floatingButtons},m.createElement(Ke.A,null,z.onSave&&m.createElement(ii.Ay,{title:"Save file"},m.createElement(ni.A,{className:Q.floatingButton,onClick:()=>{var fe;return(fe=z.onSave)==null?void 0:fe.call(z)}},m.createElement(ee.A,null))),z.onReload&&m.createElement(ii.Ay,{title:"Reload file"},m.createElement(ni.A,{className:Q.floatingButton,onClick:()=>{var fe;return(fe=z.onReload)==null?void 0:fe.call(z)}},m.createElement($.A,null))))))}function Lr(z){var V,Q;const ie=ri(),fe=(V=ie.selectedFile)!=null&&V.dirty?{onSave:()=>ie.save(),onReload:()=>ie.reload()}:{onReload:()=>ie.reload()};return m.createElement(fr,{errorText:z.errorText,content:(Q=ie.selectedFile)==null?void 0:Q.content,onUpdate:me=>{var be;return(be=ie.selectedFile)==null?void 0:be.updateContent(me)},...fe})}fr.DirectoryEditor=Lr;function Br(z,V){const Q=document.createElement("a");Q.href=URL.createObjectURL(z),Q.download=V,Q.click(),URL.revokeObjectURL(Q.href),Q.remove()}const ur=(0,Ae.A)(z=>({root:{overflowY:"auto",background:z.palette.background.default},iconSuccess:{minWidth:0,marginRight:z.spacing(1),color:z.palette.status.ok},iconFailure:{minWidth:0,marginRight:z.spacing(1),color:z.palette.status.error}}));function Nr(){const z=ur(),V=$n();return m.createElement(Lt.A,{className:z.root,dense:!0},V.results.map(Q=>{var ie;const fe=Q.log.some(Ve=>Ve.body.status==="failed");let me=!1;async function be(){me=!0,await so(Q.directoryContents,`dry-run-result-${Q.id}.zip`),me=!1}return m.createElement(Jt.A,{button:!0,key:Q.id,selected:((ie=V.selectedResult)==null?void 0:ie.id)===Q.id,onClick:()=>V.selectResult(Q.id)},m.createElement(St.A,{className:fe?z.iconFailure:z.iconSuccess},fe?m.createElement(st.A,null):m.createElement(vt.A,null)),m.createElement(ci.A,{primary:`Result ${Q.id}`}),m.createElement(rt.A,null,m.createElement(ni.A,{edge:"end","aria-label":"download",title:"Download as .zip",disabled:me,onClick:()=>be()},m.createElement(Gt.A,null)),m.createElement(ni.A,{edge:"end","aria-label":"delete",title:"Delete result",onClick:()=>V.deleteResult(Q.id)},m.createElement(ot.A,null))))}))}async function so(z,V){const{default:Q}=await q.e(2461).then(q.t.bind(q,32461,23)),ie=new Q;for(const me of z){const be=atob(me.base64Content);await ie.file(me.path,be)}const fe=await ie.generateAsync({type:"blob"});Br(fe,V)}const Ir=(0,Ae.A)(z=>({root:{display:"grid",gridTemplateColumns:"280px auto 3fr",gridTemplateRows:"1fr"},child:{overflowY:"auto",height:"100%",minHeight:0},firstChild:{background:z.palette.background.paper}}));function Zs(z){const V=Ir(),Q=m.Children.toArray(z.children);if(Q.length!==2)throw new Error("must have exactly 2 children");return m.createElement("div",{className:V.root},m.createElement("div",{className:Je()(V.child,V.firstChild)},Q[0]),m.createElement(Ye.A,{orientation:"horizontal"}),m.createElement("div",{className:V.child},Q[1]))}const qs=(0,Ae.A)({root:{display:"flex",flexFlow:"column nowrap"},contentWrapper:{flex:1,position:"relative"},content:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex","& > *":{flex:1}},codeMirror:{height:"100%",overflowY:"auto"}});function Fr(){const z=qs(),{selectedResult:V}=$n(),[Q,ie]=(0,m.useState)(""),fe=V==null?void 0:V.directoryContents.find(me=>me.path===Q);return(0,m.useEffect)(()=>{if(V){const[me]=V.directoryContents;ie(me?me.path:"")}},[V]),V?m.createElement(Zs,null,m.createElement(Is,{selected:Q,onSelect:ie,filePaths:V.directoryContents.map(me=>me.path)}),m.createElement(Xe.Ay,{className:z.codeMirror,theme:"dark",height:"100%",extensions:[re.Tg.define(we.o)],readOnly:!0,value:fe!=null&&fe.base64Content?atob(fe.base64Content):""})):null}function Hr(){var z,V;const{selectedResult:Q}=$n(),[ie,fe]=(0,m.useState)(),me=(0,m.useMemo)(()=>{var Ve;return Q?(Ve=Q.steps.map(Tt=>{var kt,Ze;const Te=Q.log.filter(ke=>ke.body.stepId===Tt.id);return{id:Tt.id,name:Tt.name,logString:Te.map(ke=>ke.body.message).join(`
`),status:(Ze=(kt=Te[Te.length-1])==null?void 0:kt.body.status)!=null?Ze:"completed"}}))!=null?Ve:[]:[]},[Q]);if(!Q)return null;const be=(z=me.find(Ve=>Ve.id===ie))!=null?z:me[0];return m.createElement(Zs,null,m.createElement(ds,{steps:me,currentStepId:be.id,onUserStepChange:fe}),m.createElement(Oe.rW,{text:(V=be==null?void 0:be.logString)!=null?V:""}))}function Wr(){var z,V;const Q=qs(),{selectedResult:ie}=$n();return ie?m.createElement(Zs,null,m.createElement(X.A,{pt:2},((V=(z=ie.output)==null?void 0:z.links)==null?void 0:V.length)&&m.createElement($i,{output:ie.output})),m.createElement(Xe.Ay,{className:Q.codeMirror,theme:"dark",height:"100%",extensions:[re.Tg.define(we.o)],readOnly:!0,value:JSON.stringify(ie.output,null,2)})):null}function ro(){const z=qs(),[V,Q]=(0,m.useState)("files");return m.createElement("div",{className:z.root},m.createElement(ut.A,{value:V,onChange:(ie,fe)=>Q(fe)},m.createElement(Ht.A,{value:"files",label:"Files"}),m.createElement(Ht.A,{value:"log",label:"Log"}),m.createElement(Ht.A,{value:"output",label:"Output"})),m.createElement(Ye.A,null),m.createElement("div",{className:z.contentWrapper},m.createElement("div",{className:z.content},V==="files"&&m.createElement(Fr,null),V==="log"&&m.createElement(Hr,null),V==="output"&&m.createElement(Wr,null))))}const oo=(0,Ae.A)(z=>({header:{height:48,minHeight:0,"&.Mui-expanded":{height:48,minHeight:0}},content:{display:"grid",background:z.palette.background.default,gridTemplateColumns:"180px auto 1fr",gridTemplateRows:"1fr",padding:0,height:400}}));function Kn(){const z=oo(),V=$n(),[Q,ie]=(0,m.useState)(!1),[fe,me]=(0,m.useState)(!0),be=V.results.length,Ve=nt(be);return(0,m.useEffect)(()=>{Ve===0&&be===1?(me(!1),ie(!0)):Ve===1&&be===0&&ie(!1)},[Ve,be]),m.createElement(m.Fragment,null,m.createElement(wi.A,{variant:"outlined",expanded:Q,hidden:be===0&&fe,onChange:(Tt,kt)=>ie(kt),onTransitionEnd:()=>be===0&&me(!0)},m.createElement(ui.A,{className:z.header,expandIcon:m.createElement(xe.A,null)},m.createElement(wt.A,null,"Dry-run results")),m.createElement(Ye.A,{orientation:"horizontal"}),m.createElement(Dt.A,{className:z.content},m.createElement(Nr,null),m.createElement(Ye.A,{orientation:"horizontal"}),m.createElement(ro,null))))}},39590:(yn,Wt,q)=>{var m,Se=q(4293),he=q(78920);m={value:!0},Wt.A=void 0;var B=he(q(14041)),X=Se(q(74044)),Ae=(0,X.default)(B.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");Wt.A=Ae},23164:(yn,Wt,q)=>{var m,Se=q(4293),he=q(78920);m={value:!0},Wt.A=void 0;var B=he(q(14041)),X=Se(q(74044)),Ae=(0,X.default)(B.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");Wt.A=Ae},3380:(yn,Wt,q)=>{var m,Se=q(4293),he=q(78920);m={value:!0},Wt.A=void 0;var B=he(q(14041)),X=Se(q(74044)),Ae=(0,X.default)(B.createElement("circle",{cx:"12",cy:"12",r:"8"}),"FiberManualRecord");Wt.A=Ae},12326:(yn,Wt,q)=>{var m,Se=q(4293),he=q(78920);m={value:!0},Wt.A=void 0;var B=he(q(14041)),X=Se(q(74044)),Ae=(0,X.default)(B.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");Wt.A=Ae},89031:(yn,Wt,q)=>{var m,Se=q(4293),he=q(78920);m={value:!0},Wt.A=void 0;var B=he(q(14041)),X=Se(q(74044)),Ae=(0,X.default)(B.createElement("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");Wt.A=Ae},10010:(yn,Wt,q)=>{var m,Se=q(4293),he=q(78920);m={value:!0},Wt.A=void 0;var B=he(q(14041)),X=Se(q(74044)),Ae=(0,X.default)(B.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");Wt.A=Ae},71108:(yn,Wt,q)=>{var m,Se=q(4293),he=q(78920);m={value:!0},Wt.A=void 0;var B=he(q(14041)),X=Se(q(74044)),Ae=(0,X.default)(B.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");Wt.A=Ae},98269:(yn,Wt,q)=>{q.d(Wt,{Ay:()=>Er});var m=q(89575),Se=q(17502),he=q(14041),B=q(14830),X=q(83173),Ae=q(29587),Fe=q(79066);const wt=r=>{let{state:n}=r,l=n.doc.lineAt(n.selection.main.from),c=ge(r.state,l.from);return c.line?xt(r):c.block?Zt(r):!1};function ht(r,n){return({state:l,dispatch:c})=>{if(l.readOnly)return!1;let f=r(n,l);return f?(c(l.update(f)),!0):!1}}const xt=ht(Dt,0),Ke=null,it=null,_e=ht(ui,0),gt=null,fi=null,Zt=ht((r,n)=>ui(r,n,wi(n)),0);function ge(r,n){let l=r.languageDataAt("commentTokens",n);return l.length?l[0]:{}}const ct=50;function Yt(r,{open:n,close:l},c,f){let p=r.sliceDoc(c-ct,c),k=r.sliceDoc(f,f+ct),E=/\s*$/.exec(p)[0].length,L=/^\s*/.exec(k)[0].length,Y=p.length-E;if(p.slice(Y-n.length,Y)==n&&k.slice(L,L+l.length)==l)return{open:{pos:c-E,margin:E&&1},close:{pos:f+L,margin:L&&1}};let Z,ye;f-c<=2*ct?Z=ye=r.sliceDoc(c,f):(Z=r.sliceDoc(c,c+ct),ye=r.sliceDoc(f-ct,f));let Ie=/^\s*/.exec(Z)[0].length,at=/\s*$/.exec(ye)[0].length,ti=ye.length-at-l.length;return Z.slice(Ie,Ie+n.length)==n&&ye.slice(ti,ti+l.length)==l?{open:{pos:c+Ie+n.length,margin:/\s/.test(Z.charAt(Ie+n.length))?1:0},close:{pos:f-at-l.length,margin:/\s/.test(ye.charAt(ti-1))?1:0}}:null}function wi(r){let n=[];for(let l of r.selection.ranges){let c=r.doc.lineAt(l.from),f=l.to<=c.to?c:r.doc.lineAt(l.to),p=n.length-1;p>=0&&n[p].to>c.from?n[p].to=f.to:n.push({from:c.from+/^\s*/.exec(c.text)[0].length,to:f.to})}return n}function ui(r,n,l=n.selection.ranges){let c=l.map(p=>ge(n,p.from).block);if(!c.every(p=>p))return null;let f=l.map((p,k)=>Yt(n,c[k],p.from,p.to));if(r!=2&&!f.every(p=>p))return{changes:n.changes(l.map((p,k)=>f[k]?[]:[{from:p.from,insert:c[k].open+" "},{from:p.to,insert:" "+c[k].close}]))};if(r!=1&&f.some(p=>p)){let p=[];for(let k=0,E;k<f.length;k++)if(E=f[k]){let L=c[k],{open:Y,close:Z}=E;p.push({from:Y.pos-L.open.length,to:Y.pos+Y.margin},{from:Z.pos-Z.margin,to:Z.pos+L.close.length})}return{changes:p}}return null}function Dt(r,n,l=n.selection.ranges){let c=[],f=-1;for(let{from:p,to:k}of l){let E=c.length,L=1e9,Y=ge(n,p).line;if(Y){for(let Z=p;Z<=k;){let ye=n.doc.lineAt(Z);if(ye.from>f&&(p==k||k>ye.from)){f=ye.from;let Ie=/^\s*/.exec(ye.text)[0].length,at=Ie==ye.length,ti=ye.text.slice(Ie,Ie+Y.length)==Y?Ie:-1;Ie<ye.text.length&&Ie<L&&(L=Ie),c.push({line:ye,comment:ti,token:Y,indent:Ie,empty:at,single:!1})}Z=ye.to+1}if(L<1e9)for(let Z=E;Z<c.length;Z++)c[Z].indent<c[Z].line.text.length&&(c[Z].indent=L);c.length==E+1&&(c[E].single=!0)}}if(r!=2&&c.some(p=>p.comment<0&&(!p.empty||p.single))){let p=[];for(let{line:E,token:L,indent:Y,empty:Z,single:ye}of c)(ye||!Z)&&p.push({from:E.from+Y,insert:L+" "});let k=n.changes(p);return{changes:k,selection:n.selection.map(k,1)}}else if(r!=1&&c.some(p=>p.comment>=0)){let p=[];for(let{line:k,comment:E,token:L}of c)if(E>=0){let Y=k.from+E,Z=Y+L.length;k.text[Z-k.from]==" "&&Z++,p.push({from:Y,to:Z})}return{changes:p}}return null}const di=B.YH.define(),Li=B.YH.define(),It=B.sj.define(),Lt=B.sj.define({combine(r){return(0,B.QR)(r,{minDepth:100,newGroupDelay:500,joinToEvent:(n,l)=>l},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(n,l)=>(c,f)=>n(c,f)||l(c,f)})}}),Pt=B.sU.define({create(){return te.empty},update(r,n){let l=n.state.facet(Lt),c=n.annotation(di);if(c){let L=Me.fromTransaction(n,c.selection),Y=c.side,Z=Y==0?r.undone:r.done;return L?Z=Oe(Z,Z.length,l.minDepth,L):Z=zt(Z,n.startState.selection),new te(Y==0?c.rest:Z,Y==0?Z:c.rest)}let f=n.annotation(Li);if((f=="full"||f=="before")&&(r=r.isolate()),n.annotation(B.ZX.addToHistory)===!1)return n.changes.empty?r:r.addMapping(n.changes.desc);let p=Me.fromTransaction(n),k=n.annotation(B.ZX.time),E=n.annotation(B.ZX.userEvent);return p?r=r.addChanges(p,k,E,l,n):n.selection&&(r=r.addSelection(n.startState.selection,k,E,l.newGroupDelay)),(f=="full"||f=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(n=>n.toJSON()),undone:r.undone.map(n=>n.toJSON())}},fromJSON(r){return new te(r.done.map(Me.fromJSON),r.undone.map(Me.fromJSON))}});function St(r={}){return[Pt,Lt.of(r),X.Lz.domEventHandlers({beforeinput(n,l){let c=n.inputType=="historyUndo"?ni:n.inputType=="historyRedo"?Ye:null;return c?(n.preventDefault(),c(l)):!1}})]}const ci=null;function ii(r,n){return function({state:l,dispatch:c}){if(!n&&l.readOnly)return!1;let f=l.field(Pt,!1);if(!f)return!1;let p=f.pop(r,l,n);return p?(c(p),!0):!1}}const ni=ii(0,!1),Ye=ii(1,!1),Ti=ii(0,!0),Je=ii(1,!0);function ce(r){return function(n){let l=n.field(Pt,!1);if(!l)return 0;let c=r==0?l.done:l.undone;return c.length-(c.length&&!c[0].changes?1:0)}}const xe=null,ze=null;class Me{constructor(n,l,c,f,p){this.changes=n,this.effects=l,this.mapped=c,this.startSelection=f,this.selectionsAfter=p}setSelAfter(n){return new Me(this.changes,this.effects,this.mapped,this.startSelection,n)}toJSON(){var n,l,c;return{changes:(n=this.changes)===null||n===void 0?void 0:n.toJSON(),mapped:(l=this.mapped)===null||l===void 0?void 0:l.toJSON(),startSelection:(c=this.startSelection)===null||c===void 0?void 0:c.toJSON(),selectionsAfter:this.selectionsAfter.map(f=>f.toJSON())}}static fromJSON(n){return new Me(n.changes&&B.VR.fromJSON(n.changes),[],n.mapped&&B.Gu.fromJSON(n.mapped),n.startSelection&&B.OF.fromJSON(n.startSelection),n.selectionsAfter.map(B.OF.fromJSON))}static fromTransaction(n,l){let c=et;for(let f of n.startState.facet(It)){let p=f(n);p.length&&(c=c.concat(p))}return!c.length&&n.changes.empty?null:new Me(n.changes.invert(n.startState.doc),c,void 0,l||n.startState.selection,et)}static selection(n){return new Me(void 0,et,void 0,void 0,n)}}function Oe(r,n,l,c){let f=n+1>l+20?n-l-1:0,p=r.slice(f,n);return p.push(c),p}function $t(r,n){let l=[],c=!1;return r.iterChangedRanges((f,p)=>l.push(f,p)),n.iterChangedRanges((f,p,k,E)=>{for(let L=0;L<l.length;){let Y=l[L++],Z=l[L++];E>=Y&&k<=Z&&(c=!0)}}),c}function Ne(r,n){return r.ranges.length==n.ranges.length&&r.ranges.filter((l,c)=>l.empty!=n.ranges[c].empty).length===0}function _t(r,n){return r.length?n.length?r.concat(n):r:n}const et=[],Bi=200;function zt(r,n){if(r.length){let l=r[r.length-1],c=l.selectionsAfter.slice(Math.max(0,l.selectionsAfter.length-Bi));return c.length&&c[c.length-1].eq(n)?r:(c.push(n),Oe(r,r.length-1,1e9,l.setSelAfter(c)))}else return[Me.selection([n])]}function yt(r){let n=r[r.length-1],l=r.slice();return l[r.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),l}function oi(r,n){if(!r.length)return r;let l=r.length,c=et;for(;l;){let f=en(r[l-1],n,c);if(f.changes&&!f.changes.empty||f.effects.length){let p=r.slice(0,l);return p[l-1]=f,p}else n=f.mapped,l--,c=f.selectionsAfter}return c.length?[Me.selection(c)]:et}function en(r,n,l){let c=_t(r.selectionsAfter.length?r.selectionsAfter.map(E=>E.map(n)):et,l);if(!r.changes)return Me.selection(c);let f=r.changes.map(n),p=n.mapDesc(r.changes,!0),k=r.mapped?r.mapped.composeDesc(p):p;return new Me(f,B.Pe.mapEffects(r.effects,n),k,r.startSelection.map(p),c)}const Gi=/^(input\.type|delete)($|\.)/;class te{constructor(n,l,c=0,f=void 0){this.done=n,this.undone=l,this.prevTime=c,this.prevUserEvent=f}isolate(){return this.prevTime?new te(this.done,this.undone):this}addChanges(n,l,c,f,p){let k=this.done,E=k[k.length-1];return E&&E.changes&&!E.changes.empty&&n.changes&&(!c||Gi.test(c))&&(!E.selectionsAfter.length&&l-this.prevTime<f.newGroupDelay&&f.joinToEvent(p,$t(E.changes,n.changes))||c=="input.type.compose")?k=Oe(k,k.length-1,f.minDepth,new Me(n.changes.compose(E.changes),_t(n.effects,E.effects),E.mapped,E.startSelection,et)):k=Oe(k,k.length,f.minDepth,n),new te(k,et,l,c)}addSelection(n,l,c,f){let p=this.done.length?this.done[this.done.length-1].selectionsAfter:et;return p.length>0&&l-this.prevTime<f&&c==this.prevUserEvent&&c&&/^select($|\.)/.test(c)&&Ne(p[p.length-1],n)?this:new te(zt(this.done,n),this.undone,l,c)}addMapping(n){return new te(oi(this.done,n),oi(this.undone,n),this.prevTime,this.prevUserEvent)}pop(n,l,c){let f=n==0?this.done:this.undone;if(f.length==0)return null;let p=f[f.length-1],k=p.selectionsAfter[0]||l.selection;if(c&&p.selectionsAfter.length)return l.update({selection:p.selectionsAfter[p.selectionsAfter.length-1],annotations:di.of({side:n,rest:yt(f),selection:k}),userEvent:n==0?"select.undo":"select.redo",scrollIntoView:!0});if(p.changes){let E=f.length==1?et:f.slice(0,f.length-1);return p.mapped&&(E=oi(E,p.mapped)),l.update({changes:p.changes,selection:p.startSelection,effects:p.effects,annotations:di.of({side:n,rest:E,selection:k}),filter:!1,userEvent:n==0?"undo":"redo",scrollIntoView:!0})}else return null}}te.empty=new te(et,et);const S=[{key:"Mod-z",run:ni,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Ye,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Ye,preventDefault:!0},{key:"Mod-u",run:Ti,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Je,preventDefault:!0}];function A(r,n){return B.OF.create(r.ranges.map(n),r.mainIndex)}function I(r,n){return r.update({selection:n,scrollIntoView:!0,userEvent:"select"})}function F({state:r,dispatch:n},l){let c=A(r.selection,l);return c.eq(r.selection,!0)?!1:(n(I(r,c)),!0)}function $(r,n){return B.OF.cursor(n?r.to:r.from)}function ee(r,n){return F(r,l=>l.empty?r.moveByChar(l,n):$(l,n))}function re(r){return r.textDirectionAt(r.state.selection.main.head)==X.OP.LTR}const we=r=>ee(r,!re(r)),He=r=>ee(r,re(r)),Le=r=>ee(r,!0),Qe=r=>ee(r,!1);function tt(r,n){return F(r,l=>l.empty?r.moveByGroup(l,n):$(l,n))}const ft=r=>tt(r,!re(r)),si=r=>tt(r,re(r)),ei=r=>tt(r,!0),Kt=r=>tt(r,!1),Ut=typeof Intl!="undefined"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function Mt(r,n,l){let c=r.state.charCategorizer(n.from),f=CharCategory.Space,p=n.from,k=0,E=!1,L=!1,Y=!1,Z=Ie=>{if(E)return!1;p+=l?Ie.length:-Ie.length;let at=c(Ie),ti;if(at==CharCategory.Word&&Ie.charCodeAt(0)<128&&/[\W_]/.test(Ie)&&(at=-1),f==CharCategory.Space&&(f=at),f!=at)return!1;if(f==CharCategory.Word)if(Ie.toLowerCase()==Ie){if(!l&&L)return!1;Y=!0}else if(Y){if(l)return!1;E=!0}else{if(L&&l&&c(ti=r.state.sliceDoc(p,p+1))==CharCategory.Word&&ti.toLowerCase()==ti)return!1;L=!0}return k++,!0},ye=r.moveByChar(n,l,Ie=>(Z(Ie),Z));if(Ut&&f==CharCategory.Word&&ye.from==n.from+k*(l?1:-1)){let Ie=Math.min(n.head,ye.head),at=Math.max(n.head,ye.head),ti=r.state.sliceDoc(Ie,at);if(ti.length>1&&/[\u4E00-\uffff]/.test(ti)){let Xi=Array.from(Ut.segment(ti));if(Xi.length>1)return l?EditorSelection.cursor(n.head+Xi[1].index,-1):EditorSelection.cursor(ye.head+Xi[Xi.length-1].index,1)}}return ye}function Ft(r,n){return F(r,l=>l.empty?Mt(r,l,n):$(l,n))}const Si=r=>Ft(r,!0),nt=r=>Ft(r,!1);function Xe(r,n,l){if(n.type.prop(l))return!0;let c=n.to-n.from;return c&&(c>2||/[^\s,.;:]/.test(r.sliceDoc(n.from,n.to)))||n.firstChild}function We(r,n,l){let c=(0,Ae.mv)(r).resolveInner(n.head),f=l?Fe.uY.closedBy:Fe.uY.openedBy;for(let L=n.head;;){let Y=l?c.childAfter(L):c.childBefore(L);if(!Y)break;Xe(r,Y,f)?c=Y:L=l?Y.to:Y.from}let p=c.type.prop(f),k,E;return p&&(k=l?(0,Ae.jU)(r,c.from,1):(0,Ae.jU)(r,c.to,-1))&&k.matched?E=l?k.end.to:k.end.from:E=l?c.to:c.from,B.OF.cursor(E,l?-1:1)}const Jt=r=>F(r,n=>We(r.state,n,!re(r))),rt=r=>F(r,n=>We(r.state,n,re(r)));function st(r,n){return F(r,l=>{if(!l.empty)return $(l,n);let c=r.moveVertically(l,n);return c.head!=l.head?c:r.moveToLineBoundary(l,n)})}const vt=r=>st(r,!1),ot=r=>st(r,!0);function Gt(r){let n=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,l=0,c=0,f;if(n){for(let p of r.state.facet(X.Lz.scrollMargins)){let k=p(r);k!=null&&k.top&&(l=Math.max(k==null?void 0:k.top,l)),k!=null&&k.bottom&&(c=Math.max(k==null?void 0:k.bottom,c))}f=r.scrollDOM.clientHeight-l-c}else f=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:l,marginBottom:c,selfScroll:n,height:Math.max(r.defaultLineHeight,f-5)}}function Ht(r,n){let l=Gt(r),{state:c}=r,f=A(c.selection,k=>k.empty?r.moveVertically(k,n,l.height):$(k,n));if(f.eq(c.selection))return!1;let p;if(l.selfScroll){let k=r.coordsAtPos(c.selection.main.head),E=r.scrollDOM.getBoundingClientRect(),L=E.top+l.marginTop,Y=E.bottom-l.marginBottom;k&&k.top>L&&k.bottom<Y&&(p=X.Lz.scrollIntoView(f.main.head,{y:"start",yMargin:k.top-L}))}return r.dispatch(I(c,f),{effects:p}),!0}const ut=r=>Ht(r,!1),bt=r=>Ht(r,!0);function qt(r,n,l){let c=r.lineBlockAt(n.head),f=r.moveToLineBoundary(n,l);if(f.head==n.head&&f.head!=(l?c.to:c.from)&&(f=r.moveToLineBoundary(n,l,!1)),!l&&f.head==c.from&&c.length){let p=/^\s*/.exec(r.state.sliceDoc(c.from,Math.min(c.from+100,c.to)))[0].length;p&&n.head!=c.from+p&&(f=B.OF.cursor(c.from+p))}return f}const pi=r=>F(r,n=>qt(r,n,!0)),tn=r=>F(r,n=>qt(r,n,!1)),Ni=r=>F(r,n=>qt(r,n,!re(r))),Bt=r=>F(r,n=>qt(r,n,re(r))),ji=r=>F(r,n=>B.OF.cursor(r.lineBlockAt(n.head).from,1)),li=r=>F(r,n=>B.OF.cursor(r.lineBlockAt(n.head).to,-1));function Zi(r,n,l){let c=!1,f=A(r.selection,p=>{let k=(0,Ae.jU)(r,p.head,-1)||(0,Ae.jU)(r,p.head,1)||p.head>0&&(0,Ae.jU)(r,p.head-1,1)||p.head<r.doc.length&&(0,Ae.jU)(r,p.head+1,-1);if(!k||!k.end)return p;c=!0;let E=k.start.from==p.head?k.end.to:k.end.from;return l?B.OF.range(p.anchor,E):B.OF.cursor(E)});return c?(n(I(r,f)),!0):!1}const vn=({state:r,dispatch:n})=>Zi(r,n,!1),Ii=({state:r,dispatch:n})=>Zi(r,n,!0);function Oi(r,n){let l=A(r.state.selection,c=>{let f=n(c);return B.OF.range(c.anchor,f.head,f.goalColumn,f.bidiLevel||void 0)});return l.eq(r.state.selection)?!1:(r.dispatch(I(r.state,l)),!0)}function Et(r,n){return Oi(r,l=>r.moveByChar(l,n))}const Wn=r=>Et(r,!re(r)),Pn=r=>Et(r,re(r)),qn=r=>Et(r,!0),Sn=r=>Et(r,!1);function bn(r,n){return Oi(r,l=>r.moveByGroup(l,n))}const Ls=r=>bn(r,!re(r)),us=r=>bn(r,re(r)),R=r=>bn(r,!0),a=r=>bn(r,!1);function u(r,n){return Oi(r,l=>Mt(r,l,n))}const v=r=>u(r,!0),x=r=>u(r,!1),O=r=>Oi(r,n=>We(r.state,n,!re(r))),D=r=>Oi(r,n=>We(r.state,n,re(r)));function W(r,n){return Oi(r,l=>r.moveVertically(l,n))}const U=r=>W(r,!1),se=r=>W(r,!0);function ue(r,n){return Oi(r,l=>r.moveVertically(l,n,Gt(r).height))}const ve=r=>ue(r,!1),Re=r=>ue(r,!0),De=r=>Oi(r,n=>qt(r,n,!0)),Nt=r=>Oi(r,n=>qt(r,n,!1)),$i=r=>Oi(r,n=>qt(r,n,!re(r))),mi=r=>Oi(r,n=>qt(r,n,re(r))),un=r=>Oi(r,n=>B.OF.cursor(r.lineBlockAt(n.head).from)),Ai=r=>Oi(r,n=>B.OF.cursor(r.lineBlockAt(n.head).to)),kn=({state:r,dispatch:n})=>(n(I(r,{anchor:0})),!0),ds=({state:r,dispatch:n})=>(n(I(r,{anchor:r.doc.length})),!0),zn=({state:r,dispatch:n})=>(n(I(r,{anchor:r.selection.main.anchor,head:0})),!0),Rn=({state:r,dispatch:n})=>(n(I(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),Bs=({state:r,dispatch:n})=>(n(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),ps=({state:r,dispatch:n})=>{let l=N(r).map(({from:c,to:f})=>B.OF.range(c,Math.min(f+1,r.doc.length)));return n(r.update({selection:B.OF.create(l),userEvent:"select"})),!0},Ys=({state:r,dispatch:n})=>{let l=A(r.selection,c=>{var f;let p=(0,Ae.mv)(r).resolveStack(c.from,1);for(let k=p;k;k=k.next){let{node:E}=k;if((E.from<c.from&&E.to>=c.to||E.to>c.to&&E.from<=c.from)&&(!((f=E.parent)===null||f===void 0)&&f.parent))return B.OF.range(E.to,E.from)}return c});return n(I(r,l)),!0},ms=({state:r,dispatch:n})=>{let l=r.selection,c=null;return l.ranges.length>1?c=B.OF.create([l.main]):l.main.empty||(c=B.OF.create([B.OF.cursor(l.main.head)])),c?(n(I(r,c)),!0):!1};function An(r,n){if(r.state.readOnly)return!1;let l="delete.selection",{state:c}=r,f=c.changeByRange(p=>{let{from:k,to:E}=p;if(k==E){let L=n(p);L<k?(l="delete.backward",L=Qn(r,L,!1)):L>k&&(l="delete.forward",L=Qn(r,L,!0)),k=Math.min(k,L),E=Math.max(E,L)}else k=Qn(r,k,!1),E=Qn(r,E,!0);return k==E?{range:p}:{changes:{from:k,to:E},range:B.OF.cursor(k,k<p.head?-1:1)}});return f.changes.empty?!1:(r.dispatch(c.update(f,{scrollIntoView:!0,userEvent:l,effects:l=="delete.selection"?X.Lz.announce.of(c.phrase("Selection deleted")):void 0})),!0)}function Qn(r,n,l){if(r instanceof X.Lz)for(let c of r.state.facet(X.Lz.atomicRanges).map(f=>f(r)))c.between(n,n,(f,p)=>{f<n&&p>n&&(n=l?p:f)});return n}const Ln=(r,n)=>An(r,l=>{let c=l.from,{state:f}=r,p=f.doc.lineAt(c),k,E;if(!n&&c>p.from&&c<p.from+200&&!/[^ \t]/.test(k=p.text.slice(0,c-p.from))){if(k[k.length-1]=="	")return c-1;let L=(0,B.y$)(k,f.tabSize),Y=L%(0,Ae.tp)(f)||(0,Ae.tp)(f);for(let Z=0;Z<Y&&k[k.length-1-Z]==" ";Z++)c--;E=c}else E=(0,B.zK)(p.text,c-p.from,n,n)+p.from,E==c&&p.number!=(n?f.doc.lines:1)?E+=n?1:-1:!n&&/[\ufe00-\ufe0f]/.test(p.text.slice(E-p.from,c-p.from))&&(E=(0,B.zK)(p.text,E-p.from,!1,!1)+p.from);return E}),Ki=r=>Ln(r,!1),_n=r=>Ln(r,!0),es=(r,n)=>An(r,l=>{let c=l.head,{state:f}=r,p=f.doc.lineAt(c),k=f.charCategorizer(c);for(let E=null;;){if(c==(n?p.to:p.from)){c==l.head&&p.number!=(n?f.doc.lines:1)&&(c+=n?1:-1);break}let L=(0,B.zK)(p.text,c-p.from,n)+p.from,Y=p.text.slice(Math.min(c,L)-p.from,Math.max(c,L)-p.from),Z=k(Y);if(E!=null&&Z!=E)break;(Y!=" "||c!=l.head)&&(E=Z),c=L}return c}),or=r=>es(r,!1),Js=r=>es(r,!0),Ns=r=>An(r,n=>{let l=r.lineBlockAt(n.head).to;return n.head<l?l:Math.min(r.state.doc.length,n.head+1)}),Tr=r=>An(r,n=>{let l=r.lineBlockAt(n.head).from;return n.head>l?l:Math.max(0,n.head-1)}),gs=r=>An(r,n=>{let l=r.moveToLineBoundary(n,!1).head;return n.head>l?l:Math.max(0,n.head-1)}),T=r=>An(r,n=>{let l=r.moveToLineBoundary(n,!0).head;return n.head<l?l:Math.min(r.state.doc.length,n.head+1)}),g=({state:r,dispatch:n})=>{if(r.readOnly)return!1;let l=[];for(let c=0,f="",p=r.doc.iter();;){if(p.next(),p.lineBreak||p.done){let k=f.search(/\s+$/);if(k>-1&&l.push({from:c-(f.length-k),to:c}),p.done)break;f=""}else f=p.value;c+=p.value.length}return l.length?(n(r.update({changes:l,userEvent:"delete"})),!0):!1},w=({state:r,dispatch:n})=>{if(r.readOnly)return!1;let l=r.changeByRange(c=>({changes:{from:c.from,to:c.to,insert:B.EY.of(["",""])},range:B.OF.cursor(c.from)}));return n(r.update(l,{scrollIntoView:!0,userEvent:"input"})),!0},P=({state:r,dispatch:n})=>{if(r.readOnly)return!1;let l=r.changeByRange(c=>{if(!c.empty||c.from==0||c.from==r.doc.length)return{range:c};let f=c.from,p=r.doc.lineAt(f),k=f==p.from?f-1:(0,B.zK)(p.text,f-p.from,!1)+p.from,E=f==p.to?f+1:(0,B.zK)(p.text,f-p.from,!0)+p.from;return{changes:{from:k,to:E,insert:r.doc.slice(f,E).append(r.doc.slice(k,f))},range:B.OF.cursor(E)}});return l.changes.empty?!1:(n(r.update(l,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function N(r){let n=[],l=-1;for(let c of r.selection.ranges){let f=r.doc.lineAt(c.from),p=r.doc.lineAt(c.to);if(!c.empty&&c.to==p.from&&(p=r.doc.lineAt(c.to-1)),l>=f.number){let k=n[n.length-1];k.to=p.to,k.ranges.push(c)}else n.push({from:f.from,to:p.to,ranges:[c]});l=p.number+1}return n}function K(r,n,l){if(r.readOnly)return!1;let c=[],f=[];for(let p of N(r)){if(l?p.to==r.doc.length:p.from==0)continue;let k=r.doc.lineAt(l?p.to+1:p.from-1),E=k.length+1;if(l){c.push({from:p.to,to:k.to},{from:p.from,insert:k.text+r.lineBreak});for(let L of p.ranges)f.push(B.OF.range(Math.min(r.doc.length,L.anchor+E),Math.min(r.doc.length,L.head+E)))}else{c.push({from:k.from,to:p.from},{from:p.to,insert:r.lineBreak+k.text});for(let L of p.ranges)f.push(B.OF.range(L.anchor-E,L.head-E))}}return c.length?(n(r.update({changes:c,scrollIntoView:!0,selection:B.OF.create(f,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const G=({state:r,dispatch:n})=>K(r,n,!1),le=({state:r,dispatch:n})=>K(r,n,!0);function oe(r,n,l){if(r.readOnly)return!1;let c=[];for(let f of N(r))l?c.push({from:f.from,insert:r.doc.slice(f.from,f.to)+r.lineBreak}):c.push({from:f.to,insert:r.lineBreak+r.doc.slice(f.from,f.to)});return n(r.update({changes:c,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const pe=({state:r,dispatch:n})=>oe(r,n,!1),Be=({state:r,dispatch:n})=>oe(r,n,!0),dt=r=>{if(r.state.readOnly)return!1;let{state:n}=r,l=n.changes(N(n).map(({from:f,to:p})=>(f>0?f--:p<n.doc.length&&p++,{from:f,to:p}))),c=A(n.selection,f=>r.moveVertically(f,!0)).map(l);return r.dispatch({changes:l,selection:c,scrollIntoView:!0,userEvent:"delete.line"}),!0},Ci=({state:r,dispatch:n})=>(n(r.update(r.replaceSelection(r.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);function gi(r,n){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(n-1,n+1)))return{from:n,to:n};let l=(0,Ae.mv)(r).resolveInner(n),c=l.childBefore(n),f=l.childAfter(n),p;return c&&f&&c.to<=n&&f.from>=n&&(p=c.type.prop(Fe.uY.closedBy))&&p.indexOf(f.name)>-1&&r.doc.lineAt(c.to).from==r.doc.lineAt(f.from).from&&!/\S/.test(r.sliceDoc(c.to,f.from))?{from:c.to,to:f.from}:null}const yi=ts(!1),ln=ts(!0);function ts(r){return({state:n,dispatch:l})=>{if(n.readOnly)return!1;let c=n.changeByRange(f=>{let{from:p,to:k}=f,E=n.doc.lineAt(p),L=!r&&p==k&&gi(n,p);r&&(p=k=(k<=E.to?E:n.doc.lineAt(k)).to);let Y=new Ae.KB(n,{simulateBreak:p,simulateDoubleBreak:!!L}),Z=(0,Ae._v)(Y,p);for(Z==null&&(Z=(0,B.y$)(/^\s*/.exec(n.doc.lineAt(p).text)[0],n.tabSize));k<E.to&&/\s/.test(E.text[k-E.from]);)k++;L?{from:p,to:k}=L:p>E.from&&p<E.from+100&&!/\S/.test(E.text.slice(0,p))&&(p=E.from);let ye=["",(0,Ae.EI)(n,Z)];return L&&ye.push((0,Ae.EI)(n,Y.lineIndent(E.from,-1))),{changes:{from:p,to:k,insert:B.EY.of(ye)},range:B.OF.cursor(p+1+ye[1].length)}});return l(n.update(c,{scrollIntoView:!0,userEvent:"input"})),!0}}function an(r,n){let l=-1;return r.changeByRange(c=>{let f=[];for(let k=c.from;k<=c.to;){let E=r.doc.lineAt(k);E.number>l&&(c.empty||c.to>E.from)&&(n(E,f,c),l=E.number),k=E.to+1}let p=r.changes(f);return{changes:f,range:B.OF.range(p.mapPos(c.anchor,1),p.mapPos(c.head,1))}})}const Vn=({state:r,dispatch:n})=>{if(r.readOnly)return!1;let l=Object.create(null),c=new Ae.KB(r,{overrideIndentation:p=>{let k=l[p];return k==null?-1:k}}),f=an(r,(p,k,E)=>{let L=(0,Ae._v)(c,p.from);if(L==null)return;/\S/.test(p.text)||(L=0);let Y=/^\s*/.exec(p.text)[0],Z=(0,Ae.EI)(r,L);(Y!=Z||E.from<p.from+Y.length)&&(l[p.from]=L,k.push({from:p.from,to:p.from+Y.length,insert:Z}))});return f.changes.empty||n(r.update(f,{userEvent:"indent"})),!0},Bn=({state:r,dispatch:n})=>r.readOnly?!1:(n(r.update(an(r,(l,c)=>{c.push({from:l.from,insert:r.facet(Ae.Xt)})}),{userEvent:"input.indent"})),!0),ys=({state:r,dispatch:n})=>r.readOnly?!1:(n(r.update(an(r,(l,c)=>{let f=/^\s*/.exec(l.text)[0];if(!f)return;let p=(0,B.y$)(f,r.tabSize),k=0,E=(0,Ae.EI)(r,Math.max(0,p-(0,Ae.tp)(r)));for(;k<f.length&&k<E.length&&f.charCodeAt(k)==E.charCodeAt(k);)k++;c.push({from:l.from+k,to:l.from+f.length,insert:E.slice(k)})}),{userEvent:"delete.dedent"})),!0),Co=({state:r,dispatch:n})=>r.selection.ranges.some(l=>!l.empty)?Bn({state:r,dispatch:n}):(n(r.update(r.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),Xs=[{key:"Ctrl-b",run:we,shift:Wn,preventDefault:!0},{key:"Ctrl-f",run:He,shift:Pn},{key:"Ctrl-p",run:vt,shift:U},{key:"Ctrl-n",run:ot,shift:se},{key:"Ctrl-a",run:ji,shift:un},{key:"Ctrl-e",run:li,shift:Ai},{key:"Ctrl-d",run:_n},{key:"Ctrl-h",run:Ki},{key:"Ctrl-k",run:Ns},{key:"Ctrl-Alt-h",run:or},{key:"Ctrl-o",run:w},{key:"Ctrl-t",run:P},{key:"Ctrl-v",run:bt}],lr=[{key:"ArrowLeft",run:we,shift:Wn,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:ft,shift:Ls,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Ni,shift:$i,preventDefault:!0},{key:"ArrowRight",run:He,shift:Pn,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:si,shift:us,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Bt,shift:mi,preventDefault:!0},{key:"ArrowUp",run:vt,shift:U,preventDefault:!0},{mac:"Cmd-ArrowUp",run:kn,shift:zn},{mac:"Ctrl-ArrowUp",run:ut,shift:ve},{key:"ArrowDown",run:ot,shift:se,preventDefault:!0},{mac:"Cmd-ArrowDown",run:ds,shift:Rn},{mac:"Ctrl-ArrowDown",run:bt,shift:Re},{key:"PageUp",run:ut,shift:ve},{key:"PageDown",run:bt,shift:Re},{key:"Home",run:tn,shift:Nt,preventDefault:!0},{key:"Mod-Home",run:kn,shift:zn},{key:"End",run:pi,shift:De,preventDefault:!0},{key:"Mod-End",run:ds,shift:Rn},{key:"Enter",run:yi},{key:"Mod-a",run:Bs},{key:"Backspace",run:Ki,shift:Ki},{key:"Delete",run:_n},{key:"Mod-Backspace",mac:"Alt-Backspace",run:or},{key:"Mod-Delete",mac:"Alt-Delete",run:Js},{mac:"Mod-Backspace",run:gs},{mac:"Mod-Delete",run:T}].concat(Xs.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),no=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Jt,shift:O},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:rt,shift:D},{key:"Alt-ArrowUp",run:G},{key:"Shift-Alt-ArrowUp",run:pe},{key:"Alt-ArrowDown",run:le},{key:"Shift-Alt-ArrowDown",run:Be},{key:"Escape",run:ms},{key:"Mod-Enter",run:ln},{key:"Alt-l",mac:"Ctrl-l",run:ps},{key:"Mod-i",run:Ys,preventDefault:!0},{key:"Mod-[",run:ys},{key:"Mod-]",run:Bn},{key:"Mod-Alt-\\",run:Vn},{key:"Shift-Mod-k",run:dt},{key:"Shift-Mod-\\",run:vn},{key:"Mod-/",run:wt},{key:"Alt-A",run:_e}].concat(lr),ar={key:"Tab",run:Bn,shift:ys};function ri(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var n=1,l=arguments[1];if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){for(var c in l)if(Object.prototype.hasOwnProperty.call(l,c)){var f=l[c];typeof f=="string"?r.setAttribute(c,f):f!=null&&(r[c]=f)}n++}for(;n<arguments.length;n++)hr(r,arguments[n]);return r}function hr(r,n){if(typeof n=="string")r.appendChild(document.createTextNode(n));else if(n!=null)if(n.nodeType!=null)r.appendChild(n);else if(Array.isArray(n))for(var l=0;l<n.length;l++)hr(r,n[l]);else throw new RangeError("Unsupported child node: "+n)}const Or=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class jn{constructor(n,l,c=0,f=n.length,p,k){this.test=k,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=n.iterRange(c,f),this.bufferStart=c,this.normalize=p?E=>p(Or(E)):Or,this.query=this.normalize(l)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,B.vS)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let n=this.peek();if(n<0)return this.done=!0,this;let l=(0,B.MK)(n),c=this.bufferStart+this.bufferPos;this.bufferPos+=(0,B.Fh)(n);let f=this.normalize(l);for(let p=0,k=c;;p++){let E=f.charCodeAt(p),L=this.match(E,k,this.bufferPos+this.bufferStart);if(p==f.length-1){if(L)return this.value=L,this;break}k==c&&p<l.length&&l.charCodeAt(p)==E&&k++}}}match(n,l,c){let f=null;for(let p=0;p<this.matches.length;p+=2){let k=this.matches[p],E=!1;this.query.charCodeAt(k)==n&&(k==this.query.length-1?f={from:this.matches[p+1],to:c}:(this.matches[p]++,E=!0)),E||(this.matches.splice(p,2),p-=2)}return this.query.charCodeAt(0)==n&&(this.query.length==1?f={from:l,to:c}:this.matches.push(1,l)),f&&this.test&&!this.test(f.from,f.to,this.buffer,this.bufferStart)&&(f=null),f}}typeof Symbol!="undefined"&&(jn.prototype[Symbol.iterator]=function(){return this});const vs={from:-1,to:-1,match:/.*/.exec("")},bs="gm"+(/x/.unicode==null?"":"u");class Dr{constructor(n,l,c,f=0,p=n.length){if(this.text=n,this.to=p,this.curLine="",this.done=!1,this.value=vs,/\\[sWDnr]|\n|\r|\[\^/.test(l))return new Pr(n,l,c,f,p);this.re=new RegExp(l,bs+(c!=null&&c.ignoreCase?"i":"")),this.test=c==null?void 0:c.test,this.iter=n.iter();let k=n.lineAt(f);this.curLineStart=k.from,this.matchPos=Is(n,f),this.getLine(this.curLineStart)}getLine(n){this.iter.next(n),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let n=this.matchPos-this.curLineStart;;){this.re.lastIndex=n;let l=this.matchPos<=this.to&&this.re.exec(this.curLine);if(l){let c=this.curLineStart+l.index,f=c+l[0].length;if(this.matchPos=Is(this.text,f+(c==f?1:0)),c==this.curLineStart+this.curLine.length&&this.nextLine(),(c<f||c>this.value.to)&&(!this.test||this.test(c,f,l)))return this.value={from:c,to:f,match:l},this;n=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),n=0;else return this.done=!0,this}}}const $n=new WeakMap;class xs{constructor(n,l){this.from=n,this.text=l}get to(){return this.from+this.text.length}static get(n,l,c){let f=$n.get(n);if(!f||f.from>=c||f.to<=l){let E=new xs(l,n.sliceString(l,c));return $n.set(n,E),E}if(f.from==l&&f.to==c)return f;let{text:p,from:k}=f;return k>l&&(p=n.sliceString(l,k)+p,k=l),f.to<c&&(p+=n.sliceString(f.to,c)),$n.set(n,new xs(k,p)),new xs(l,p.slice(l-k,c-k))}}class Pr{constructor(n,l,c,f,p){this.text=n,this.to=p,this.done=!1,this.value=vs,this.matchPos=Is(n,f),this.re=new RegExp(l,bs+(c!=null&&c.ignoreCase?"i":"")),this.test=c==null?void 0:c.test,this.flat=xs.get(n,f,this.chunkEnd(f+5e3))}chunkEnd(n){return n>=this.to?this.to:this.text.lineAt(n).to}next(){for(;;){let n=this.re.lastIndex=this.matchPos-this.flat.from,l=this.re.exec(this.flat.text);if(l&&!l[0]&&l.index==n&&(this.re.lastIndex=n+1,l=this.re.exec(this.flat.text)),l){let c=this.flat.from+l.index,f=c+l[0].length;if((this.flat.to>=this.to||l.index+l[0].length<=this.flat.text.length-10)&&(!this.test||this.test(c,f,l)))return this.value={from:c,to:f,match:l},this.matchPos=Is(this.text,f+(c==f?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=xs.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol!="undefined"&&(Dr.prototype[Symbol.iterator]=Pr.prototype[Symbol.iterator]=function(){return this});function Rr(r){try{return new RegExp(r,bs),!0}catch{return!1}}function Is(r,n){if(n>=r.length)return n;let l=r.lineAt(n),c;for(;n<l.to&&(c=l.text.charCodeAt(n-l.from))>=56320&&c<57344;)n++;return n}function hn(r){let n=String(r.state.doc.lineAt(r.state.selection.main.head).number),l=ri("input",{class:"cm-textfield",name:"line",value:n}),c=ri("form",{class:"cm-gotoLine",onkeydown:p=>{p.keyCode==27?(p.preventDefault(),r.dispatch({effects:nn.of(!1)}),r.focus()):p.keyCode==13&&(p.preventDefault(),f())},onsubmit:p=>{p.preventDefault(),f()}},ri("label",r.state.phrase("Go to line"),": ",l)," ",ri("button",{class:"cm-button",type:"submit"},r.state.phrase("go")));function f(){let p=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(l.value);if(!p)return;let{state:k}=r,E=k.doc.lineAt(k.selection.main.head),[,L,Y,Z,ye]=p,Ie=Z?+Z.slice(1):0,at=Y?+Y:E.number;if(Y&&ye){let Zn=at/100;L&&(Zn=Zn*(L=="-"?-1:1)+E.number/k.doc.lines),at=Math.round(k.doc.lines*Zn)}else Y&&L&&(at=at*(L=="-"?-1:1)+E.number);let ti=k.doc.line(Math.max(1,Math.min(k.doc.lines,at))),Xi=B.OF.cursor(ti.from+Math.max(0,Math.min(Ie,ti.length)));r.dispatch({effects:[nn.of(!1),X.Lz.scrollIntoView(Xi.from,{y:"center"})],selection:Xi}),r.focus()}return{dom:c}}const nn=B.Pe.define(),cr=B.sU.define({create(){return!0},update(r,n){for(let l of n.effects)l.is(nn)&&(r=l.value);return r},provide:r=>X.S7.from(r,n=>n?hn:null)}),fr=r=>{let n=(0,X.ld)(r,hn);if(!n){let l=[nn.of(!0)];r.state.field(cr,!1)==null&&l.push(B.Pe.appendConfig.of([cr,Lr])),r.dispatch({effects:l}),n=(0,X.ld)(r,hn)}return n&&n.dom.querySelector("input").select(),!0},Lr=X.Lz.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Br={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},ur=B.sj.define({combine(r){return(0,B.QR)(r,Br,{highlightWordAroundCursor:(n,l)=>n||l,minSelectionLength:Math.min,maxMatches:Math.min})}});function Nr(r){let n=[Hr,Fr];return r&&n.push(ur.of(r)),n}const so=X.NZ.mark({class:"cm-selectionMatch"}),Ir=X.NZ.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function Zs(r,n,l,c){return(l==0||r(n.sliceDoc(l-1,l))!=B.Je.Word)&&(c==n.doc.length||r(n.sliceDoc(c,c+1))!=B.Je.Word)}function qs(r,n,l,c){return r(n.sliceDoc(l,l+1))==B.Je.Word&&r(n.sliceDoc(c-1,c))==B.Je.Word}const Fr=X.Z9.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let n=r.state.facet(ur),{state:l}=r,c=l.selection;if(c.ranges.length>1)return X.NZ.none;let f=c.main,p,k=null;if(f.empty){if(!n.highlightWordAroundCursor)return X.NZ.none;let L=l.wordAt(f.head);if(!L)return X.NZ.none;k=l.charCategorizer(f.head),p=l.sliceDoc(L.from,L.to)}else{let L=f.to-f.from;if(L<n.minSelectionLength||L>200)return X.NZ.none;if(n.wholeWords){if(p=l.sliceDoc(f.from,f.to),k=l.charCategorizer(f.head),!(Zs(k,l,f.from,f.to)&&qs(k,l,f.from,f.to)))return X.NZ.none}else if(p=l.sliceDoc(f.from,f.to),!p)return X.NZ.none}let E=[];for(let L of r.visibleRanges){let Y=new jn(l.doc,p,L.from,L.to);for(;!Y.next().done;){let{from:Z,to:ye}=Y.value;if((!k||Zs(k,l,Z,ye))&&(f.empty&&Z<=f.from&&ye>=f.to?E.push(Ir.range(Z,ye)):(Z>=f.to||ye<=f.from)&&E.push(so.range(Z,ye)),E.length>n.maxMatches))return X.NZ.none}}return X.NZ.set(E)}},{decorations:r=>r.decorations}),Hr=X.Lz.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Wr=({state:r,dispatch:n})=>{let{selection:l}=r,c=B.OF.create(l.ranges.map(f=>r.wordAt(f.head)||B.OF.cursor(f.head)),l.mainIndex);return c.eq(l)?!1:(n(r.update({selection:c})),!0)};function ro(r,n){let{main:l,ranges:c}=r.selection,f=r.wordAt(l.head),p=f&&f.from==l.from&&f.to==l.to;for(let k=!1,E=new jn(r.doc,n,c[c.length-1].to);;)if(E.next(),E.done){if(k)return null;E=new jn(r.doc,n,0,Math.max(0,c[c.length-1].from-1)),k=!0}else{if(k&&c.some(L=>L.from==E.value.from))continue;if(p){let L=r.wordAt(E.value.from);if(!L||L.from!=E.value.from||L.to!=E.value.to)continue}return E.value}}const oo=({state:r,dispatch:n})=>{let{ranges:l}=r.selection;if(l.some(p=>p.from===p.to))return Wr({state:r,dispatch:n});let c=r.sliceDoc(l[0].from,l[0].to);if(r.selection.ranges.some(p=>r.sliceDoc(p.from,p.to)!=c))return!1;let f=ro(r,c);return f?(n(r.update({selection:r.selection.addRange(B.OF.range(f.from,f.to),!1),effects:X.Lz.scrollIntoView(f.to)})),!0):!1},Kn=B.sj.define({combine(r){return(0,B.QR)(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:n=>new wn(n),scrollToMatch:n=>X.Lz.scrollIntoView(n)})}});function z(r){return r?[Kn.of(r),pn]:pn}class V{constructor(n){this.search=n.search,this.caseSensitive=!!n.caseSensitive,this.literal=!!n.literal,this.regexp=!!n.regexp,this.replace=n.replace||"",this.valid=!!this.search&&(!this.regexp||Rr(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!n.wholeWord}unquote(n){return this.literal?n:n.replace(/\\([nrt\\])/g,(l,c)=>c=="n"?`
`:c=="r"?"\r":c=="t"?"	":"\\")}eq(n){return this.search==n.search&&this.replace==n.replace&&this.caseSensitive==n.caseSensitive&&this.regexp==n.regexp&&this.wholeWord==n.wholeWord}create(){return this.regexp?new Ze(this):new me(this)}getCursor(n,l=0,c){let f=n.doc?n:B.$t.create({doc:n});return c==null&&(c=f.doc.length),this.regexp?be(this,f,l,c):ie(this,f,l,c)}}class Q{constructor(n){this.spec=n}}function ie(r,n,l,c){return new jn(n.doc,r.unquoted,l,c,r.caseSensitive?void 0:f=>f.toLowerCase(),r.wholeWord?fe(n.doc,n.charCategorizer(n.selection.main.head)):void 0)}function fe(r,n){return(l,c,f,p)=>((p>l||p+f.length<c)&&(p=Math.max(0,l-2),f=r.sliceString(p,Math.min(r.length,c+2))),(n(Ve(f,l-p))!=B.Je.Word||n(Tt(f,l-p))!=B.Je.Word)&&(n(Tt(f,c-p))!=B.Je.Word||n(Ve(f,c-p))!=B.Je.Word))}class me extends Q{constructor(n){super(n)}nextMatch(n,l,c){let f=ie(this.spec,n,c,n.doc.length).nextOverlapping();return f.done&&(f=ie(this.spec,n,0,l).nextOverlapping()),f.done?null:f.value}prevMatchInRange(n,l,c){for(let f=c;;){let p=Math.max(l,f-1e4-this.spec.unquoted.length),k=ie(this.spec,n,p,f),E=null;for(;!k.nextOverlapping().done;)E=k.value;if(E)return E;if(p==l)return null;f-=1e4}}prevMatch(n,l,c){return this.prevMatchInRange(n,0,l)||this.prevMatchInRange(n,c,n.doc.length)}getReplacement(n){return this.spec.unquote(this.spec.replace)}matchAll(n,l){let c=ie(this.spec,n,0,n.doc.length),f=[];for(;!c.next().done;){if(f.length>=l)return null;f.push(c.value)}return f}highlight(n,l,c,f){let p=ie(this.spec,n,Math.max(0,l-this.spec.unquoted.length),Math.min(c+this.spec.unquoted.length,n.doc.length));for(;!p.next().done;)f(p.value.from,p.value.to)}}function be(r,n,l,c){return new Dr(n.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?kt(n.charCategorizer(n.selection.main.head)):void 0},l,c)}function Ve(r,n){return r.slice((0,B.zK)(r,n,!1),n)}function Tt(r,n){return r.slice(n,(0,B.zK)(r,n))}function kt(r){return(n,l,c)=>!c[0].length||(r(Ve(c.input,c.index))!=B.Je.Word||r(Tt(c.input,c.index))!=B.Je.Word)&&(r(Tt(c.input,c.index+c[0].length))!=B.Je.Word||r(Ve(c.input,c.index+c[0].length))!=B.Je.Word)}class Ze extends Q{nextMatch(n,l,c){let f=be(this.spec,n,c,n.doc.length).next();return f.done&&(f=be(this.spec,n,0,l).next()),f.done?null:f.value}prevMatchInRange(n,l,c){for(let f=1;;f++){let p=Math.max(l,c-f*1e4),k=be(this.spec,n,p,c),E=null;for(;!k.next().done;)E=k.value;if(E&&(p==l||E.from>p+10))return E;if(p==l)return null}}prevMatch(n,l,c){return this.prevMatchInRange(n,0,l)||this.prevMatchInRange(n,c,n.doc.length)}getReplacement(n){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(l,c)=>c=="$"?"$":c=="&"?n.match[0]:c!="0"&&+c<n.match.length?n.match[c]:l)}matchAll(n,l){let c=be(this.spec,n,0,n.doc.length),f=[];for(;!c.next().done;){if(f.length>=l)return null;f.push(c.value)}return f}highlight(n,l,c,f){let p=be(this.spec,n,Math.max(0,l-250),Math.min(c+250,n.doc.length));for(;!p.next().done;)f(p.value.from,p.value.to)}}const Te=B.Pe.define(),ke=B.Pe.define(),lt=B.sU.define({create(r){return new Xt(Cn(r).create(),null)},update(r,n){for(let l of n.effects)l.is(Te)?r=new Xt(l.value.create(),r.panel):l.is(ke)&&(r=new Xt(r.query,l.value?dn:null));return r},provide:r=>X.S7.from(r,n=>n.panel)});function Ue(r){let n=r.field(lt,!1);return n?n.query.spec:Cn(r)}function ai(r){var n;return((n=r.field(lt,!1))===null||n===void 0?void 0:n.panel)!=null}class Xt{constructor(n,l){this.query=n,this.panel=l}}const Vt=X.NZ.mark({class:"cm-searchMatch"}),Yi=X.NZ.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Di=X.Z9.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(lt))}update(r){let n=r.state.field(lt);(n!=r.startState.field(lt)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(n))}highlight({query:r,panel:n}){if(!n||!r.spec.valid)return X.NZ.none;let{view:l}=this,c=new B.vB;for(let f=0,p=l.visibleRanges,k=p.length;f<k;f++){let{from:E,to:L}=p[f];for(;f<k-1&&L>p[f+1].from-2*250;)L=p[++f].to;r.highlight(l.state,E,L,(Y,Z)=>{let ye=l.state.selection.ranges.some(Ie=>Ie.from==Y&&Ie.to==Z);c.add(Y,Z,ye?Yi:Vt)})}return c.finish()}},{decorations:r=>r.decorations});function Pi(r){return n=>{let l=n.state.field(lt,!1);return l&&l.query.spec.valid?r(n,l):Ri(n)}}const Fi=Pi((r,{query:n})=>{let{to:l}=r.state.selection.main,c=n.nextMatch(r.state,l,l);if(!c)return!1;let f=B.OF.single(c.from,c.to),p=r.state.facet(Kn);return r.dispatch({selection:f,effects:[Wi(r,c),p.scrollToMatch(f.main,r)],userEvent:"select.search"}),xn(r),!0}),jt=Pi((r,{query:n})=>{let{state:l}=r,{from:c}=l.selection.main,f=n.prevMatch(l,c,c);if(!f)return!1;let p=B.OF.single(f.from,f.to),k=r.state.facet(Kn);return r.dispatch({selection:p,effects:[Wi(r,f),k.scrollToMatch(p.main,r)],userEvent:"select.search"}),xn(r),!0}),Un=Pi((r,{query:n})=>{let l=n.matchAll(r.state,1e3);return!l||!l.length?!1:(r.dispatch({selection:B.OF.create(l.map(c=>B.OF.range(c.from,c.to))),userEvent:"select.search.matches"}),!0)}),vi=({state:r,dispatch:n})=>{let l=r.selection;if(l.ranges.length>1||l.main.empty)return!1;let{from:c,to:f}=l.main,p=[],k=0;for(let E=new jn(r.doc,r.sliceDoc(c,f));!E.next().done;){if(p.length>1e3)return!1;E.value.from==c&&(k=p.length),p.push(B.OF.range(E.value.from,E.value.to))}return n(r.update({selection:B.OF.create(p,k),userEvent:"select.search.matches"})),!0},Hi=Pi((r,{query:n})=>{let{state:l}=r,{from:c,to:f}=l.selection.main;if(l.readOnly)return!1;let p=n.nextMatch(l,c,c);if(!p)return!1;let k=[],E,L,Y=[];if(p.from==c&&p.to==f&&(L=l.toText(n.getReplacement(p)),k.push({from:p.from,to:p.to,insert:L}),p=n.nextMatch(l,p.from,p.to),Y.push(X.Lz.announce.of(l.phrase("replaced match on line $",l.doc.lineAt(c).number)+"."))),p){let Z=k.length==0||k[0].from>=p.to?0:p.to-p.from-L.length;E=B.OF.single(p.from-Z,p.to-Z),Y.push(Wi(r,p)),Y.push(l.facet(Kn).scrollToMatch(E.main,r))}return r.dispatch({changes:k,selection:E,effects:Y,userEvent:"input.replace"}),!0}),Ui=Pi((r,{query:n})=>{if(r.state.readOnly)return!1;let l=n.matchAll(r.state,1e9).map(f=>{let{from:p,to:k}=f;return{from:p,to:k,insert:n.getReplacement(f)}});if(!l.length)return!1;let c=r.state.phrase("replaced $ matches",l.length)+".";return r.dispatch({changes:l,effects:X.Lz.announce.of(c),userEvent:"input.replace.all"}),!0});function dn(r){return r.state.facet(Kn).createPanel(r)}function Cn(r,n){var l,c,f,p,k;let E=r.selection.main,L=E.empty||E.to>E.from+100?"":r.sliceDoc(E.from,E.to);if(n&&!L)return n;let Y=r.facet(Kn);return new V({search:((l=n==null?void 0:n.literal)!==null&&l!==void 0?l:Y.literal)?L:L.replace(/\n/g,"\\n"),caseSensitive:(c=n==null?void 0:n.caseSensitive)!==null&&c!==void 0?c:Y.caseSensitive,literal:(f=n==null?void 0:n.literal)!==null&&f!==void 0?f:Y.literal,regexp:(p=n==null?void 0:n.regexp)!==null&&p!==void 0?p:Y.regexp,wholeWord:(k=n==null?void 0:n.wholeWord)!==null&&k!==void 0?k:Y.wholeWord})}function hi(r){let n=(0,X.ld)(r,dn);return n&&n.dom.querySelector("[main-field]")}function xn(r){let n=hi(r);n&&n==r.root.activeElement&&n.select()}const Ri=r=>{let n=r.state.field(lt,!1);if(n&&n.panel){let l=hi(r);if(l&&l!=r.root.activeElement){let c=Cn(r.state,n.query.spec);c.valid&&r.dispatch({effects:Te.of(c)}),l.focus(),l.select()}}else r.dispatch({effects:[ke.of(!0),n?Te.of(Cn(r.state,n.query.spec)):B.Pe.appendConfig.of(pn)]});return!0},is=r=>{let n=r.state.field(lt,!1);if(!n||!n.panel)return!1;let l=(0,X.ld)(r,dn);return l&&l.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:ke.of(!1)}),!0},Qs=[{key:"Mod-f",run:Ri,scope:"editor search-panel"},{key:"F3",run:Fi,shift:jt,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Fi,shift:jt,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:is,scope:"editor search-panel"},{key:"Mod-Shift-l",run:vi},{key:"Mod-Alt-g",run:fr},{key:"Mod-d",run:oo,preventDefault:!0}];class wn{constructor(n){this.view=n;let l=this.query=n.state.field(lt).query.spec;this.commit=this.commit.bind(this),this.searchField=ri("input",{value:l.search,placeholder:Ji(n,"Find"),"aria-label":Ji(n,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ri("input",{value:l.replace,placeholder:Ji(n,"Replace"),"aria-label":Ji(n,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ri("input",{type:"checkbox",name:"case",form:"",checked:l.caseSensitive,onchange:this.commit}),this.reField=ri("input",{type:"checkbox",name:"re",form:"",checked:l.regexp,onchange:this.commit}),this.wordField=ri("input",{type:"checkbox",name:"word",form:"",checked:l.wholeWord,onchange:this.commit});function c(f,p,k){return ri("button",{class:"cm-button",name:f,onclick:p,type:"button"},k)}this.dom=ri("div",{onkeydown:f=>this.keydown(f),class:"cm-search"},[this.searchField,c("next",()=>Fi(n),[Ji(n,"next")]),c("prev",()=>jt(n),[Ji(n,"previous")]),c("select",()=>Un(n),[Ji(n,"all")]),ri("label",null,[this.caseField,Ji(n,"match case")]),ri("label",null,[this.reField,Ji(n,"regexp")]),ri("label",null,[this.wordField,Ji(n,"by word")]),...n.state.readOnly?[]:[ri("br"),this.replaceField,c("replace",()=>Hi(n),[Ji(n,"replace")]),c("replaceAll",()=>Ui(n),[Ji(n,"replace all")])],ri("button",{name:"close",onclick:()=>is(n),"aria-label":Ji(n,"close"),type:"button"},["\xD7"])])}commit(){let n=new V({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});n.eq(this.query)||(this.query=n,this.view.dispatch({effects:Te.of(n)}))}keydown(n){(0,X.TS)(this.view,n,"search-panel")?n.preventDefault():n.keyCode==13&&n.target==this.searchField?(n.preventDefault(),(n.shiftKey?jt:Fi)(this.view)):n.keyCode==13&&n.target==this.replaceField&&(n.preventDefault(),Hi(this.view))}update(n){for(let l of n.transactions)for(let c of l.effects)c.is(Te)&&!c.value.eq(this.query)&&this.setQuery(c.value)}setQuery(n){this.query=n,this.searchField.value=n.search,this.replaceField.value=n.replace,this.caseField.checked=n.caseSensitive,this.reField.checked=n.regexp,this.wordField.checked=n.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Kn).top}}function Ji(r,n){return r.state.phrase(n)}const Mn=30,En=/[\s\.,:;?!]/;function Wi(r,{from:n,to:l}){let c=r.state.doc.lineAt(n),f=r.state.doc.lineAt(l).to,p=Math.max(c.from,n-Mn),k=Math.min(f,l+Mn),E=r.state.sliceDoc(p,k);if(p!=c.from){for(let L=0;L<Mn;L++)if(!En.test(E[L+1])&&En.test(E[L])){E=E.slice(L);break}}if(k!=f){for(let L=E.length-1;L>E.length-Mn;L--)if(!En.test(E[L-1])&&En.test(E[L])){E=E.slice(0,L);break}}return X.Lz.announce.of(`${r.state.phrase("current match")}. ${E} ${r.state.phrase("on line")} ${c.number}.`)}const Tn=X.Lz.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),pn=[lt,B.Nb.low(Di),Tn];class ws{constructor(n,l,c){this.state=n,this.pos=l,this.explicit=c,this.abortListeners=[]}tokenBefore(n){let l=(0,Ae.mv)(this.state).resolveInner(this.pos,-1);for(;l&&n.indexOf(l.name)<0;)l=l.parent;return l?{from:l.from,to:this.pos,text:this.state.sliceDoc(l.from,this.pos),type:l.type}:null}matchBefore(n){let l=this.state.doc.lineAt(this.pos),c=Math.max(l.from,this.pos-250),f=l.text.slice(c-l.from,this.pos-l.from),p=f.search(As(n,!1));return p<0?null:{from:c+p,to:this.pos,text:f.slice(p)}}get aborted(){return this.abortListeners==null}addEventListener(n,l){n=="abort"&&this.abortListeners&&this.abortListeners.push(l)}}function Ss(r){let n=Object.keys(r).join(""),l=/\w/.test(n);return l&&(n=n.replace(/\w/g,"")),`[${l?"\\w":""}${n.replace(/[^\w\s]/g,"\\$&")}]`}function cn(r){let n=Object.create(null),l=Object.create(null);for(let{label:f}of r){n[f[0]]=!0;for(let p=1;p<f.length;p++)l[f[p]]=!0}let c=Ss(n)+Ss(l)+"*$";return[new RegExp("^"+c),new RegExp(c)]}function _s(r){let n=r.map(f=>typeof f=="string"?{label:f}:f),[l,c]=n.every(f=>/^\w+$/.test(f.label))?[/\w*$/,/\w+$/]:cn(n);return f=>{let p=f.matchBefore(c);return p||f.explicit?{from:p?p.from:f.pos,options:n,validFor:l}:null}}function Nn(r,n){return l=>{for(let c=syntaxTree(l.state).resolveInner(l.pos,-1);c;c=c.parent){if(r.indexOf(c.name)>-1)return n(l);if(c.type.isTop)break}return null}}function ks(r,n){return l=>{for(let c=syntaxTree(l.state).resolveInner(l.pos,-1);c;c=c.parent){if(r.indexOf(c.name)>-1)return null;if(c.type.isTop)break}return n(l)}}class Gn{constructor(n,l,c,f){this.completion=n,this.source=l,this.match=c,this.score=f}}function sn(r){return r.selection.main.from}function As(r,n){var l;let{source:c}=r,f=n&&c[0]!="^",p=c[c.length-1]!="$";return!f&&!p?r:new RegExp(`${f?"^":""}(?:${c})${p?"$":""}`,(l=r.flags)!==null&&l!==void 0?l:r.ignoreCase?"i":"")}const In=B.YH.define();function On(r,n,l,c){let{main:f}=r.selection,p=l-f.from,k=c-f.from;return Object.assign(Object.assign({},r.changeByRange(E=>E!=f&&l!=c&&r.sliceDoc(E.from+p,E.from+k)!=r.sliceDoc(l,c)?{range:E}:{changes:{from:E.from+p,to:c==f.from?E.to:E.from+k,insert:n},range:B.OF.cursor(E.from+p+n.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const Yn=new WeakMap;function Jn(r){if(!Array.isArray(r))return r;let n=Yn.get(r);return n||Yn.set(r,n=_s(r)),n}const Fn=B.Pe.define(),ns=B.Pe.define();class Fs{constructor(n){this.pattern=n,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let l=0;l<n.length;){let c=(0,B.vS)(n,l),f=(0,B.Fh)(c);this.chars.push(c);let p=n.slice(l,l+f),k=p.toUpperCase();this.folded.push((0,B.vS)(k==p?p.toLowerCase():k,0)),l+=f}this.astral=n.length!=this.chars.length}ret(n,l){return this.score=n,this.matched=l,!0}match(n){if(this.pattern.length==0)return this.ret(-100,[]);if(n.length<this.pattern.length)return!1;let{chars:l,folded:c,any:f,precise:p,byWord:k}=this;if(l.length==1){let Ei=(0,B.vS)(n,0),cs=(0,B.Fh)(Ei),Dn=cs==n.length?0:-100;if(Ei!=l[0])if(Ei==c[0])Dn+=-200;else return!1;return this.ret(Dn,[0,cs])}let E=n.indexOf(this.pattern);if(E==0)return this.ret(n.length==this.pattern.length?0:-100,[0,this.pattern.length]);let L=l.length,Y=0;if(E<0){for(let Ei=0,cs=Math.min(n.length,200);Ei<cs&&Y<L;){let Dn=(0,B.vS)(n,Ei);(Dn==l[Y]||Dn==c[Y])&&(f[Y++]=Ei),Ei+=(0,B.Fh)(Dn)}if(Y<L)return!1}let Z=0,ye=0,Ie=!1,at=0,ti=-1,Xi=-1,Zn=/[a-z]/.test(n),Ds=!0;for(let Ei=0,cs=Math.min(n.length,200),Dn=0;Ei<cs&&ye<L;){let rn=(0,B.vS)(n,Ei);E<0&&(Z<L&&rn==l[Z]&&(p[Z++]=Ei),at<L&&(rn==l[at]||rn==c[at]?(at==0&&(ti=Ei),Xi=Ei+1,at++):at=0));let Ps,Rs=rn<255?rn>=48&&rn<=57||rn>=97&&rn<=122?2:rn>=65&&rn<=90?1:0:(Ps=(0,B.MK)(rn))!=Ps.toLowerCase()?1:Ps!=Ps.toUpperCase()?2:0;(!Ei||Rs==1&&Zn||Dn==0&&Rs!=0)&&(l[ye]==rn||c[ye]==rn&&(Ie=!0)?k[ye++]=Ei:k.length&&(Ds=!1)),Dn=Rs,Ei+=(0,B.Fh)(rn)}return ye==L&&k[0]==0&&Ds?this.result(-100+(Ie?-200:0),k,n):at==L&&ti==0?this.ret(-200-n.length+(Xi==n.length?0:-100),[0,Xi]):E>-1?this.ret(-700-n.length,[E,E+this.pattern.length]):at==L?this.ret(-200+-700-n.length,[ti,Xi]):ye==L?this.result(-100+(Ie?-200:0)+-700+(Ds?0:-1100),k,n):l.length==2?!1:this.result((f[0]?-700:0)+-200+-1100,f,n)}result(n,l,c){let f=[],p=0;for(let k of l){let E=k+(this.astral?(0,B.Fh)((0,B.vS)(c,k)):1);p&&f[p-1]==k?f[p-1]=E:(f[p++]=k,f[p++]=E)}return this.ret(n-c.length,f)}}const bi=B.sj.define({combine(r){return(0,B.QR)(r,{activateOnTyping:!0,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Hn,compareCompletions:(n,l)=>n.label.localeCompare(l.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(n,l)=>n&&l,closeOnBlur:(n,l)=>n&&l,icons:(n,l)=>n&&l,tooltipClass:(n,l)=>c=>mn(n(c),l(c)),optionClass:(n,l)=>c=>mn(n(c),l(c)),addToOptions:(n,l)=>n.concat(l)})}});function mn(r,n){return r?n?r+" "+n:r:n}function Hn(r,n,l,c,f,p){let k=r.textDirection==X.OP.RTL,E=k,L=!1,Y="top",Z,ye,Ie=n.left-f.left,at=f.right-n.right,ti=c.right-c.left,Xi=c.bottom-c.top;if(E&&Ie<Math.min(ti,at)?E=!1:!E&&at<Math.min(ti,Ie)&&(E=!0),ti<=(E?Ie:at))Z=Math.max(f.top,Math.min(l.top,f.bottom-Xi))-n.top,ye=Math.min(400,E?Ie:at);else{L=!0,ye=Math.min(400,(k?n.right:f.right-n.left)-30);let Ei=f.bottom-n.bottom;Ei>=Xi||Ei>n.top?Z=l.bottom-n.top:(Y="bottom",Z=n.bottom-l.top)}let Zn=(n.bottom-n.top)/p.offsetHeight,Ds=(n.right-n.left)/p.offsetWidth;return{style:`${Y}: ${Z/Zn}px; max-width: ${ye/Ds}px`,class:"cm-completionInfo-"+(L?k?"left-narrow":"right-narrow":E?"left":"right")}}function gn(r){let n=r.addToOptions.slice();return r.icons&&n.push({render(l){let c=document.createElement("div");return c.classList.add("cm-completionIcon"),l.type&&c.classList.add(...l.type.split(/\s+/g).map(f=>"cm-completionIcon-"+f)),c.setAttribute("aria-hidden","true"),c},position:20}),n.push({render(l,c,f,p){let k=document.createElement("span");k.className="cm-completionLabel";let E=l.displayLabel||l.label,L=0;for(let Y=0;Y<p.length;){let Z=p[Y++],ye=p[Y++];Z>L&&k.appendChild(document.createTextNode(E.slice(L,Z)));let Ie=k.appendChild(document.createElement("span"));Ie.appendChild(document.createTextNode(E.slice(Z,ye))),Ie.className="cm-completionMatchedText",L=ye}return L<E.length&&k.appendChild(document.createTextNode(E.slice(L))),k},position:50},{render(l){if(!l.detail)return null;let c=document.createElement("span");return c.className="cm-completionDetail",c.textContent=l.detail,c},position:80}),n.sort((l,c)=>l.position-c.position).map(l=>l.render)}function Rt(r,n,l){if(r<=l)return{from:0,to:r};if(n<0&&(n=0),n<=r>>1){let f=Math.floor(n/l);return{from:f*l,to:(f+1)*l}}let c=Math.floor((r-n)/l);return{from:r-(c+1)*l,to:r-c*l}}class er{constructor(n,l,c){this.view=n,this.stateField=l,this.applyCompletion=c,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:L=>this.placeInfo(L),key:this},this.space=null,this.currentClass="";let f=n.state.field(l),{options:p,selected:k}=f.open,E=n.state.facet(bi);this.optionContent=gn(E),this.optionClass=E.optionClass,this.tooltipClass=E.tooltipClass,this.range=Rt(p.length,k,E.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(n.state),this.dom.addEventListener("mousedown",L=>{let{options:Y}=n.state.field(l).open;for(let Z=L.target,ye;Z&&Z!=this.dom;Z=Z.parentNode)if(Z.nodeName=="LI"&&(ye=/-(\d+)$/.exec(Z.id))&&+ye[1]<Y.length){this.applyCompletion(n,Y[+ye[1]]),L.preventDefault();return}}),this.dom.addEventListener("focusout",L=>{let Y=n.state.field(this.stateField,!1);Y&&Y.tooltip&&n.state.facet(bi).closeOnBlur&&L.relatedTarget!=n.contentDOM&&n.dispatch({effects:ns.of(null)})}),this.showOptions(p,f.id)}mount(){this.updateSel()}showOptions(n,l){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(n,l,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(n){var l;let c=n.state.field(this.stateField),f=n.startState.field(this.stateField);if(this.updateTooltipClass(n.state),c!=f){let{options:p,selected:k,disabled:E}=c.open;(!f.open||f.open.options!=p)&&(this.range=Rt(p.length,k,n.state.facet(bi).maxRenderedOptions),this.showOptions(p,c.id)),this.updateSel(),E!=((l=f.open)===null||l===void 0?void 0:l.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!E)}}updateTooltipClass(n){let l=this.tooltipClass(n);if(l!=this.currentClass){for(let c of this.currentClass.split(" "))c&&this.dom.classList.remove(c);for(let c of l.split(" "))c&&this.dom.classList.add(c);this.currentClass=l}}positioned(n){this.space=n,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let n=this.view.state.field(this.stateField),l=n.open;if((l.selected>-1&&l.selected<this.range.from||l.selected>=this.range.to)&&(this.range=Rt(l.options.length,l.selected,this.view.state.facet(bi).maxRenderedOptions),this.showOptions(l.options,n.id)),this.updateSelectedOption(l.selected)){this.destroyInfo();let{completion:c}=l.options[l.selected],{info:f}=c;if(!f)return;let p=typeof f=="string"?document.createTextNode(f):f(c);if(!p)return;"then"in p?p.then(k=>{k&&this.view.state.field(this.stateField,!1)==n&&this.addInfoPane(k,c)}).catch(k=>(0,X.c_)(this.view.state,k,"completion info")):this.addInfoPane(p,c)}}addInfoPane(n,l){this.destroyInfo();let c=this.info=document.createElement("div");if(c.className="cm-tooltip cm-completionInfo",n.nodeType!=null)c.appendChild(n),this.infoDestroy=null;else{let{dom:f,destroy:p}=n;c.appendChild(f),this.infoDestroy=p||null}this.dom.appendChild(c),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(n){let l=null;for(let c=this.list.firstChild,f=this.range.from;c;c=c.nextSibling,f++)c.nodeName!="LI"||!c.id?f--:f==n?c.hasAttribute("aria-selected")||(c.setAttribute("aria-selected","true"),l=c):c.hasAttribute("aria-selected")&&c.removeAttribute("aria-selected");return l&&Cs(this.list,l),l}measureInfo(){let n=this.dom.querySelector("[aria-selected]");if(!n||!this.info)return null;let l=this.dom.getBoundingClientRect(),c=this.info.getBoundingClientRect(),f=n.getBoundingClientRect(),p=this.space;if(!p){let k=this.dom.ownerDocument.defaultView||window;p={left:0,top:0,right:k.innerWidth,bottom:k.innerHeight}}return f.top>Math.min(p.bottom,l.bottom)-10||f.bottom<Math.max(p.top,l.top)+10?null:this.view.state.facet(bi).positionInfo(this.view,l,f,c,p,this.dom)}placeInfo(n){this.info&&(n?(n.style&&(this.info.style.cssText=n.style),this.info.className="cm-tooltip cm-completionInfo "+(n.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(n,l,c){const f=document.createElement("ul");f.id=l,f.setAttribute("role","listbox"),f.setAttribute("aria-expanded","true"),f.setAttribute("aria-label",this.view.state.phrase("Completions"));let p=null;for(let k=c.from;k<c.to;k++){let{completion:E,match:L}=n[k],{section:Y}=E;if(Y){let Ie=typeof Y=="string"?Y:Y.name;if(Ie!=p&&(k>c.from||c.from==0))if(p=Ie,typeof Y!="string"&&Y.header)f.appendChild(Y.header(Y));else{let at=f.appendChild(document.createElement("completion-section"));at.textContent=Ie}}const Z=f.appendChild(document.createElement("li"));Z.id=l+"-"+k,Z.setAttribute("role","option");let ye=this.optionClass(E);ye&&(Z.className=ye);for(let Ie of this.optionContent){let at=Ie(E,this.view.state,this.view,L);at&&Z.appendChild(at)}}return c.from&&f.classList.add("cm-completionListIncompleteTop"),c.to<n.length&&f.classList.add("cm-completionListIncompleteBottom"),f}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function tr(r,n){return l=>new er(l,r,n)}function Cs(r,n){let l=r.getBoundingClientRect(),c=n.getBoundingClientRect(),f=l.height/r.offsetHeight;c.top<l.top?r.scrollTop-=(l.top-c.top)/f:c.bottom>l.bottom&&(r.scrollTop+=(c.bottom-l.bottom)/f)}function ss(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function qi(r,n){let l=[],c=null,f=L=>{l.push(L);let{section:Y}=L.completion;if(Y){c||(c=[]);let Z=typeof Y=="string"?Y:Y.name;c.some(ye=>ye.name==Z)||c.push(typeof Y=="string"?{name:Z}:Y)}};for(let L of r)if(L.hasResult()){let Y=L.result.getMatch;if(L.result.filter===!1)for(let Z of L.result.options)f(new Gn(Z,L.source,Y?Y(Z):[],1e9-l.length));else{let Z=new Fs(n.sliceDoc(L.from,L.to));for(let ye of L.result.options)if(Z.match(ye.label)){let Ie=ye.displayLabel?Y?Y(ye,Z.matched):[]:Z.matched;f(new Gn(ye,L.source,Ie,Z.score+(ye.boost||0)))}}}if(c){let L=Object.create(null),Y=0,Z=(ye,Ie)=>{var at,ti;return((at=ye.rank)!==null&&at!==void 0?at:1e9)-((ti=Ie.rank)!==null&&ti!==void 0?ti:1e9)||(ye.name<Ie.name?-1:1)};for(let ye of c.sort(Z))Y-=1e5,L[ye.name]=Y;for(let ye of l){let{section:Ie}=ye.completion;Ie&&(ye.score+=L[typeof Ie=="string"?Ie:Ie.name])}}let p=[],k=null,E=n.facet(bi).compareCompletions;for(let L of l.sort((Y,Z)=>Z.score-Y.score||E(Y.completion,Z.completion))){let Y=L.completion;!k||k.label!=Y.label||k.detail!=Y.detail||k.type!=null&&Y.type!=null&&k.type!=Y.type||k.apply!=Y.apply||k.boost!=Y.boost?p.push(L):ss(L.completion)>ss(k)&&(p[p.length-1]=L),k=L.completion}return p}class Pe{constructor(n,l,c,f,p,k){this.options=n,this.attrs=l,this.tooltip=c,this.timestamp=f,this.selected=p,this.disabled=k}setSelected(n,l){return n==this.selected||n>=this.options.length?this:new Pe(this.options,dr(l,n),this.tooltip,this.timestamp,n,this.disabled)}static build(n,l,c,f,p){let k=qi(n,l);if(!k.length)return f&&n.some(L=>L.state==1)?new Pe(f.options,f.attrs,f.tooltip,f.timestamp,f.selected,!0):null;let E=l.facet(bi).selectOnOpen?0:-1;if(f&&f.selected!=E&&f.selected!=-1){let L=f.options[f.selected].completion;for(let Y=0;Y<k.length;Y++)if(k[Y].completion==L){E=Y;break}}return new Pe(k,dr(c,E),{pos:n.reduce((L,Y)=>Y.hasResult()?Math.min(L,Y.from):L,1e8),create:ls,above:p.aboveCursor},f?f.timestamp:Date.now(),E,!1)}map(n){return new Pe(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:n.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Qt{constructor(n,l,c){this.active=n,this.id=l,this.open=c}static start(){return new Qt(zr,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(n){let{state:l}=n,c=l.facet(bi),p=(c.override||l.languageDataAt("autocomplete",sn(l)).map(Jn)).map(E=>(this.active.find(Y=>Y.source==E)||new ki(E,this.active.some(Y=>Y.state!=0)?1:0)).update(n,c));p.length==this.active.length&&p.every((E,L)=>E==this.active[L])&&(p=this.active);let k=this.open;k&&n.docChanged&&(k=k.map(n.changes)),n.selection||p.some(E=>E.hasResult()&&n.changes.touchesRange(E.from,E.to))||!rs(p,this.active)?k=Pe.build(p,l,this.id,k,c):k&&k.disabled&&!p.some(E=>E.state==1)&&(k=null),!k&&p.every(E=>E.state!=1)&&p.some(E=>E.hasResult())&&(p=p.map(E=>E.hasResult()?new ki(E.source,0):E));for(let E of n.effects)E.is(Xn)&&(k=k&&k.setSelected(E.value,this.id));return p==this.active&&k==this.open?this:new Qt(p,this.id,k)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:os}}function rs(r,n){if(r==n)return!0;for(let l=0,c=0;;){for(;l<r.length&&!r[l].hasResult;)l++;for(;c<n.length&&!n[c].hasResult;)c++;let f=l==r.length,p=c==n.length;if(f||p)return f==p;if(r[l++].result!=n[c++].result)return!1}}const os={"aria-autocomplete":"list"};function dr(r,n){let l={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return n>-1&&(l["aria-activedescendant"]=r+"-"+n),l}const zr=[];function Hs(r){return r.isUserEvent("input.type")?"input":r.isUserEvent("delete.backward")?"delete":null}class ki{constructor(n,l,c=-1){this.source=n,this.state=l,this.explicitPos=c}hasResult(){return!1}update(n,l){let c=Hs(n),f=this;c?f=f.handleUserEvent(n,c,l):n.docChanged?f=f.handleChange(n):n.selection&&f.state!=0&&(f=new ki(f.source,0));for(let p of n.effects)if(p.is(Fn))f=new ki(f.source,1,p.value?sn(n.state):-1);else if(p.is(ns))f=new ki(f.source,0);else if(p.is(ir))for(let k of p.value)k.source==f.source&&(f=k);return f}handleUserEvent(n,l,c){return l=="delete"||!c.activateOnTyping?this.map(n.changes):new ki(this.source,1)}handleChange(n){return n.changes.touchesRange(sn(n.startState))?new ki(this.source,0):this.map(n.changes)}map(n){return n.empty||this.explicitPos<0?this:new ki(this.source,this.state,n.mapPos(this.explicitPos))}}class Ms extends ki{constructor(n,l,c,f,p){super(n,2,l),this.result=c,this.from=f,this.to=p}hasResult(){return!0}handleUserEvent(n,l,c){var f;let p=n.changes.mapPos(this.from),k=n.changes.mapPos(this.to,1),E=sn(n.state);if((this.explicitPos<0?E<=p:E<this.from)||E>k||l=="delete"&&sn(n.startState)==this.from)return new ki(this.source,l=="input"&&c.activateOnTyping?1:0);let L=this.explicitPos<0?-1:n.changes.mapPos(this.explicitPos),Y;return lo(this.result.validFor,n.state,p,k)?new Ms(this.source,L,this.result,p,k):this.result.update&&(Y=this.result.update(this.result,p,k,new ws(n.state,E,L>=0)))?new Ms(this.source,L,Y,Y.from,(f=Y.to)!==null&&f!==void 0?f:sn(n.state)):new ki(this.source,1,L)}handleChange(n){return n.changes.touchesRange(this.from,this.to)?new ki(this.source,0):this.map(n.changes)}map(n){return n.empty?this:new Ms(this.source,this.explicitPos<0?-1:n.mapPos(this.explicitPos),this.result,n.mapPos(this.from),n.mapPos(this.to,1))}}function lo(r,n,l,c){if(!r)return!1;let f=n.sliceDoc(l,c);return typeof r=="function"?r(f,l,c,n):As(r,!0).test(f)}const ir=B.Pe.define({map(r,n){return r.map(l=>l.map(n))}}),Xn=B.Pe.define(),zi=B.sU.define({create(){return Qt.start()},update(r,n){return r.update(n)},provide:r=>[X.DK.from(r,n=>n.tooltip),X.Lz.contentAttributes.from(r,n=>n.attrs)]});function pr(r,n){const l=n.completion.apply||n.completion.label;let c=r.state.field(zi).active.find(f=>f.source==n.source);return c instanceof Ms?(typeof l=="string"?r.dispatch(Object.assign(Object.assign({},On(r.state,l,c.from,c.to)),{annotations:In.of(n.completion)})):l(r,n.completion,c.from,c.to),!0):!1}const ls=tr(zi,pr);function qe(r,n="option"){return l=>{let c=l.state.field(zi,!1);if(!c||!c.open||c.open.disabled||Date.now()-c.open.timestamp<l.state.facet(bi).interactionDelay)return!1;let f=1,p;n=="page"&&(p=(0,X.Eg)(l,c.open.tooltip))&&(f=Math.max(2,Math.floor(p.dom.offsetHeight/p.dom.querySelector("li").offsetHeight)-1));let{length:k}=c.open.options,E=c.open.selected>-1?c.open.selected+f*(r?1:-1):r?0:k-1;return E<0?E=n=="page"?0:k-1:E>=k&&(E=n=="page"?k-1:0),l.dispatch({effects:Xn.of(E)}),!0}}const Ee=r=>{let n=r.state.field(zi,!1);return r.state.readOnly||!n||!n.open||n.open.selected<0||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(bi).interactionDelay?!1:pr(r,n.open.options[n.open.selected])},Ce=r=>r.state.field(zi,!1)?(r.dispatch({effects:Fn.of(!0)}),!0):!1,je=r=>{let n=r.state.field(zi,!1);return!n||!n.active.some(l=>l.state!=0)?!1:(r.dispatch({effects:ns.of(null)}),!0)};class At{constructor(n,l){this.active=n,this.context=l,this.time=Date.now(),this.updates=[],this.done=void 0}}const Ct=50,xi=1e3,Mi=X.Z9.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let n of r.state.field(zi).active)n.state==1&&this.startQuery(n)}update(r){let n=r.state.field(zi);if(!r.selectionSet&&!r.docChanged&&r.startState.field(zi)==n)return;let l=r.transactions.some(f=>(f.selection||f.docChanged)&&!Hs(f));for(let f=0;f<this.running.length;f++){let p=this.running[f];if(l||p.updates.length+r.transactions.length>Ct&&Date.now()-p.time>xi){for(let k of p.context.abortListeners)try{k()}catch(E){(0,X.c_)(this.view.state,E)}p.context.abortListeners=null,this.running.splice(f--,1)}else p.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(f=>f.effects.some(p=>p.is(Fn)))&&(this.pendingStart=!0);let c=this.pendingStart?50:r.state.facet(bi).activateOnTypingDelay;if(this.debounceUpdate=n.active.some(f=>f.state==1&&!this.running.some(p=>p.active.source==f.source))?setTimeout(()=>this.startUpdate(),c):-1,this.composing!=0)for(let f of r.transactions)Hs(f)=="input"?this.composing=2:this.composing==2&&f.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,n=r.field(zi);for(let l of n.active)l.state==1&&!this.running.some(c=>c.active.source==l.source)&&this.startQuery(l)}startQuery(r){let{state:n}=this.view,l=sn(n),c=new ws(n,l,r.explicitPos==l),f=new At(r,c);this.running.push(f),Promise.resolve(r.source(c)).then(p=>{f.context.aborted||(f.done=p||null,this.scheduleAccept())},p=>{this.view.dispatch({effects:ns.of(null)}),(0,X.c_)(this.view.state,p)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(bi).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let n=[],l=this.view.state.facet(bi);for(let c=0;c<this.running.length;c++){let f=this.running[c];if(f.done===void 0)continue;if(this.running.splice(c--,1),f.done){let k=new Ms(f.active.source,f.active.explicitPos,f.done,f.done.from,(r=f.done.to)!==null&&r!==void 0?r:sn(f.updates.length?f.updates[0].startState:this.view.state));for(let E of f.updates)k=k.update(E,l);if(k.hasResult()){n.push(k);continue}}let p=this.view.state.field(zi).active.find(k=>k.source==f.active.source);if(p&&p.state==1)if(f.done==null){let k=new ki(f.active.source,0);for(let E of f.updates)k=k.update(E,l);k.state!=1&&n.push(k)}else this.startQuery(p)}n.length&&this.view.dispatch({effects:ir.of(n)})}},{eventHandlers:{blur(r){let n=this.view.state.field(zi,!1);if(n&&n.tooltip&&this.view.state.facet(bi).closeOnBlur){let l=n.open&&(0,X.Eg)(this.view,n.open.tooltip);(!l||!l.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:ns.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Fn.of(!1)}),20),this.composing=0}}}),fn=X.Lz.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class mr{constructor(n,l,c,f){this.field=n,this.line=l,this.from=c,this.to=f}}class Ws{constructor(n,l,c){this.field=n,this.from=l,this.to=c}map(n){let l=n.mapPos(this.from,-1,MapMode.TrackDel),c=n.mapPos(this.to,1,MapMode.TrackDel);return l==null||c==null?null:new Ws(this.field,l,c)}}class gr{constructor(n,l){this.lines=n,this.fieldPositions=l}instantiate(n,l){let c=[],f=[l],p=n.doc.lineAt(l),k=/^\s*/.exec(p.text)[0];for(let L of this.lines){if(c.length){let Y=k,Z=/^\t*/.exec(L)[0].length;for(let ye=0;ye<Z;ye++)Y+=n.facet(indentUnit);f.push(l+Y.length-Z),L=Y+L.slice(Z)}c.push(L),l+=L.length+1}let E=this.fieldPositions.map(L=>new Ws(L.field,f[L.line]+L.from,f[L.line]+L.to));return{text:c,ranges:E}}static parse(n){let l=[],c=[],f=[],p;for(let k of n.split(/\r\n?|\n/)){for(;p=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(k);){let E=p[1]?+p[1]:null,L=p[2]||p[3]||"",Y=-1;for(let Z=0;Z<l.length;Z++)(E!=null?l[Z].seq==E:L&&l[Z].name==L)&&(Y=Z);if(Y<0){let Z=0;for(;Z<l.length&&(E==null||l[Z].seq!=null&&l[Z].seq<E);)Z++;l.splice(Z,0,{seq:E,name:L}),Y=Z;for(let ye of f)ye.field>=Y&&ye.field++}f.push(new mr(Y,c.length,p.index,p.index+L.length)),k=k.slice(0,p.index)+L+k.slice(p.index+p[0].length)}for(let E;E=/\\([{}])/.exec(k);){k=k.slice(0,E.index)+E[1]+k.slice(E.index+E[0].length);for(let L of f)L.line==c.length&&L.from>E.index&&(L.from--,L.to--)}c.push(k)}return new gr(c,f)}}let ao=X.NZ.widget({widget:new class extends X.xO{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),Ko=X.NZ.mark({class:"cm-snippetField"});class zs{constructor(n,l){this.ranges=n,this.active=l,this.deco=X.NZ.set(n.map(c=>(c.from==c.to?ao:Ko).range(c.from,c.to)))}map(n){let l=[];for(let c of this.ranges){let f=c.map(n);if(!f)return null;l.push(f)}return new zs(l,this.active)}selectionInsideField(n){return n.ranges.every(l=>this.ranges.some(c=>c.field==this.active&&c.from<=l.from&&c.to>=l.to))}}const as=B.Pe.define({map(r,n){return r&&r.map(n)}}),Uo=B.Pe.define(),Vs=B.sU.define({create(){return null},update(r,n){for(let l of n.effects){if(l.is(as))return l.value;if(l.is(Uo)&&r)return new zs(r.ranges,l.value)}return r&&n.docChanged&&(r=r.map(n.changes)),r&&n.selection&&!r.selectionInsideField(n.selection)&&(r=null),r},provide:r=>X.Lz.decorations.from(r,n=>n?n.deco:X.NZ.none)});function Vr(r,n){return B.OF.create(r.filter(l=>l.field==n).map(l=>B.OF.range(l.from,l.to)))}function Go(r){let n=gr.parse(r);return(l,c,f,p)=>{let{text:k,ranges:E}=n.instantiate(l.state,f),L={changes:{from:f,to:p,insert:Text.of(k)},scrollIntoView:!0,annotations:c?[In.of(c),Transaction.userEvent.of("input.complete")]:void 0};if(E.length&&(L.selection=Vr(E,0)),E.some(Y=>Y.field>0)){let Y=new zs(E,0),Z=L.effects=[as.of(Y)];l.state.field(Vs,!1)===void 0&&Z.push(StateEffect.appendConfig.of([Vs,To,Xo,fn]))}l.dispatch(l.state.update(L))}}function jr(r){return({state:n,dispatch:l})=>{let c=n.field(Vs,!1);if(!c||r<0&&c.active==0)return!1;let f=c.active+r,p=r>0&&!c.ranges.some(k=>k.field==f+r);return l(n.update({selection:Vr(c.ranges,f),effects:as.of(p?null:new zs(c.ranges,f)),scrollIntoView:!0})),!0}}const ho=({state:r,dispatch:n})=>r.field(Vs,!1)?(n(r.update({effects:as.of(null)})),!0):!1,Yo=jr(1),Jo=jr(-1);function Mo(r){let n=r.field(Vs,!1);return!!(n&&n.ranges.some(l=>l.field==n.active+1))}function xl(r){let n=r.field(Vs,!1);return!!(n&&n.active>0)}const $r=[{key:"Tab",run:Yo,shift:Jo},{key:"Escape",run:ho}],Eo=B.sj.define({combine(r){return r.length?r[0]:$r}}),To=B.Nb.highest(X.w4.compute([Eo],r=>r.facet(Eo)));function wl(r,n){return Object.assign(Object.assign({},n),{apply:Go(r)})}const Xo=X.Lz.domEventHandlers({mousedown(r,n){let l=n.state.field(Vs,!1),c;if(!l||(c=n.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let f=l.ranges.find(p=>p.from<=c&&p.to>=c);return!f||f.field==l.active?!1:(n.dispatch({selection:Vr(l.ranges,f.field),effects:as.of(l.ranges.some(p=>p.field>f.field)?new zs(l.ranges,f.field):null),scrollIntoView:!0}),!0)}});function Zo(r){let n=r.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${n}]+`,"ug")}catch{return new RegExp(`[w${n}]`,"g")}}function Oo(r,n){return new RegExp(n(r.source),r.unicode?"u":"")}const Do=null;function Po(r){return Do[r]||(Do[r]=new WeakMap)}function qo(r,n,l,c,f){for(let p=r.iterLines(),k=0;!p.next().done;){let{value:E}=p,L;for(n.lastIndex=0;L=n.exec(E);)if(!c[L[0]]&&k+L.index!=f&&(l.push({type:"text",label:L[0]}),c[L[0]]=!0,l.length>=2e3))return;k+=E.length+1}}function Ro(r,n,l,c,f){let p=r.length>=1e3,k=p&&n.get(r);if(k)return k;let E=[],L=Object.create(null);if(r.children){let Y=0;for(let Z of r.children){if(Z.length>=1e3)for(let ye of Ro(Z,n,l,c-Y,f-Y))L[ye.label]||(L[ye.label]=!0,E.push(ye));else qo(Z,l,E,L,f-Y);Y+=Z.length+1}}else qo(r,l,E,L,f);return p&&E.length<2e3&&n.set(r,E),E}const Sl=r=>{let n=r.state.languageDataAt("wordChars",r.pos).join(""),l=Zo(n),c=r.matchBefore(Oo(l,k=>k+"$"));if(!c&&!r.explicit)return null;let f=c?c.from:r.pos,p=Ro(r.state.doc,Po(n),l,5e4,f);return{from:f,options:p,validFor:Oo(l,k=>"^"+k)}},yr={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},js=B.Pe.define({map(r,n){let l=n.mapPos(r,-1,B.iR.TrackAfter);return l==null?void 0:l}}),co=new class extends B.FB{};co.startSide=1,co.endSide=-1;const Kr=B.sU.define({create(){return B.om.empty},update(r,n){if(r=r.map(n.changes),n.selection){let l=n.state.doc.lineAt(n.selection.main.head);r=r.update({filter:c=>c>=l.from&&c<=l.to})}for(let l of n.effects)l.is(js)&&(r=r.update({add:[co.range(l.value,l.value+1)]}));return r}});function Qo(){return[el,Kr]}const fo="()[]{}<>";function uo(r){for(let n=0;n<fo.length;n+=2)if(fo.charCodeAt(n)==r)return fo.charAt(n+1);return(0,B.MK)(r<128?r:r+1)}function Lo(r,n){return r.languageDataAt("closeBrackets",n)[0]||yr}const _o=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),el=X.Lz.inputHandler.of((r,n,l,c)=>{if((_o?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let f=r.state.selection.main;if(c.length>2||c.length==2&&(0,B.Fh)((0,B.vS)(c,0))==1||n!=f.from||l!=f.to)return!1;let p=vr(r.state,c);return p?(r.dispatch(p),!0):!1}),tl=[{key:"Backspace",run:({state:r,dispatch:n})=>{if(r.readOnly)return!1;let c=Lo(r,r.selection.main.head).brackets||yr.brackets,f=null,p=r.changeByRange(k=>{if(k.empty){let E=il(r.doc,k.head);for(let L of c)if(L==E&&mo(r.doc,k.head)==uo((0,B.vS)(L,0)))return{changes:{from:k.head-L.length,to:k.head+L.length},range:B.OF.cursor(k.head-L.length)}}return{range:f=k}});return f||n(r.update(p,{scrollIntoView:!0,userEvent:"delete.backward"})),!f}}];function vr(r,n){let l=Lo(r,r.selection.main.head),c=l.brackets||yr.brackets;for(let f of c){let p=uo((0,B.vS)(f,0));if(n==f)return p==f?Gr(r,f,c.indexOf(f+f+f)>-1,l):Ur(r,f,p,l.before||yr.before);if(n==p&&po(r,r.selection.main.from))return Bo(r,f,p)}return null}function po(r,n){let l=!1;return r.field(Kr).between(0,r.doc.length,c=>{c==n&&(l=!0)}),l}function mo(r,n){let l=r.sliceString(n,n+2);return l.slice(0,(0,B.Fh)((0,B.vS)(l,0)))}function il(r,n){let l=r.sliceString(n-2,n);return(0,B.Fh)((0,B.vS)(l,0))==l.length?l:l.slice(1)}function Ur(r,n,l,c){let f=null,p=r.changeByRange(k=>{if(!k.empty)return{changes:[{insert:n,from:k.from},{insert:l,from:k.to}],effects:js.of(k.to+n.length),range:B.OF.range(k.anchor+n.length,k.head+n.length)};let E=mo(r.doc,k.head);return!E||/\s/.test(E)||c.indexOf(E)>-1?{changes:{insert:n+l,from:k.head},effects:js.of(k.head+n.length),range:B.OF.cursor(k.head+n.length)}:{range:f=k}});return f?null:r.update(p,{scrollIntoView:!0,userEvent:"input.type"})}function Bo(r,n,l){let c=null,f=r.changeByRange(p=>p.empty&&mo(r.doc,p.head)==l?{changes:{from:p.head,to:p.head+l.length,insert:l},range:B.OF.cursor(p.head+l.length)}:c={range:p});return c?null:r.update(f,{scrollIntoView:!0,userEvent:"input.type"})}function Gr(r,n,l,c){let f=c.stringPrefixes||yr.stringPrefixes,p=null,k=r.changeByRange(E=>{if(!E.empty)return{changes:[{insert:n,from:E.from},{insert:n,from:E.to}],effects:js.of(E.to+n.length),range:B.OF.range(E.anchor+n.length,E.head+n.length)};let L=E.head,Y=mo(r.doc,L),Z;if(Y==n){if(No(r,L))return{changes:{insert:n+n,from:L},effects:js.of(L+n.length),range:B.OF.cursor(L+n.length)};if(po(r,L)){let Ie=l&&r.sliceDoc(L,L+n.length*3)==n+n+n?n+n+n:n;return{changes:{from:L,to:L+Ie.length,insert:Ie},range:B.OF.cursor(L+Ie.length)}}}else{if(l&&r.sliceDoc(L-2*n.length,L)==n+n&&(Z=Yr(r,L-2*n.length,f))>-1&&No(r,Z))return{changes:{insert:n+n+n+n,from:L},effects:js.of(L+n.length),range:B.OF.cursor(L+n.length)};if(r.charCategorizer(L)(Y)!=B.Je.Word&&Yr(r,L,f)>-1&&!nl(r,L,n,f))return{changes:{insert:n+n,from:L},effects:js.of(L+n.length),range:B.OF.cursor(L+n.length)}}return{range:p=E}});return p?null:r.update(k,{scrollIntoView:!0,userEvent:"input.type"})}function No(r,n){let l=(0,Ae.mv)(r).resolveInner(n+1);return l.parent&&l.from==n}function nl(r,n,l,c){let f=(0,Ae.mv)(r).resolveInner(n,-1),p=c.reduce((k,E)=>Math.max(k,E.length),0);for(let k=0;k<5;k++){let E=r.sliceDoc(f.from,Math.min(f.to,f.from+l.length+p)),L=E.indexOf(l);if(!L||L>-1&&c.indexOf(E.slice(0,L))>-1){let Z=f.firstChild;for(;Z&&Z.from==f.from&&Z.to-Z.from>l.length+L;){if(r.sliceDoc(Z.to-l.length,Z.to)==l)return!1;Z=Z.firstChild}return!0}let Y=f.to==n&&f.parent;if(!Y)break;f=Y}return!1}function Yr(r,n,l){let c=r.charCategorizer(n);if(c(r.sliceDoc(n-1,n))!=B.Je.Word)return n;for(let f of l){let p=n-f.length;if(r.sliceDoc(p,n)==f&&c(r.sliceDoc(p-1,p))!=B.Je.Word)return p}return-1}function br(r={}){return[zi,bi.of(r),Mi,sl,fn]}const xr=[{key:"Ctrl-Space",run:Ce},{key:"Escape",run:je},{key:"ArrowDown",run:qe(!0)},{key:"ArrowUp",run:qe(!1)},{key:"PageDown",run:qe(!0,"page")},{key:"PageUp",run:qe(!1,"page")},{key:"Enter",run:Ee}],sl=B.Nb.highest(X.w4.computeN([bi],r=>r.facet(bi).defaultKeymap?[xr]:[]));function Al(r){let n=r.field(zi,!1);return n&&n.active.some(l=>l.state==1)?"pending":n&&n.active.some(l=>l.state!=0)?"active":null}const wr=new WeakMap;function Cl(r){var n;let l=(n=r.field(zi,!1))===null||n===void 0?void 0:n.open;if(!l||l.disabled)return[];let c=wr.get(l.options);return c||wr.set(l.options,c=l.options.map(f=>f.completion)),c}function Ml(r){var n;let l=(n=r.field(zi,!1))===null||n===void 0?void 0:n.open;return l&&!l.disabled&&l.selected>=0?l.options[l.selected].completion:null}function El(r){var n;let l=(n=r.field(zi,!1))===null||n===void 0?void 0:n.open;return l&&!l.disabled&&l.selected>=0?l.selected:null}function Tl(r){return Xn.of(r)}class Ol{constructor(n,l,c){this.from=n,this.to=l,this.diagnostic=c}}class $s{constructor(n,l,c){this.diagnostics=n,this.panel=l,this.selected=c}static init(n,l,c){let f=n,p=c.facet(Cr).markerFilter;p&&(f=p(f,c));let k=X.NZ.set(f.map(E=>E.from==E.to||E.from==E.to-1&&c.doc.lineAt(E.from).to==E.from?X.NZ.widget({widget:new hl(E),diagnostic:E}).range(E.from):X.NZ.mark({attributes:{class:"cm-lintRange cm-lintRange-"+E.severity+(E.markClass?" "+E.markClass:"")},diagnostic:E,inclusive:!0}).range(E.from,E.to)),!0);return new $s(k,l,Sr(k))}}function Sr(r,n=null,l=0){let c=null;return r.between(l,1e9,(f,p,{spec:k})=>{if(!(n&&k.diagnostic!=n))return c=new Ol(f,p,k.diagnostic),!1}),c}function rl(r,n){let l=r.startState.doc.lineAt(n.pos);return!!(r.effects.some(c=>c.is(Xr))||r.changes.touchesRange(l.from,l.to))}function Jr(r,n){return r.field(Qi,!1)?n:n.concat(B.Pe.appendConfig.of(yl))}function Pl(r,n){return{effects:Jr(r,[Xr.of(n)])}}const Xr=B.Pe.define(),Zr=B.Pe.define(),kr=B.Pe.define(),Qi=B.sU.define({create(){return new $s(X.NZ.none,null,null)},update(r,n){if(n.docChanged){let l=r.diagnostics.map(n.changes),c=null;if(r.selected){let f=n.changes.mapPos(r.selected.from,1);c=Sr(l,r.selected.diagnostic,f)||Sr(l,null,f)}r=new $s(l,r.panel,c)}for(let l of n.effects)l.is(Xr)?r=$s.init(l.value,r.panel,n.state):l.is(Zr)?r=new $s(r.diagnostics,l.value?nr.open:null,r.selected):l.is(kr)&&(r=new $s(r.diagnostics,r.panel,l.value));return r},provide:r=>[X.S7.from(r,n=>n.panel),X.Lz.decorations.from(r,n=>n.diagnostics)]});function Io(r){let n=r.field(Qi,!1);return n?n.diagnostics.size:0}const hs=X.NZ.mark({class:"cm-lintRange cm-lintRange-active",inclusive:!0});function qr(r,n,l){let{diagnostics:c}=r.state.field(Qi),f=[],p=2e8,k=0;c.between(n-(l<0?1:0),n+(l>0?1:0),(L,Y,{spec:Z})=>{n>=L&&n<=Y&&(L==Y||(n>L||l>0)&&(n<Y||l<0))&&(f.push(Z.diagnostic),p=Math.min(L,p),k=Math.max(Y,k))});let E=r.state.facet(Cr).tooltipFilter;return E&&(f=E(f,r.state)),f.length?{pos:p,end:k,above:r.state.doc.lineAt(p).to<k,create(){return{dom:Fo(r,f)}}}:null}function Fo(r,n){return ri("ul",{class:"cm-tooltip-lint"},n.map(l=>Wo(r,l,!1)))}const Ar=r=>{let n=r.state.field(Qi,!1);(!n||!n.panel)&&r.dispatch({effects:Jr(r.state,[Zr.of(!0)])});let l=(0,X.ld)(r,nr.open);return l&&l.dom.querySelector(".cm-panel-lint ul").focus(),!0},Ho=r=>{let n=r.state.field(Qi,!1);return!n||!n.panel?!1:(r.dispatch({effects:Zr.of(!1)}),!0)},go=r=>{let n=r.state.field(Qi,!1);if(!n)return!1;let l=r.state.selection.main,c=n.diagnostics.iter(l.to+1);return!c.value&&(c=n.diagnostics.iter(0),!c.value||c.from==l.from&&c.to==l.to)?!1:(r.dispatch({selection:{anchor:c.from,head:c.to},scrollIntoView:!0}),!0)},ol=r=>{let{state:n}=r,l=n.field(Qi,!1);if(!l)return!1;let c=n.selection.main,f,p,k,E;return l.diagnostics.between(0,n.doc.length,(L,Y)=>{Y<c.to&&(f==null||f<L)&&(f=L,p=Y),(k==null||L>k)&&(k=L,E=Y)}),k==null||f==null&&k==c.from?!1:(r.dispatch({selection:{anchor:f!=null?f:k,head:p!=null?p:E},scrollIntoView:!0}),!0)},ll=[{key:"Mod-Shift-m",run:Ar,preventDefault:!0},{key:"F8",run:go}],yo=null,Cr=B.sj.define({combine(r){return Object.assign({sources:r.map(n=>n.source).filter(n=>n!=null)},(0,B.QR)(r.map(n=>n.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(n,l)=>n?l?c=>n(c)||l(c):n:l}))}});function Dl(r,n={}){return[Cr.of({source:r,config:n}),yo,yl]}function al(r){let n=r.plugin(yo);n&&n.force()}function vo(r){let n=[];if(r)e:for(let{name:l}of r){for(let c=0;c<l.length;c++){let f=l[c];if(/[a-zA-Z]/.test(f)&&!n.some(p=>p.toLowerCase()==f.toLowerCase())){n.push(f);continue e}}n.push("")}return n}function Wo(r,n,l){var c;let f=l?vo(n.actions):[];return ri("li",{class:"cm-diagnostic cm-diagnostic-"+n.severity},ri("span",{class:"cm-diagnosticText"},n.renderMessage?n.renderMessage():n.message),(c=n.actions)===null||c===void 0?void 0:c.map((p,k)=>{let E=!1,L=Ie=>{if(Ie.preventDefault(),E)return;E=!0;let at=Sr(r.state.field(Qi).diagnostics,n);at&&p.apply(r,at.from,at.to)},{name:Y}=p,Z=f[k]?Y.indexOf(f[k]):-1,ye=Z<0?Y:[Y.slice(0,Z),ri("u",Y.slice(Z,Z+1)),Y.slice(Z+1)];return ri("button",{type:"button",class:"cm-diagnosticAction",onclick:L,onmousedown:L,"aria-label":` Action: ${Y}${Z<0?"":` (access key "${f[k]})"`}.`},ye)}),n.source&&ri("div",{class:"cm-diagnosticSource"},n.source))}class hl extends X.xO{constructor(n){super(),this.diagnostic=n}eq(n){return n.diagnostic==this.diagnostic}toDOM(){return ri("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Ks{constructor(n,l){this.diagnostic=l,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Wo(n,l,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class nr{constructor(n){this.view=n,this.items=[];let l=f=>{if(f.keyCode==27)Ho(this.view),this.view.focus();else if(f.keyCode==38||f.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(f.keyCode==40||f.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(f.keyCode==36)this.moveSelection(0);else if(f.keyCode==35)this.moveSelection(this.items.length-1);else if(f.keyCode==13)this.view.focus();else if(f.keyCode>=65&&f.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:p}=this.items[this.selectedIndex],k=vo(p.actions);for(let E=0;E<k.length;E++)if(k[E].toUpperCase().charCodeAt(0)==f.keyCode){let L=Sr(this.view.state.field(Qi).diagnostics,p);L&&p.actions[E].apply(n,L.from,L.to)}}else return;f.preventDefault()},c=f=>{for(let p=0;p<this.items.length;p++)this.items[p].dom.contains(f.target)&&this.moveSelection(p)};this.list=ri("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:l,onclick:c}),this.dom=ri("div",{class:"cm-panel-lint"},this.list,ri("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Ho(this.view)},"\xD7")),this.update()}get selectedIndex(){let n=this.view.state.field(Qi).selected;if(!n)return-1;for(let l=0;l<this.items.length;l++)if(this.items[l].diagnostic==n.diagnostic)return l;return-1}update(){let{diagnostics:n,selected:l}=this.view.state.field(Qi),c=0,f=!1,p=null;for(n.between(0,this.view.state.doc.length,(k,E,{spec:L})=>{let Y=-1,Z;for(let ye=c;ye<this.items.length;ye++)if(this.items[ye].diagnostic==L.diagnostic){Y=ye;break}Y<0?(Z=new Ks(this.view,L.diagnostic),this.items.splice(c,0,Z),f=!0):(Z=this.items[Y],Y>c&&(this.items.splice(c,Y-c),f=!0)),l&&Z.diagnostic==l.diagnostic?Z.dom.hasAttribute("aria-selected")||(Z.dom.setAttribute("aria-selected","true"),p=Z):Z.dom.hasAttribute("aria-selected")&&Z.dom.removeAttribute("aria-selected"),c++});c<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)f=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ks(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),f=!0),p?(this.list.setAttribute("aria-activedescendant",p.id),this.view.requestMeasure({key:this,read:()=>({sel:p.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:k,panel:E})=>{let L=E.height/this.list.offsetHeight;k.top<E.top?this.list.scrollTop-=(E.top-k.top)/L:k.bottom>E.bottom&&(this.list.scrollTop+=(k.bottom-E.bottom)/L)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),f&&this.sync()}sync(){let n=this.list.firstChild;function l(){let c=n;n=c.nextSibling,c.remove()}for(let c of this.items)if(c.dom.parentNode==this.list){for(;n!=c.dom;)l();n=c.dom.nextSibling}else this.list.insertBefore(c.dom,n);for(;n;)l()}moveSelection(n){if(this.selectedIndex<0)return;let l=this.view.state.field(Qi),c=Sr(l.diagnostics,this.items[n].diagnostic);c&&this.view.dispatch({selection:{anchor:c.from,head:c.to},scrollIntoView:!0,effects:kr.of(c)})}static open(n){return new nr(n)}}function sr(r,n='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${n}>${encodeURIComponent(r)}</svg>')`}function Qr(r){return sr(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const cl=X.Lz.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Qr("#d11")},".cm-lintRange-warning":{backgroundImage:Qr("orange")},".cm-lintRange-info":{backgroundImage:Qr("#999")},".cm-lintRange-hint":{backgroundImage:Qr("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function bo(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}class fl extends X.wJ{constructor(n){super(),this.diagnostics=n,this.severity=n.reduce((l,c)=>bo(l)<bo(c.severity)?c.severity:l,"hint")}toDOM(n){let l=document.createElement("div");l.className="cm-lint-marker cm-lint-marker-"+this.severity;let c=this.diagnostics,f=n.state.facet(So).tooltipFilter;return f&&(c=f(c,n.state)),c.length&&(l.onmouseover=()=>dl(n,l,c)),l}}function ul(r,n){let l=c=>{let f=n.getBoundingClientRect();if(!(c.clientX>f.left-10&&c.clientX<f.right+10&&c.clientY>f.top-10&&c.clientY<f.bottom+10)){for(let p=c.target;p;p=p.parentNode)if(p.nodeType==1&&p.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",l),r.state.field(ml)&&r.dispatch({effects:wo.of(null)})}};window.addEventListener("mousemove",l)}function dl(r,n,l){function c(){let k=r.elementAtHeight(n.getBoundingClientRect().top+5-r.documentTop);r.coordsAtPos(k.from)&&r.dispatch({effects:wo.of({pos:k.from,above:!1,create(){return{dom:Fo(r,l),getCoords:()=>n.getBoundingClientRect()}}})}),n.onmouseout=n.onmousemove=null,ul(r,n)}let{hoverTime:f}=r.state.facet(So),p=setTimeout(c,f);n.onmouseout=()=>{clearTimeout(p),n.onmouseout=n.onmousemove=null},n.onmousemove=()=>{clearTimeout(p),p=setTimeout(c,f)}}function zo(r,n){let l=Object.create(null);for(let f of n){let p=r.lineAt(f.from);(l[p.from]||(l[p.from]=[])).push(f)}let c=[];for(let f in l)c.push(new fl(l[f]).range(+f));return B.om.of(c,!0)}const pl=(0,X.cU)({class:"cm-gutter-lint",markers:r=>r.state.field(xo)}),xo=B.sU.define({create(){return B.om.empty},update(r,n){r=r.map(n.changes);let l=n.state.facet(So).markerFilter;for(let c of n.effects)if(c.is(Xr)){let f=c.value;l&&(f=l(f||[],n.state)),r=zo(n.state.doc,f.slice(0))}return r}}),wo=B.Pe.define(),ml=B.sU.define({create(){return null},update(r,n){return r&&n.docChanged&&(r=rl(n,r)?null:Object.assign(Object.assign({},r),{pos:n.changes.mapPos(r.pos)})),n.effects.reduce((l,c)=>c.is(wo)?c.value:l,r)},provide:r=>X.DK.from(r)}),gl=X.Lz.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:sr('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:sr('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:sr('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),yl=[Qi,X.Lz.decorations.compute([Qi],r=>{let{selected:n,panel:l}=r.field(Qi);return!n||!l||n.from==n.to?X.NZ.none:X.NZ.set([hs.range(n.from,n.to)])}),(0,X.Ux)(qr,{hideOn:rl}),cl],So=B.sj.define({combine(r){return(0,B.QR)(r,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function o(r={}){return[So.of(r),xo,pl,gl,ml]}function e(r,n){let l=r.field(Qi,!1);if(l&&l.diagnostics.size)for(let c=RangeSet.iter([l.diagnostics]);c.value;c.next())n(c.value.spec.diagnostic,c.from,c.to)}var t=function(n){n===void 0&&(n={});var{crosshairCursor:l=!1}=n,c=[];n.closeBracketsKeymap!==!1&&(c=c.concat(tl)),n.defaultKeymap!==!1&&(c=c.concat(no)),n.searchKeymap!==!1&&(c=c.concat(Qs)),n.historyKeymap!==!1&&(c=c.concat(S)),n.foldKeymap!==!1&&(c=c.concat(Ae.f7)),n.completionKeymap!==!1&&(c=c.concat(xr)),n.lintKeymap!==!1&&(c=c.concat(ll));var f=[];return n.lineNumbers!==!1&&f.push((0,X.$K)()),n.highlightActiveLineGutter!==!1&&f.push((0,X.Wu)()),n.highlightSpecialChars!==!1&&f.push((0,X.N$)()),n.history!==!1&&f.push(St()),n.foldGutter!==!1&&f.push((0,Ae.Lv)()),n.drawSelection!==!1&&f.push((0,X.VH)()),n.dropCursor!==!1&&f.push((0,X.A)()),n.allowMultipleSelections!==!1&&f.push(B.$t.allowMultipleSelections.of(!0)),n.indentOnInput!==!1&&f.push((0,Ae.WD)()),n.syntaxHighlighting!==!1&&f.push((0,Ae.y9)(Ae.Zt,{fallback:!0})),n.bracketMatching!==!1&&f.push((0,Ae.SG)()),n.closeBrackets!==!1&&f.push(Qo()),n.autocompletion!==!1&&f.push(br()),n.rectangularSelection!==!1&&f.push((0,X.D4)()),l!==!1&&f.push((0,X.HJ)()),n.highlightActiveLine!==!1&&f.push((0,X.dz)()),n.highlightSelectionMatches!==!1&&f.push(Nr()),n.tabSize&&typeof n.tabSize=="number"&&f.push(Ae.Xt.of(" ".repeat(n.tabSize))),f.concat([X.w4.of(c.flat())]).filter(Boolean)},i=function(n){n===void 0&&(n={});var l=[];n.defaultKeymap!==!1&&(l=l.concat(defaultKeymap)),n.historyKeymap!==!1&&(l=l.concat(historyKeymap));var c=[];return n.highlightSpecialChars!==!1&&c.push(highlightSpecialChars()),n.history!==!1&&c.push(history()),n.drawSelection!==!1&&c.push(drawSelection()),n.syntaxHighlighting!==!1&&c.push(syntaxHighlighting(defaultHighlightStyle,{fallback:!0})),c.concat([keymap.of(l.flat())]).filter(Boolean)},s=q(49913);const h="#e5c07b",d="#e06c75",y="#56b6c2",b="#ffffff",M="#abb2bf",C="#7d8799",H="#61afef",j="#98c379",J="#d19a66",_="#c678dd",ae="#21252b",ne="#2c313a",de="#282c34",$e="#353a42",pt="#3E4451",Ge="#528bff",mt={chalky:h,coral:d,cyan:y,invalid:b,ivory:M,stone:C,malibu:H,sage:j,whiskey:J,violet:_,darkBackground:ae,highlightBackground:ne,background:de,tooltipBackground:$e,selection:pt,cursor:Ge},Ot=X.Lz.theme({"&":{color:M,backgroundColor:de},".cm-content":{caretColor:Ge},".cm-cursor, .cm-dropCursor":{borderLeftColor:Ge},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:pt},".cm-panels":{backgroundColor:ae,color:M},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:de,color:C,border:"none"},".cm-activeLineGutter":{backgroundColor:ne},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:$e},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:$e,borderBottomColor:$e},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:ne,color:M}}},{dark:!0}),Vi=Ae.cr.define([{tag:s._A.keyword,color:_},{tag:[s._A.name,s._A.deleted,s._A.character,s._A.propertyName,s._A.macroName],color:d},{tag:[s._A.function(s._A.variableName),s._A.labelName],color:H},{tag:[s._A.color,s._A.constant(s._A.name),s._A.standard(s._A.name)],color:J},{tag:[s._A.definition(s._A.name),s._A.separator],color:M},{tag:[s._A.typeName,s._A.className,s._A.number,s._A.changed,s._A.annotation,s._A.modifier,s._A.self,s._A.namespace],color:h},{tag:[s._A.operator,s._A.operatorKeyword,s._A.url,s._A.escape,s._A.regexp,s._A.link,s._A.special(s._A.string)],color:y},{tag:[s._A.meta,s._A.comment],color:C},{tag:s._A.strong,fontWeight:"bold"},{tag:s._A.emphasis,fontStyle:"italic"},{tag:s._A.strikethrough,textDecoration:"line-through"},{tag:s._A.link,color:C,textDecoration:"underline"},{tag:s._A.heading,fontWeight:"bold",color:d},{tag:[s._A.atom,s._A.bool,s._A.special(s._A.variableName)],color:J},{tag:[s._A.processingInstruction,s._A.string,s._A.inserted],color:j},{tag:s._A.invalid,color:b}]),_i=[Ot,(0,Ae.y9)(Vi)];var Es=X.Lz.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),_r=function(n){n===void 0&&(n={});var{indentWithTab:l=!0,editable:c=!0,readOnly:f=!1,theme:p="light",placeholder:k="",basicSetup:E=!0}=n,L=[];switch(l&&L.unshift(X.w4.of([ar])),E&&(typeof E=="boolean"?L.unshift(t()):L.unshift(t(E))),k&&L.unshift((0,X.qf)(k)),p){case"light":L.push(Es);break;case"dark":L.push(_i);break;case"none":break;default:L.push(p);break}return c===!1&&L.push(X.Lz.editable.of(!1)),f&&L.push(B.$t.readOnly.of(!0)),[...L]},Vo=r=>({line:r.state.doc.lineAt(r.state.selection.main.from),lineCount:r.state.doc.lines,lineBreak:r.state.lineBreak,length:r.state.doc.length,readOnly:r.state.readOnly,tabSize:r.state.tabSize,selection:r.state.selection,selectionAsSingle:r.state.selection.asSingle().main,ranges:r.state.selection.ranges,selectionCode:r.state.sliceDoc(r.state.selection.main.from,r.state.selection.main.to),selections:r.state.selection.ranges.map(n=>r.state.sliceDoc(n.from,n.to)),selectedText:r.state.selection.ranges.some(n=>!n.empty)}),Mr=B.YH.define(),eo=[];function Us(r){var{value:n,selection:l,onChange:c,onStatistics:f,onCreateEditor:p,onUpdate:k,extensions:E=eo,autoFocus:L,theme:Y="light",height:Z=null,minHeight:ye=null,maxHeight:Ie=null,width:at=null,minWidth:ti=null,maxWidth:Xi=null,placeholder:Zn="",editable:Ds=!0,readOnly:Ei=!1,indentWithTab:cs=!0,basicSetup:Dn=!0,root:rn,initialState:Ps}=r,[Rs,jo]=(0,he.useState)(),[on,Gs]=(0,he.useState)(),[to,io]=(0,he.useState)(),vl=X.Lz.theme({"&":{height:Z,minHeight:ye,maxHeight:Ie,width:at,minWidth:ti,maxWidth:Xi},"& .cm-scroller":{height:"100% !important"}}),bl=X.Lz.updateListener.of(fs=>{if(fs.docChanged&&typeof c=="function"&&!fs.transactions.some(Ll=>Ll.annotation(Mr))){var Ao=fs.state.doc,$o=Ao.toString();c($o,fs)}f&&f(Vo(fs))}),Rl=_r({theme:Y,editable:Ds,readOnly:Ei,placeholder:Zn,indentWithTab:cs,basicSetup:Dn}),ko=[bl,vl,...Rl];return k&&typeof k=="function"&&ko.push(X.Lz.updateListener.of(k)),ko=ko.concat(E),(0,he.useEffect)(()=>{if(Rs&&!to){var fs={doc:n,selection:l,extensions:ko},Ao=Ps?B.$t.fromJSON(Ps.json,fs,Ps.fields):B.$t.create(fs);if(io(Ao),!on){var $o=new X.Lz({state:Ao,parent:Rs,root:rn});Gs($o),p&&p($o,Ao)}}return()=>{on&&(io(void 0),Gs(void 0))}},[Rs,to]),(0,he.useEffect)(()=>jo(r.container),[r.container]),(0,he.useEffect)(()=>()=>{on&&(on.destroy(),Gs(void 0))},[on]),(0,he.useEffect)(()=>{L&&on&&on.focus()},[L,on]),(0,he.useEffect)(()=>{on&&on.dispatch({effects:B.Pe.reconfigure.of(ko)})},[Y,E,Z,ye,Ie,at,ti,Xi,Zn,Ds,Ei,cs,Dn,c,k]),(0,he.useEffect)(()=>{if(n!==void 0){var fs=on?on.state.doc.toString():"";on&&n!==fs&&on.dispatch({changes:{from:0,to:fs.length,insert:n||""},annotations:[Mr.of(!0)]})}},[n,on]),{state:to,setState:io,view:on,setView:Gs,container:Rs,setContainer:jo}}var Ts=q(31085),rr=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Os=(0,he.forwardRef)((r,n)=>{var{className:l,value:c="",selection:f,extensions:p=[],onChange:k,onStatistics:E,onCreateEditor:L,onUpdate:Y,autoFocus:Z,theme:ye="light",height:Ie,minHeight:at,maxHeight:ti,width:Xi,minWidth:Zn,maxWidth:Ds,basicSetup:Ei,placeholder:cs,indentWithTab:Dn,editable:rn,readOnly:Ps,root:Rs,initialState:jo}=r,on=(0,Se.A)(r,rr),Gs=(0,he.useRef)(null),{state:to,view:io,container:vl}=Us({container:Gs.current,root:Rs,value:c,autoFocus:Z,theme:ye,height:Ie,minHeight:at,maxHeight:ti,width:Xi,minWidth:Zn,maxWidth:Ds,basicSetup:Ei,placeholder:cs,indentWithTab:Dn,editable:rn,readOnly:Ps,selection:f,onChange:k,onStatistics:E,onCreateEditor:L,onUpdate:Y,extensions:p,initialState:jo});if((0,he.useImperativeHandle)(n,()=>({editor:Gs.current,state:to,view:io}),[Gs,vl,to,io]),typeof c!="string")throw new Error("value must be typeof string but got "+typeof c);var bl=typeof ye=="string"?"cm-theme-"+ye:"cm-theme";return(0,Ts.jsx)("div",(0,m.A)({ref:Gs,className:""+bl+(l?" "+l:"")},on))});Os.displayName="CodeMirror";const Er=Os},29587:(yn,Wt,q)=>{q.d(Wt,{EI:()=>Ye,KB:()=>ce,Lv:()=>bt,SG:()=>R,Tg:()=>Re,WD:()=>te,Xt:()=>ii,Zt:()=>Ii,_v:()=>Ti,cr:()=>pi,f7:()=>We,jU:()=>x,mv:()=>_e,tp:()=>ni,y9:()=>ji});var m=q(79066),Se=q(14830),he=q(83173),B=q(49913),X=q(98104),Ae;const Fe=new m.uY;function wt(T){return Se.sj.define({combine:T?g=>g.concat(T):void 0})}const ht=new m.uY;class xt{constructor(g,w,P=[],N=""){this.data=g,this.name=N,Se.$t.prototype.hasOwnProperty("tree")||Object.defineProperty(Se.$t.prototype,"tree",{get(){return _e(this)}}),this.parser=w,this.extension=[Lt.of(this),Se.$t.languageData.of((K,G,le)=>{let oe=Ke(K,G,le),pe=oe.type.prop(Fe);if(!pe)return[];let Be=K.facet(pe),dt=oe.type.prop(ht);if(dt){let Ci=oe.resolve(G-oe.from,le);for(let gi of dt)if(gi.test(Ci,K)){let yi=K.facet(gi.facet);return gi.type=="replace"?yi:yi.concat(Be)}}return Be})].concat(P)}isActiveAt(g,w,P=-1){return Ke(g,w,P).type.prop(Fe)==this.data}findRegions(g){let w=g.facet(Lt);if((w==null?void 0:w.data)==this.data)return[{from:0,to:g.doc.length}];if(!w||!w.allowsNesting)return[];let P=[],N=(K,G)=>{if(K.prop(Fe)==this.data){P.push({from:G,to:G+K.length});return}let le=K.prop(m.uY.mounted);if(le){if(le.tree.prop(Fe)==this.data){if(le.overlay)for(let oe of le.overlay)P.push({from:oe.from+G,to:oe.to+G});else P.push({from:G,to:G+K.length});return}else if(le.overlay){let oe=P.length;if(N(le.tree,le.overlay[0].from+G),P.length>oe)return}}for(let oe=0;oe<K.children.length;oe++){let pe=K.children[oe];pe instanceof m.PH&&N(pe,K.positions[oe]+G)}};return N(_e(g),0),P}get allowsNesting(){return!0}}xt.setState=Se.Pe.define();function Ke(T,g,w){let P=T.facet(Lt),N=_e(T).topNode;if(!P||P.allowsNesting)for(let K=N;K;K=K.enter(g,w,m.Qj.ExcludeBuffers))K.type.isTop&&(N=K);return N}class it extends xt{constructor(g,w,P){super(g,w,[],P),this.parser=w}static define(g){let w=wt(g.languageData);return new it(w,g.parser.configure({props:[Fe.add(P=>P.isTop?w:void 0)]}),g.name)}configure(g,w){return new it(this.data,this.parser.configure(g),w||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function _e(T){let g=T.field(xt.state,!1);return g?g.tree:m.PH.empty}function gt(T,g,w=50){var P;let N=(P=T.field(xt.state,!1))===null||P===void 0?void 0:P.context;if(!N)return null;let K=N.viewport;N.updateViewport({from:0,to:g});let G=N.isDone(g)||N.work(w,g)?N.tree:null;return N.updateViewport(K),G}function fi(T,g=T.doc.length){var w;return((w=T.field(xt.state,!1))===null||w===void 0?void 0:w.context.isDone(g))||!1}function Zt(T,g=T.viewport.to,w=100){let P=gt(T.state,g,w);return P!=_e(T.state)&&T.dispatch({}),!!P}function ge(T){var g;return((g=T.plugin(It))===null||g===void 0?void 0:g.isWorking())||!1}class ct{constructor(g){this.doc=g,this.cursorPos=0,this.string="",this.cursor=g.iter()}get length(){return this.doc.length}syncTo(g){return this.string=this.cursor.next(g-this.cursorPos).value,this.cursorPos=g+this.string.length,this.cursorPos-this.string.length}chunk(g){return this.syncTo(g),this.string}get lineChunks(){return!0}read(g,w){let P=this.cursorPos-this.string.length;return g<P||w>=this.cursorPos?this.doc.sliceString(g,w):this.string.slice(g-P,w-P)}}let Yt=null;class wi{constructor(g,w,P=[],N,K,G,le,oe){this.parser=g,this.state=w,this.fragments=P,this.tree=N,this.treeLen=K,this.viewport=G,this.skipped=le,this.scheduleOn=oe,this.parse=null,this.tempSkipped=[]}static create(g,w,P){return new wi(g,w,[],m.PH.empty,0,P,[],null)}startParse(){return this.parser.startParse(new ct(this.state.doc),this.fragments)}work(g,w){return w!=null&&w>=this.state.doc.length&&(w=void 0),this.tree!=m.PH.empty&&this.isDone(w!=null?w:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var P;if(typeof g=="number"){let N=Date.now()+g;g=()=>Date.now()>N}for(this.parse||(this.parse=this.startParse()),w!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>w)&&w<this.state.doc.length&&this.parse.stopAt(w);;){let N=this.parse.advance();if(N)if(this.fragments=this.withoutTempSkipped(m.rr.addTree(N,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(P=this.parse.stoppedAt)!==null&&P!==void 0?P:this.state.doc.length,this.tree=N,this.parse=null,this.treeLen<(w!=null?w:this.state.doc.length))this.parse=this.startParse();else return!0;if(g())return!1}})}takeTree(){let g,w;this.parse&&(g=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>g)&&this.parse.stopAt(g),this.withContext(()=>{for(;!(w=this.parse.advance()););}),this.treeLen=g,this.tree=w,this.fragments=this.withoutTempSkipped(m.rr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(g){let w=Yt;Yt=this;try{return g()}finally{Yt=w}}withoutTempSkipped(g){for(let w;w=this.tempSkipped.pop();)g=ui(g,w.from,w.to);return g}changes(g,w){let{fragments:P,tree:N,treeLen:K,viewport:G,skipped:le}=this;if(this.takeTree(),!g.empty){let oe=[];if(g.iterChangedRanges((pe,Be,dt,Ci)=>oe.push({fromA:pe,toA:Be,fromB:dt,toB:Ci})),P=m.rr.applyChanges(P,oe),N=m.PH.empty,K=0,G={from:g.mapPos(G.from,-1),to:g.mapPos(G.to,1)},this.skipped.length){le=[];for(let pe of this.skipped){let Be=g.mapPos(pe.from,1),dt=g.mapPos(pe.to,-1);Be<dt&&le.push({from:Be,to:dt})}}}return new wi(this.parser,w,P,N,K,G,le,this.scheduleOn)}updateViewport(g){if(this.viewport.from==g.from&&this.viewport.to==g.to)return!1;this.viewport=g;let w=this.skipped.length;for(let P=0;P<this.skipped.length;P++){let{from:N,to:K}=this.skipped[P];N<g.to&&K>g.from&&(this.fragments=ui(this.fragments,N,K),this.skipped.splice(P--,1))}return this.skipped.length>=w?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(g,w){this.skipped.push({from:g,to:w})}static getSkippingParser(g){return new class extends m.iX{createParse(w,P,N){let K=N[0].from,G=N[N.length-1].to;return{parsedPos:K,advance(){let oe=Yt;if(oe){for(let pe of N)oe.tempSkipped.push(pe);g&&(oe.scheduleOn=oe.scheduleOn?Promise.all([oe.scheduleOn,g]):g)}return this.parsedPos=G,new m.PH(m.Z6.none,[],[],G-K)},stoppedAt:null,stopAt(){}}}}}isDone(g){g=Math.min(g,this.state.doc.length);let w=this.fragments;return this.treeLen>=g&&w.length&&w[0].from==0&&w[0].to>=g}static get(){return Yt}}function ui(T,g,w){return m.rr.applyChanges(T,[{fromA:g,toA:w,fromB:g,toB:w}])}class Dt{constructor(g){this.context=g,this.tree=g.tree}apply(g){if(!g.docChanged&&this.tree==this.context.tree)return this;let w=this.context.changes(g.changes,g.state),P=this.context.treeLen==g.startState.doc.length?void 0:Math.max(g.changes.mapPos(this.context.treeLen),w.viewport.to);return w.work(20,P)||w.takeTree(),new Dt(w)}static init(g){let w=Math.min(3e3,g.doc.length),P=wi.create(g.facet(Lt).parser,g,{from:0,to:w});return P.work(20,w)||P.takeTree(),new Dt(P)}}xt.state=Se.sU.define({create:Dt.init,update(T,g){for(let w of g.effects)if(w.is(xt.setState))return w.value;return g.startState.facet(Lt)!=g.state.facet(Lt)?Dt.init(g.state):T.apply(g)}});let di=T=>{let g=setTimeout(()=>T(),500);return()=>clearTimeout(g)};typeof requestIdleCallback!="undefined"&&(di=T=>{let g=-1,w=setTimeout(()=>{g=requestIdleCallback(T,{timeout:500-100})},100);return()=>g<0?clearTimeout(w):cancelIdleCallback(g)});const Li=typeof navigator!="undefined"&&(!((Ae=navigator.scheduling)===null||Ae===void 0)&&Ae.isInputPending)?()=>navigator.scheduling.isInputPending():null,It=he.Z9.fromClass(class{constructor(g){this.view=g,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(g){let w=this.view.state.field(xt.state).context;(w.updateViewport(g.view.viewport)||this.view.viewport.to>w.treeLen)&&this.scheduleWork(),(g.docChanged||g.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(w)}scheduleWork(){if(this.working)return;let{state:g}=this.view,w=g.field(xt.state);(w.tree!=w.context.tree||!w.context.isDone(g.doc.length))&&(this.working=di(this.work))}work(g){this.working=null;let w=Date.now();if(this.chunkEnd<w&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=w+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:P,viewport:{to:N}}=this.view,K=P.field(xt.state);if(K.tree==K.context.tree&&K.context.isDone(N+1e5))return;let G=Date.now()+Math.min(this.chunkBudget,100,g&&!Li?Math.max(25,g.timeRemaining()-5):1e9),le=K.context.treeLen<N&&P.doc.length>N+1e3,oe=K.context.work(()=>Li&&Li()||Date.now()>G,N+(le?0:1e5));this.chunkBudget-=Date.now()-w,(oe||this.chunkBudget<=0)&&(K.context.takeTree(),this.view.dispatch({effects:xt.setState.of(new Dt(K.context))})),this.chunkBudget>0&&!(oe&&!le)&&this.scheduleWork(),this.checkAsyncSchedule(K.context)}checkAsyncSchedule(g){g.scheduleOn&&(this.workScheduled++,g.scheduleOn.then(()=>this.scheduleWork()).catch(w=>(0,he.c_)(this.view.state,w)).then(()=>this.workScheduled--),g.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Lt=Se.sj.define({combine(T){return T.length?T[0]:null},enables:T=>[xt.state,It,he.Lz.contentAttributes.compute([T],g=>{let w=g.facet(T);return w&&w.name?{"data-language":w.name}:{}})]});class Pt{constructor(g,w=[]){this.language=g,this.support=w,this.extension=[g,w]}}class St{constructor(g,w,P,N,K,G=void 0){this.name=g,this.alias=w,this.extensions=P,this.filename=N,this.loadFunc=K,this.support=G,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(g=>this.support=g,g=>{throw this.loading=null,g}))}static of(g){let{load:w,support:P}=g;if(!w){if(!P)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");w=()=>Promise.resolve(P)}return new St(g.name,(g.alias||[]).concat(g.name).map(N=>N.toLowerCase()),g.extensions||[],g.filename,w,P)}static matchFilename(g,w){for(let N of g)if(N.filename&&N.filename.test(w))return N;let P=/\.([^.]+)$/.exec(w);if(P){for(let N of g)if(N.extensions.indexOf(P[1])>-1)return N}return null}static matchLanguageName(g,w,P=!0){w=w.toLowerCase();for(let N of g)if(N.alias.some(K=>K==w))return N;if(P)for(let N of g)for(let K of N.alias){let G=w.indexOf(K);if(G>-1&&(K.length>2||!/\w/.test(w[G-1])&&!/\w/.test(w[G+K.length])))return N}return null}}const ci=Se.sj.define(),ii=Se.sj.define({combine:T=>{if(!T.length)return"  ";let g=T[0];if(!g||/\S/.test(g)||Array.from(g).some(w=>w!=g[0]))throw new Error("Invalid indent unit: "+JSON.stringify(T[0]));return g}});function ni(T){let g=T.facet(ii);return g.charCodeAt(0)==9?T.tabSize*g.length:g.length}function Ye(T,g){let w="",P=T.tabSize,N=T.facet(ii)[0];if(N=="	"){for(;g>=P;)w+="	",g-=P;N=" "}for(let K=0;K<g;K++)w+=N;return w}function Ti(T,g){T instanceof Se.$t&&(T=new ce(T));for(let P of T.state.facet(ci)){let N=P(T,g);if(N!==void 0)return N}let w=_e(T.state);return w.length>=g?ze(T,w,g):null}function Je(T,g,w){let P=Object.create(null),N=new ce(T,{overrideIndentation:G=>{var le;return(le=P[G])!==null&&le!==void 0?le:-1}}),K=[];for(let G=g;G<=w;){let le=T.doc.lineAt(G);G=le.to+1;let oe=Ti(N,le.from);if(oe==null)continue;/\S/.test(le.text)||(oe=0);let pe=/^\s*/.exec(le.text)[0],Be=Ye(T,oe);pe!=Be&&(P[le.from]=oe,K.push({from:le.from,to:le.from+pe.length,insert:Be}))}return T.changes(K)}class ce{constructor(g,w={}){this.state=g,this.options=w,this.unit=ni(g)}lineAt(g,w=1){let P=this.state.doc.lineAt(g),{simulateBreak:N,simulateDoubleBreak:K}=this.options;return N!=null&&N>=P.from&&N<=P.to?K&&N==g?{text:"",from:g}:(w<0?N<g:N<=g)?{text:P.text.slice(N-P.from),from:N}:{text:P.text.slice(0,N-P.from),from:P.from}:P}textAfterPos(g,w=1){if(this.options.simulateDoubleBreak&&g==this.options.simulateBreak)return"";let{text:P,from:N}=this.lineAt(g,w);return P.slice(g-N,Math.min(P.length,g+100-N))}column(g,w=1){let{text:P,from:N}=this.lineAt(g,w),K=this.countColumn(P,g-N),G=this.options.overrideIndentation?this.options.overrideIndentation(N):-1;return G>-1&&(K+=G-this.countColumn(P,P.search(/\S|$/))),K}countColumn(g,w=g.length){return(0,Se.y$)(g,this.state.tabSize,w)}lineIndent(g,w=1){let{text:P,from:N}=this.lineAt(g,w),K=this.options.overrideIndentation;if(K){let G=K(N);if(G>-1)return G}return this.countColumn(P,P.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const xe=new m.uY;function ze(T,g,w){let P=g.resolveStack(w),N=P.node.enterUnfinishedNodesBefore(w);if(N!=P.node){let K=[];for(let G=N;G!=P.node;G=G.parent)K.push(G);for(let G=K.length-1;G>=0;G--)P={node:K[G],next:P}}return Me(P,T,w)}function Me(T,g,w){for(let P=T;P;P=P.next){let N=$t(P.node);if(N)return N(_t.create(g,w,P))}return 0}function Oe(T){return T.pos==T.options.simulateBreak&&T.options.simulateDoubleBreak}function $t(T){let g=T.type.prop(xe);if(g)return g;let w=T.firstChild,P;if(w&&(P=w.type.prop(m.uY.closedBy))){let N=T.lastChild,K=N&&P.indexOf(N.name)>-1;return G=>yt(G,!0,1,void 0,K&&!Oe(G)?N.from:void 0)}return T.parent==null?Ne:null}function Ne(){return 0}class _t extends ce{constructor(g,w,P){super(g.state,g.options),this.base=g,this.pos=w,this.context=P}get node(){return this.context.node}static create(g,w,P){return new _t(g,w,P)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(g){let w=this.state.doc.lineAt(g.from);for(;;){let P=g.resolve(w.from);for(;P.parent&&P.parent.from==P.from;)P=P.parent;if(et(P,g))break;w=this.state.doc.lineAt(P.from)}return this.lineIndent(w.from)}continue(){return Me(this.context.next,this.base,this.pos)}}function et(T,g){for(let w=g;w;w=w.parent)if(T==w)return!0;return!1}function Bi(T){let g=T.node,w=g.childAfter(g.from),P=g.lastChild;if(!w)return null;let N=T.options.simulateBreak,K=T.state.doc.lineAt(w.from),G=N==null||N<=K.from?K.to:Math.min(K.to,N);for(let le=w.to;;){let oe=g.childAfter(le);if(!oe||oe==P)return null;if(!oe.type.isSkipped)return oe.from<G?w:null;le=oe.to}}function zt({closing:T,align:g=!0,units:w=1}){return P=>yt(P,g,w,T)}function yt(T,g,w,P,N){let K=T.textAfter,G=K.match(/^\s*/)[0].length,le=P&&K.slice(G,G+P.length)==P||N==T.pos+G,oe=g?Bi(T):null;return oe?le?T.column(oe.from):T.column(oe.to):T.baseIndent+(le?0:T.unit*w)}const oi=T=>T.baseIndent;function en({except:T,units:g=1}={}){return w=>{let P=T&&T.test(w.textAfter);return w.baseIndent+(P?0:g*w.unit)}}const Gi=200;function te(){return Se.$t.transactionFilter.of(T=>{if(!T.docChanged||!T.isUserEvent("input.type")&&!T.isUserEvent("input.complete"))return T;let g=T.startState.languageDataAt("indentOnInput",T.startState.selection.main.head);if(!g.length)return T;let w=T.newDoc,{head:P}=T.newSelection.main,N=w.lineAt(P);if(P>N.from+Gi)return T;let K=w.sliceString(N.from,P);if(!g.some(pe=>pe.test(K)))return T;let{state:G}=T,le=-1,oe=[];for(let{head:pe}of G.selection.ranges){let Be=G.doc.lineAt(pe);if(Be.from==le)continue;le=Be.from;let dt=Ti(G,Be.from);if(dt==null)continue;let Ci=/^\s*/.exec(Be.text)[0],gi=Ye(G,dt);Ci!=gi&&oe.push({from:Be.from,to:Be.from+Ci.length,insert:gi})}return oe.length?[T,{changes:oe,sequential:!0}]:T})}const S=Se.sj.define(),A=new m.uY;function I(T){let g=T.firstChild,w=T.lastChild;return g&&g.to<w.from?{from:g.to,to:w.type.isError?T.to:w.from}:null}function F(T,g,w){let P=_e(T);if(P.length<w)return null;let N=P.resolveStack(w,1),K=null;for(let G=N;G;G=G.next){let le=G.node;if(le.to<=w||le.from>w)continue;if(K&&le.from<g)break;let oe=le.type.prop(A);if(oe&&(le.to<P.length-50||P.length==T.doc.length||!$(le))){let pe=oe(le,T);pe&&pe.from<=w&&pe.from>=g&&pe.to>w&&(K=pe)}}return K}function $(T){let g=T.lastChild;return g&&g.to==T.to&&g.type.isError}function ee(T,g,w){for(let P of T.facet(S)){let N=P(T,g,w);if(N)return N}return F(T,g,w)}function re(T,g){let w=g.mapPos(T.from,1),P=g.mapPos(T.to,-1);return w>=P?void 0:{from:w,to:P}}const we=Se.Pe.define({map:re}),He=Se.Pe.define({map:re});function Le(T){let g=[];for(let{head:w}of T.state.selection.ranges)g.some(P=>P.from<=w&&P.to>=w)||g.push(T.lineBlockAt(w));return g}const Qe=Se.sU.define({create(){return he.NZ.none},update(T,g){T=T.map(g.changes);for(let w of g.effects)if(w.is(we)&&!si(T,w.value.from,w.value.to)){let{preparePlaceholder:P}=g.state.facet(rt),N=P?he.NZ.replace({widget:new Gt(P(g.state,w.value))}):ot;T=T.update({add:[N.range(w.value.from,w.value.to)]})}else w.is(He)&&(T=T.update({filter:(P,N)=>w.value.from!=P||w.value.to!=N,filterFrom:w.value.from,filterTo:w.value.to}));if(g.selection){let w=!1,{head:P}=g.selection.main;T.between(P,P,(N,K)=>{N<P&&K>P&&(w=!0)}),w&&(T=T.update({filterFrom:P,filterTo:P,filter:(N,K)=>K<=P||N>=P}))}return T},provide:T=>he.Lz.decorations.from(T),toJSON(T,g){let w=[];return T.between(0,g.doc.length,(P,N)=>{w.push(P,N)}),w},fromJSON(T){if(!Array.isArray(T)||T.length%2)throw new RangeError("Invalid JSON for fold state");let g=[];for(let w=0;w<T.length;){let P=T[w++],N=T[w++];if(typeof P!="number"||typeof N!="number")throw new RangeError("Invalid JSON for fold state");g.push(ot.range(P,N))}return he.NZ.set(g,!0)}});function tt(T){return T.field(Qe,!1)||RangeSet.empty}function ft(T,g,w){var P;let N=null;return(P=T.field(Qe,!1))===null||P===void 0||P.between(g,w,(K,G)=>{(!N||N.from>K)&&(N={from:K,to:G})}),N}function si(T,g,w){let P=!1;return T.between(g,g,(N,K)=>{N==g&&K==w&&(P=!0)}),P}function ei(T,g){return T.field(Qe,!1)?g:g.concat(Se.Pe.appendConfig.of(st()))}const Kt=T=>{for(let g of Le(T)){let w=ee(T.state,g.from,g.to);if(w)return T.dispatch({effects:ei(T.state,[we.of(w),Mt(T,w)])}),!0}return!1},Ut=T=>{if(!T.state.field(Qe,!1))return!1;let g=[];for(let w of Le(T)){let P=ft(T.state,w.from,w.to);P&&g.push(He.of(P),Mt(T,P,!1))}return g.length&&T.dispatch({effects:g}),g.length>0};function Mt(T,g,w=!0){let P=T.state.doc.lineAt(g.from).number,N=T.state.doc.lineAt(g.to).number;return he.Lz.announce.of(`${T.state.phrase(w?"Folded lines":"Unfolded lines")} ${P} ${T.state.phrase("to")} ${N}.`)}const Ft=T=>{let{state:g}=T,w=[];for(let P=0;P<g.doc.length;){let N=T.lineBlockAt(P),K=ee(g,N.from,N.to);K&&w.push(we.of(K)),P=(K?T.lineBlockAt(K.to):N).to+1}return w.length&&T.dispatch({effects:ei(T.state,w)}),!!w.length},Si=T=>{let g=T.state.field(Qe,!1);if(!g||!g.size)return!1;let w=[];return g.between(0,T.state.doc.length,(P,N)=>{w.push(He.of({from:P,to:N}))}),T.dispatch({effects:w}),!0};function nt(T,g){for(let w=g;;){let P=ee(T.state,w.from,w.to);if(P&&P.to>g.from)return P;if(!w.from)return null;w=T.lineBlockAt(w.from-1)}}const Xe=T=>{let g=[];for(let w of Le(T)){let P=ft(T.state,w.from,w.to);if(P)g.push(He.of(P),Mt(T,P,!1));else{let N=nt(T,w);N&&g.push(we.of(N),Mt(T,N))}}return g.length>0&&T.dispatch({effects:ei(T.state,g)}),!!g.length},We=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Kt},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Ut},{key:"Ctrl-Alt-[",run:Ft},{key:"Ctrl-Alt-]",run:Si}],Jt={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},rt=Se.sj.define({combine(T){return(0,Se.QR)(T,Jt)}});function st(T){let g=[Qe,qt];return T&&g.push(rt.of(T)),g}function vt(T,g){let{state:w}=T,P=w.facet(rt),N=G=>{let le=T.lineBlockAt(T.posAtDOM(G.target)),oe=ft(T.state,le.from,le.to);oe&&T.dispatch({effects:He.of(oe)}),G.preventDefault()};if(P.placeholderDOM)return P.placeholderDOM(T,N,g);let K=document.createElement("span");return K.textContent=P.placeholderText,K.setAttribute("aria-label",w.phrase("folded code")),K.title=w.phrase("unfold"),K.className="cm-foldPlaceholder",K.onclick=N,K}const ot=he.NZ.replace({widget:new class extends he.xO{toDOM(T){return vt(T,null)}}});class Gt extends he.xO{constructor(g){super(),this.value=g}eq(g){return this.value==g.value}toDOM(g){return vt(g,this.value)}}const Ht={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class ut extends he.wJ{constructor(g,w){super(),this.config=g,this.open=w}eq(g){return this.config==g.config&&this.open==g.open}toDOM(g){if(this.config.markerDOM)return this.config.markerDOM(this.open);let w=document.createElement("span");return w.textContent=this.open?this.config.openText:this.config.closedText,w.title=g.state.phrase(this.open?"Fold line":"Unfold line"),w}}function bt(T={}){let g=Object.assign(Object.assign({},Ht),T),w=new ut(g,!0),P=new ut(g,!1),N=he.Z9.fromClass(class{constructor(G){this.from=G.viewport.from,this.markers=this.buildMarkers(G)}update(G){(G.docChanged||G.viewportChanged||G.startState.facet(Lt)!=G.state.facet(Lt)||G.startState.field(Qe,!1)!=G.state.field(Qe,!1)||_e(G.startState)!=_e(G.state)||g.foldingChanged(G))&&(this.markers=this.buildMarkers(G.view))}buildMarkers(G){let le=new Se.vB;for(let oe of G.viewportLineBlocks){let pe=ft(G.state,oe.from,oe.to)?P:ee(G.state,oe.from,oe.to)?w:null;pe&&le.add(oe.from,oe.from,pe)}return le.finish()}}),{domEventHandlers:K}=g;return[N,(0,he.cU)({class:"cm-foldGutter",markers(G){var le;return((le=G.plugin(N))===null||le===void 0?void 0:le.markers)||Se.om.empty},initialSpacer(){return new ut(g,!1)},domEventHandlers:Object.assign(Object.assign({},K),{click:(G,le,oe)=>{if(K.click&&K.click(G,le,oe))return!0;let pe=ft(G.state,le.from,le.to);if(pe)return G.dispatch({effects:He.of(pe)}),!0;let Be=ee(G.state,le.from,le.to);return Be?(G.dispatch({effects:we.of(Be)}),!0):!1}})}),st()]}const qt=he.Lz.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class pi{constructor(g,w){this.specs=g;let P;function N(le){let oe=X.G.newName();return(P||(P=Object.create(null)))["."+oe]=le,oe}const K=typeof w.all=="string"?w.all:w.all?N(w.all):void 0,G=w.scope;this.scope=G instanceof xt?le=>le.prop(Fe)==G.data:G?le=>le==G:void 0,this.style=(0,B.az)(g.map(le=>({tag:le.tag,class:le.class||N(Object.assign({},le,{tag:null}))})),{all:K}).style,this.module=P?new X.G(P):null,this.themeType=w.themeType}static define(g,w){return new pi(g,w||{})}}const tn=Se.sj.define(),Ni=Se.sj.define({combine(T){return T.length?[T[0]]:null}});function Bt(T){let g=T.facet(tn);return g.length?g:T.facet(Ni)}function ji(T,g){let w=[vn],P;return T instanceof pi&&(T.module&&w.push(he.Lz.styleModule.of(T.module)),P=T.themeType),g!=null&&g.fallback?w.push(Ni.of(T)):P?w.push(tn.computeN([he.Lz.darkTheme],N=>N.facet(he.Lz.darkTheme)==(P=="dark")?[T]:[])):w.push(tn.of(T)),w}function li(T,g,w){let P=Bt(T),N=null;if(P){for(let K of P)if(!K.scope||w&&K.scope(w)){let G=K.style(g);G&&(N=N?N+" "+G:G)}}return N}class Zi{constructor(g){this.markCache=Object.create(null),this.tree=_e(g.state),this.decorations=this.buildDeco(g,Bt(g.state)),this.decoratedTo=g.viewport.to}update(g){let w=_e(g.state),P=Bt(g.state),N=P!=Bt(g.startState),{viewport:K}=g.view,G=g.changes.mapPos(this.decoratedTo,1);w.length<K.to&&!N&&w.type==this.tree.type&&G>=K.to?(this.decorations=this.decorations.map(g.changes),this.decoratedTo=G):(w!=this.tree||g.viewportChanged||N)&&(this.tree=w,this.decorations=this.buildDeco(g.view,P),this.decoratedTo=K.to)}buildDeco(g,w){if(!w||!this.tree.length)return he.NZ.none;let P=new Se.vB;for(let{from:N,to:K}of g.visibleRanges)(0,B.DM)(this.tree,w,(G,le,oe)=>{P.add(G,le,this.markCache[oe]||(this.markCache[oe]=he.NZ.mark({class:oe})))},N,K);return P.finish()}}const vn=Se.Nb.high(he.Z9.fromClass(Zi,{decorations:T=>T.decorations})),Ii=pi.define([{tag:B._A.meta,color:"#404740"},{tag:B._A.link,textDecoration:"underline"},{tag:B._A.heading,textDecoration:"underline",fontWeight:"bold"},{tag:B._A.emphasis,fontStyle:"italic"},{tag:B._A.strong,fontWeight:"bold"},{tag:B._A.strikethrough,textDecoration:"line-through"},{tag:B._A.keyword,color:"#708"},{tag:[B._A.atom,B._A.bool,B._A.url,B._A.contentSeparator,B._A.labelName],color:"#219"},{tag:[B._A.literal,B._A.inserted],color:"#164"},{tag:[B._A.string,B._A.deleted],color:"#a11"},{tag:[B._A.regexp,B._A.escape,B._A.special(B._A.string)],color:"#e40"},{tag:B._A.definition(B._A.variableName),color:"#00f"},{tag:B._A.local(B._A.variableName),color:"#30a"},{tag:[B._A.typeName,B._A.namespace],color:"#085"},{tag:B._A.className,color:"#167"},{tag:[B._A.special(B._A.variableName),B._A.macroName],color:"#256"},{tag:B._A.definition(B._A.propertyName),color:"#00c"},{tag:B._A.comment,color:"#940"},{tag:B._A.invalid,color:"#f00"}]),Oi=he.Lz.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Et=1e4,Wn="()[]{}",Pn=Se.sj.define({combine(T){return(0,Se.QR)(T,{afterCursor:!0,brackets:Wn,maxScanDistance:Et,renderMatch:bn})}}),qn=he.NZ.mark({class:"cm-matchingBracket"}),Sn=he.NZ.mark({class:"cm-nonmatchingBracket"});function bn(T){let g=[],w=T.matched?qn:Sn;return g.push(w.range(T.start.from,T.start.to)),T.end&&g.push(w.range(T.end.from,T.end.to)),g}const us=[Se.sU.define({create(){return he.NZ.none},update(T,g){if(!g.docChanged&&!g.selection)return T;let w=[],P=g.state.facet(Pn);for(let N of g.state.selection.ranges){if(!N.empty)continue;let K=x(g.state,N.head,-1,P)||N.head>0&&x(g.state,N.head-1,1,P)||P.afterCursor&&(x(g.state,N.head,1,P)||N.head<g.state.doc.length&&x(g.state,N.head+1,-1,P));K&&(w=w.concat(P.renderMatch(K,g.state)))}return he.NZ.set(w,!0)},provide:T=>he.Lz.decorations.from(T)}),Oi];function R(T={}){return[Pn.of(T),us]}const a=new m.uY;function u(T,g,w){let P=T.prop(g<0?m.uY.openedBy:m.uY.closedBy);if(P)return P;if(T.name.length==1){let N=w.indexOf(T.name);if(N>-1&&N%2==(g<0?1:0))return[w[N+g]]}return null}function v(T){let g=T.type.prop(a);return g?g(T.node):T}function x(T,g,w,P={}){let N=P.maxScanDistance||Et,K=P.brackets||Wn,G=_e(T),le=G.resolveInner(g,w);for(let oe=le;oe;oe=oe.parent){let pe=u(oe.type,w,K);if(pe&&oe.from<oe.to){let Be=v(oe);if(Be&&(w>0?g>=Be.from&&g<Be.to:g>Be.from&&g<=Be.to))return O(T,g,w,oe,Be,pe,K)}}return D(T,g,w,G,le.type,N,K)}function O(T,g,w,P,N,K,G){let le=P.parent,oe={from:N.from,to:N.to},pe=0,Be=le==null?void 0:le.cursor();if(Be&&(w<0?Be.childBefore(P.from):Be.childAfter(P.to)))do if(w<0?Be.to<=P.from:Be.from>=P.to){if(pe==0&&K.indexOf(Be.type.name)>-1&&Be.from<Be.to){let dt=v(Be);return{start:oe,end:dt?{from:dt.from,to:dt.to}:void 0,matched:!0}}else if(u(Be.type,w,G))pe++;else if(u(Be.type,-w,G)){if(pe==0){let dt=v(Be);return{start:oe,end:dt&&dt.from<dt.to?{from:dt.from,to:dt.to}:void 0,matched:!1}}pe--}}while(w<0?Be.prevSibling():Be.nextSibling());return{start:oe,matched:!1}}function D(T,g,w,P,N,K,G){let le=w<0?T.sliceDoc(g-1,g):T.sliceDoc(g,g+1),oe=G.indexOf(le);if(oe<0||oe%2==0!=w>0)return null;let pe={from:w<0?g-1:g,to:w>0?g+1:g},Be=T.doc.iterRange(g,w>0?T.doc.length:0),dt=0;for(let Ci=0;!Be.next().done&&Ci<=K;){let gi=Be.value;w<0&&(Ci+=gi.length);let yi=g+Ci*w;for(let ln=w>0?0:gi.length-1,ts=w>0?gi.length:-1;ln!=ts;ln+=w){let an=G.indexOf(gi[ln]);if(!(an<0||P.resolveInner(yi+ln,1).type!=N))if(an%2==0==w>0)dt++;else{if(dt==1)return{start:pe,end:{from:yi+ln,to:yi+ln+1},matched:an>>1==oe>>1};dt--}}w>0&&(Ci+=gi.length)}return Be.done?{start:pe,matched:!1}:null}function W(T,g,w,P=0,N=0){g==null&&(g=T.search(/[^\s\u00a0]/),g==-1&&(g=T.length));let K=N;for(let G=P;G<g;G++)T.charCodeAt(G)==9?K+=w-K%w:K++;return K}class U{constructor(g,w,P,N){this.string=g,this.tabSize=w,this.indentUnit=P,this.overrideIndent=N,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(g){let w=this.string.charAt(this.pos),P;if(typeof g=="string"?P=w==g:P=w&&(g instanceof RegExp?g.test(w):g(w)),P)return++this.pos,w}eatWhile(g){let w=this.pos;for(;this.eat(g););return this.pos>w}eatSpace(){let g=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>g}skipToEnd(){this.pos=this.string.length}skipTo(g){let w=this.string.indexOf(g,this.pos);if(w>-1)return this.pos=w,!0}backUp(g){this.pos-=g}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=W(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var g;return(g=this.overrideIndent)!==null&&g!==void 0?g:W(this.string,null,this.tabSize)}match(g,w,P){if(typeof g=="string"){let N=G=>P?G.toLowerCase():G,K=this.string.substr(this.pos,g.length);return N(K)==N(g)?(w!==!1&&(this.pos+=g.length),!0):null}else{let N=this.string.slice(this.pos).match(g);return N&&N.index>0?null:(N&&w!==!1&&(this.pos+=N[0].length),N)}}current(){return this.string.slice(this.start,this.pos)}}function se(T){return{name:T.name||"",token:T.token,blankLine:T.blankLine||(()=>{}),startState:T.startState||(()=>!0),copyState:T.copyState||ue,indent:T.indent||(()=>null),languageData:T.languageData||{},tokenTable:T.tokenTable||Ai}}function ue(T){if(typeof T!="object")return T;let g={};for(let w in T){let P=T[w];g[w]=P instanceof Array?P.slice():P}return g}const ve=new WeakMap;class Re extends xt{constructor(g){let w=wt(g.languageData),P=se(g),N,K=new class extends m.iX{createParse(G,le,oe){return new mi(N,G,le,oe)}};super(w,K,[ci.of((G,le)=>this.getIndent(G,le))],g.name),this.topNode=Qn(w),N=this,this.streamParser=P,this.stateAfter=new m.uY({perNode:!0}),this.tokenTable=g.tokenTable?new ps(P.tokenTable):Ys}static define(g){return new Re(g)}getIndent(g,w){let P=_e(g.state),N=P.resolve(w);for(;N&&N.type!=this.topNode;)N=N.parent;if(!N)return null;let K,{overrideIndentation:G}=g.options;G&&(K=ve.get(g.state),K!=null&&K<w-1e4&&(K=void 0));let le=De(this,P,0,N.from,K!=null?K:w),oe,pe;if(le?(pe=le.state,oe=le.pos+1):(pe=this.streamParser.startState(g.unit),oe=0),w-oe>1e4)return null;for(;oe<w;){let dt=g.state.doc.lineAt(oe),Ci=Math.min(w,dt.to);if(dt.length){let gi=G?G(dt.from):-1,yi=new U(dt.text,g.state.tabSize,g.unit,gi<0?void 0:gi);for(;yi.pos<Ci-dt.from;)un(this.streamParser.token,yi,pe)}else this.streamParser.blankLine(pe,g.unit);if(Ci==w)break;oe=dt.to+1}let Be=g.lineAt(w);return G&&K==null&&ve.set(g.state,Be.from),this.streamParser.indent(pe,/^\s*(.*)/.exec(Be.text)[1],g)}get allowsNesting(){return!1}}function De(T,g,w,P,N){let K=w>=P&&w+g.length<=N&&g.prop(T.stateAfter);if(K)return{state:T.streamParser.copyState(K),pos:w+g.length};for(let G=g.children.length-1;G>=0;G--){let le=g.children[G],oe=w+g.positions[G],pe=le instanceof m.PH&&oe<N&&De(T,le,oe,P,N);if(pe)return pe}return null}function Nt(T,g,w,P,N){if(N&&w<=0&&P>=g.length)return g;!N&&g.type==T.topNode&&(N=!0);for(let K=g.children.length-1;K>=0;K--){let G=g.positions[K],le=g.children[K],oe;if(G<P&&le instanceof m.PH){if(!(oe=Nt(T,le,w-G,P-G,N)))break;return N?new m.PH(g.type,g.children.slice(0,K).concat(oe),g.positions.slice(0,K+1),G+oe.length):oe}}return null}function $i(T,g,w,P){for(let N of g){let K=N.from+(N.openStart?25:0),G=N.to-(N.openEnd?25:0),le=K<=w&&G>w&&De(T,N.tree,0-N.offset,w,G),oe;if(le&&(oe=Nt(T,N.tree,w+N.offset,le.pos+N.offset,!1)))return{state:le.state,tree:oe}}return{state:T.streamParser.startState(P?ni(P):4),tree:m.PH.empty}}class mi{constructor(g,w,P,N){this.lang=g,this.input=w,this.fragments=P,this.ranges=N,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=N[N.length-1].to;let K=wi.get(),G=N[0].from,{state:le,tree:oe}=$i(g,P,G,K==null?void 0:K.state);this.state=le,this.parsedPos=this.chunkStart=G+oe.length;for(let pe=0;pe<oe.children.length;pe++)this.chunks.push(oe.children[pe]),this.chunkPos.push(oe.positions[pe]);K&&this.parsedPos<K.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(ni(K.state)),K.skipUntilInView(this.parsedPos,K.viewport.from),this.parsedPos=K.viewport.from),this.moveRangeIndex()}advance(){let g=wi.get(),w=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),P=Math.min(w,this.chunkStart+2048);for(g&&(P=Math.min(P,g.viewport.to));this.parsedPos<P;)this.parseLine(g);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=w?this.finish():g&&this.parsedPos>=g.viewport.to?(g.skipUntilInView(this.parsedPos,w),this.finish()):null}stopAt(g){this.stoppedAt=g}lineAfter(g){let w=this.input.chunk(g);if(this.input.lineChunks)w==`
`&&(w="");else{let P=w.indexOf(`
`);P>-1&&(w=w.slice(0,P))}return g+w.length<=this.to?w:w.slice(0,this.to-g)}nextLine(){let g=this.parsedPos,w=this.lineAfter(g),P=g+w.length;for(let N=this.rangeIndex;;){let K=this.ranges[N].to;if(K>=P||(w=w.slice(0,K-(P-w.length)),N++,N==this.ranges.length))break;let G=this.ranges[N].from,le=this.lineAfter(G);w+=le,P=G+le.length}return{line:w,end:P}}skipGapsTo(g,w,P){for(;;){let N=this.ranges[this.rangeIndex].to,K=g+w;if(P>0?N>K:N>=K)break;let G=this.ranges[++this.rangeIndex].from;w+=G-N}return w}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(g,w,P,N,K){if(this.ranges.length>1){K=this.skipGapsTo(w,K,1),w+=K;let G=this.chunk.length;K=this.skipGapsTo(P,K,-1),P+=K,N+=this.chunk.length-G}return this.chunk.push(g,w,P,N),K}parseLine(g){let{line:w,end:P}=this.nextLine(),N=0,{streamParser:K}=this.lang,G=new U(w,g?g.state.tabSize:4,g?ni(g.state):2);if(G.eol())K.blankLine(this.state,G.indentUnit);else for(;!G.eol();){let le=un(K.token,G,this.state);if(le&&(N=this.emitToken(this.lang.tokenTable.resolve(le),this.parsedPos+G.start,this.parsedPos+G.pos,4,N)),G.start>1e4)break}this.parsedPos=P,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let g=m.PH.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:ds,topID:0,maxBufferLength:2048,reused:this.chunkReused});g=new m.PH(g.type,g.children,g.positions,g.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(g),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new m.PH(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function un(T,g,w){g.start=g.pos;for(let P=0;P<10;P++){let N=T(g,w);if(g.pos>g.start)return N}throw new Error("Stream parser failed to advance stream.")}const Ai=Object.create(null),kn=[m.Z6.none],ds=new m.fI(kn),zn=[],Rn=Object.create(null),Bs=Object.create(null);for(let[T,g]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Bs[T]=An(Ai,g);class ps{constructor(g){this.extra=g,this.table=Object.assign(Object.create(null),Bs)}resolve(g){return g?this.table[g]||(this.table[g]=An(this.extra,g)):0}}const Ys=new ps(Ai);function ms(T,g){zn.indexOf(T)>-1||(zn.push(T),console.warn(g))}function An(T,g){let w=[];for(let le of g.split(" ")){let oe=[];for(let pe of le.split(".")){let Be=T[pe]||B._A[pe];Be?typeof Be=="function"?oe.length?oe=oe.map(Be):ms(pe,`Modifier ${pe} used at start of tag`):oe.length?ms(pe,`Tag ${pe} used as modifier`):oe=Array.isArray(Be)?Be:[Be]:ms(pe,`Unknown highlighting tag ${pe}`)}for(let pe of oe)w.push(pe)}if(!w.length)return 0;let P=g.replace(/ /g,"_"),N=P+" "+w.map(le=>le.id),K=Rn[N];if(K)return K.id;let G=Rn[N]=m.Z6.define({id:kn.length,name:P,props:[(0,B.pn)({[P]:w})]});return kn.push(G),G.id}function Qn(T){let g=m.Z6.define({id:kn.length,name:"Document",props:[Fe.add(()=>T)],top:!0});return kn.push(g),g}function Ln(T){return T.length<=4096&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(T)}function Ki(T){for(let g=T.iter();!g.next().done;)if(Ln(g.value))return!0;return!1}function _n(T){let g=!1;return T.iterChanges((w,P,N,K,G)=>{!g&&Ki(G)&&(g=!0)}),g}const es=Se.sj.define({combine:T=>T.some(g=>g)});function or(T={}){let g=[Js];return T.alwaysIsolate&&g.push(es.of(!0)),g}const Js=he.Z9.fromClass(class{constructor(T){this.always=T.state.facet(es)||T.textDirection!=he.OP.LTR||T.state.facet(he.Lz.perLineTextDirection),this.hasRTL=!this.always&&Ki(T.state.doc),this.tree=_e(T.state),this.decorations=this.always||this.hasRTL?Ns(T,this.tree,this.always):he.NZ.none}update(T){let g=T.state.facet(es)||T.view.textDirection!=he.OP.LTR||T.state.facet(he.Lz.perLineTextDirection);if(!g&&!this.hasRTL&&_n(T.changes)&&(this.hasRTL=!0),!g&&!this.hasRTL)return;let w=_e(T.state);(g!=this.always||w!=this.tree||T.docChanged||T.viewportChanged)&&(this.tree=w,this.always=g,this.decorations=Ns(T.view,w,g))}},{provide:T=>{function g(w){var P,N;return(N=(P=w.plugin(T))===null||P===void 0?void 0:P.decorations)!==null&&N!==void 0?N:he.NZ.none}return[he.Lz.outerDecorations.of(g),Se.Nb.lowest(he.Lz.bidiIsolatedRanges.of(g))]}});function Ns(T,g,w){let P=new Se.vB,N=T.visibleRanges;w||(N=Tr(N,T.state.doc));for(let{from:K,to:G}of N)g.iterate({enter:le=>{let oe=le.type.prop(m.uY.isolate);oe&&P.add(le.from,le.to,gs[oe])},from:K,to:G});return P.finish()}function Tr(T,g){let w=g.iter(),P=0,N=[],K=null;for(let{from:G,to:le}of T)for(G!=P&&(P<G&&w.next(G-P),P=G);;){let oe=P,pe=P+w.value.length;if(!w.lineBreak&&Ln(w.value)&&(K&&K.to>oe-10?K.to=Math.min(le,pe):N.push(K={from:oe,to:Math.min(le,pe)})),P>=le)break;P=pe,w.next()}return N}const gs={rtl:he.NZ.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:he.OP.RTL}),ltr:he.NZ.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:he.OP.LTR}),auto:he.NZ.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})}},69561:(yn,Wt,q)=>{q.d(Wt,{o:()=>he});var m=["true","false","on","off","yes","no"],Se=new RegExp("\\b(("+m.join(")|(")+"))$","i");const he={name:"yaml",token:function(B,X){var Ae=B.peek(),Fe=X.escaped;if(X.escaped=!1,Ae=="#"&&(B.pos==0||/\s/.test(B.string.charAt(B.pos-1))))return B.skipToEnd(),"comment";if(B.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(X.literal&&B.indentation()>X.keyCol)return B.skipToEnd(),"string";if(X.literal&&(X.literal=!1),B.sol()){if(X.keyCol=0,X.pair=!1,X.pairStart=!1,B.match("---")||B.match("..."))return"def";if(B.match(/^\s*-\s+/))return"meta"}if(B.match(/^(\{|\}|\[|\])/))return Ae=="{"?X.inlinePairs++:Ae=="}"?X.inlinePairs--:Ae=="["?X.inlineList++:X.inlineList--,"meta";if(X.inlineList>0&&!Fe&&Ae==",")return B.next(),"meta";if(X.inlinePairs>0&&!Fe&&Ae==",")return X.keyCol=0,X.pair=!1,X.pairStart=!1,B.next(),"meta";if(X.pairStart){if(B.match(/^\s*(\||\>)\s*/))return X.literal=!0,"meta";if(B.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(X.inlinePairs==0&&B.match(/^\s*-?[0-9\.\,]+\s?$/)||X.inlinePairs>0&&B.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(B.match(Se))return"keyword"}return!X.pair&&B.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(X.pair=!0,X.keyCol=B.indentation(),"atom"):X.pair&&B.match(/^:\s*/)?(X.pairStart=!0,"meta"):(X.pairStart=!1,X.escaped=Ae=="\\",B.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},14830:(yn,Wt,q)=>{q.d(Wt,{$t:()=>ut,EY:()=>m,FB:()=>qt,Fh:()=>di,Gu:()=>Lt,Je:()=>st,MK:()=>Dt,Nb:()=>en,OF:()=>ce,Pe:()=>Kt,QR:()=>bt,VR:()=>Pt,YH:()=>ft,ZX:()=>Ut,iR:()=>It,kn:()=>us,om:()=>Bt,sU:()=>zt,sj:()=>Me,vB:()=>li,vS:()=>ui,y$:()=>Ls,zK:()=>Zt});class m{lineAt(a){if(a<0||a>this.length)throw new RangeError(`Invalid position ${a} in document of length ${this.length}`);return this.lineInner(a,!1,1,0)}line(a){if(a<1||a>this.lines)throw new RangeError(`Invalid line number ${a} in ${this.lines}-line document`);return this.lineInner(a,!0,1,0)}replace(a,u,v){[a,u]=Ke(this,a,u);let x=[];return this.decompose(0,a,x,2),v.length&&v.decompose(0,v.length,x,3),this.decompose(u,this.length,x,1),he.from(x,this.length-(u-a)+v.length)}append(a){return this.replace(this.length,this.length,a)}slice(a,u=this.length){[a,u]=Ke(this,a,u);let v=[];return this.decompose(a,u,v,0),he.from(v,u-a)}eq(a){if(a==this)return!0;if(a.length!=this.length||a.lines!=this.lines)return!1;let u=this.scanIdentical(a,1),v=this.length-this.scanIdentical(a,-1),x=new Fe(this),O=new Fe(a);for(let D=u,W=u;;){if(x.next(D),O.next(D),D=0,x.lineBreak!=O.lineBreak||x.done!=O.done||x.value!=O.value)return!1;if(W+=x.value.length,x.done||W>=v)return!0}}iter(a=1){return new Fe(this,a)}iterRange(a,u=this.length){return new wt(this,a,u)}iterLines(a,u){let v;if(a==null)v=this.iter();else{u==null&&(u=this.lines+1);let x=this.line(a).from;v=this.iterRange(x,Math.max(x,u==this.lines+1?this.length:u<=1?0:this.line(u-1).to))}return new ht(v)}toString(){return this.sliceString(0)}toJSON(){let a=[];return this.flatten(a),a}constructor(){}static of(a){if(a.length==0)throw new RangeError("A document must have at least one line");return a.length==1&&!a[0]?m.empty:a.length<=32?new Se(a):he.from(Se.split(a,[]))}}class Se extends m{constructor(a,u=B(a)){super(),this.text=a,this.length=u}get lines(){return this.text.length}get children(){return null}lineInner(a,u,v,x){for(let O=0;;O++){let D=this.text[O],W=x+D.length;if((u?v:W)>=a)return new xt(x,W,v,D);x=W+1,v++}}decompose(a,u,v,x){let O=a<=0&&u>=this.length?this:new Se(Ae(this.text,a,u),Math.min(u,this.length)-Math.max(0,a));if(x&1){let D=v.pop(),W=X(O.text,D.text.slice(),0,O.length);if(W.length<=32)v.push(new Se(W,D.length+O.length));else{let U=W.length>>1;v.push(new Se(W.slice(0,U)),new Se(W.slice(U)))}}else v.push(O)}replace(a,u,v){if(!(v instanceof Se))return super.replace(a,u,v);[a,u]=Ke(this,a,u);let x=X(this.text,X(v.text,Ae(this.text,0,a)),u),O=this.length+v.length-(u-a);return x.length<=32?new Se(x,O):he.from(Se.split(x,[]),O)}sliceString(a,u=this.length,v=`
`){[a,u]=Ke(this,a,u);let x="";for(let O=0,D=0;O<=u&&D<this.text.length;D++){let W=this.text[D],U=O+W.length;O>a&&D&&(x+=v),a<U&&u>O&&(x+=W.slice(Math.max(0,a-O),u-O)),O=U+1}return x}flatten(a){for(let u of this.text)a.push(u)}scanIdentical(){return 0}static split(a,u){let v=[],x=-1;for(let O of a)v.push(O),x+=O.length+1,v.length==32&&(u.push(new Se(v,x)),v=[],x=-1);return x>-1&&u.push(new Se(v,x)),u}}class he extends m{constructor(a,u){super(),this.children=a,this.length=u,this.lines=0;for(let v of a)this.lines+=v.lines}lineInner(a,u,v,x){for(let O=0;;O++){let D=this.children[O],W=x+D.length,U=v+D.lines-1;if((u?U:W)>=a)return D.lineInner(a,u,v,x);x=W+1,v=U+1}}decompose(a,u,v,x){for(let O=0,D=0;D<=u&&O<this.children.length;O++){let W=this.children[O],U=D+W.length;if(a<=U&&u>=D){let se=x&((D<=a?1:0)|(U>=u?2:0));D>=a&&U<=u&&!se?v.push(W):W.decompose(a-D,u-D,v,se)}D=U+1}}replace(a,u,v){if([a,u]=Ke(this,a,u),v.lines<this.lines)for(let x=0,O=0;x<this.children.length;x++){let D=this.children[x],W=O+D.length;if(a>=O&&u<=W){let U=D.replace(a-O,u-O,v),se=this.lines-D.lines+U.lines;if(U.lines<se>>5-1&&U.lines>se>>5+1){let ue=this.children.slice();return ue[x]=U,new he(ue,this.length-(u-a)+v.length)}return super.replace(O,W,U)}O=W+1}return super.replace(a,u,v)}sliceString(a,u=this.length,v=`
`){[a,u]=Ke(this,a,u);let x="";for(let O=0,D=0;O<this.children.length&&D<=u;O++){let W=this.children[O],U=D+W.length;D>a&&O&&(x+=v),a<U&&u>D&&(x+=W.sliceString(a-D,u-D,v)),D=U+1}return x}flatten(a){for(let u of this.children)u.flatten(a)}scanIdentical(a,u){if(!(a instanceof he))return 0;let v=0,[x,O,D,W]=u>0?[0,0,this.children.length,a.children.length]:[this.children.length-1,a.children.length-1,-1,-1];for(;;x+=u,O+=u){if(x==D||O==W)return v;let U=this.children[x],se=a.children[O];if(U!=se)return v+U.scanIdentical(se,u);v+=U.length+1}}static from(a,u=a.reduce((v,x)=>v+x.length+1,-1)){let v=0;for(let De of a)v+=De.lines;if(v<32){let De=[];for(let Nt of a)Nt.flatten(De);return new Se(De,u)}let x=Math.max(32,v>>5),O=x<<1,D=x>>1,W=[],U=0,se=-1,ue=[];function ve(De){let Nt;if(De.lines>O&&De instanceof he)for(let $i of De.children)ve($i);else De.lines>D&&(U>D||!U)?(Re(),W.push(De)):De instanceof Se&&U&&(Nt=ue[ue.length-1])instanceof Se&&De.lines+Nt.lines<=32?(U+=De.lines,se+=De.length+1,ue[ue.length-1]=new Se(Nt.text.concat(De.text),Nt.length+1+De.length)):(U+De.lines>x&&Re(),U+=De.lines,se+=De.length+1,ue.push(De))}function Re(){U!=0&&(W.push(ue.length==1?ue[0]:he.from(ue,se)),se=-1,U=ue.length=0)}for(let De of a)ve(De);return Re(),W.length==1?W[0]:new he(W,u)}}m.empty=new Se([""],0);function B(R){let a=-1;for(let u of R)a+=u.length+1;return a}function X(R,a,u=0,v=1e9){for(let x=0,O=0,D=!0;O<R.length&&x<=v;O++){let W=R[O],U=x+W.length;U>=u&&(U>v&&(W=W.slice(0,v-x)),x<u&&(W=W.slice(u-x)),D?(a[a.length-1]+=W,D=!1):a.push(W)),x=U+1}return a}function Ae(R,a,u){return X(R,[""],a,u)}class Fe{constructor(a,u=1){this.dir=u,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[a],this.offsets=[u>0?1:(a instanceof Se?a.text.length:a.children.length)<<1]}nextInner(a,u){for(this.done=this.lineBreak=!1;;){let v=this.nodes.length-1,x=this.nodes[v],O=this.offsets[v],D=O>>1,W=x instanceof Se?x.text.length:x.children.length;if(D==(u>0?W:0)){if(v==0)return this.done=!0,this.value="",this;u>0&&this.offsets[v-1]++,this.nodes.pop(),this.offsets.pop()}else if((O&1)==(u>0?0:1)){if(this.offsets[v]+=u,a==0)return this.lineBreak=!0,this.value=`
`,this;a--}else if(x instanceof Se){let U=x.text[D+(u<0?-1:0)];if(this.offsets[v]+=u,U.length>Math.max(0,a))return this.value=a==0?U:u>0?U.slice(a):U.slice(0,U.length-a),this;a-=U.length}else{let U=x.children[D+(u<0?-1:0)];a>U.length?(a-=U.length,this.offsets[v]+=u):(u<0&&this.offsets[v]--,this.nodes.push(U),this.offsets.push(u>0?1:(U instanceof Se?U.text.length:U.children.length)<<1))}}}next(a=0){return a<0&&(this.nextInner(-a,-this.dir),a=this.value.length),this.nextInner(a,this.dir)}}class wt{constructor(a,u,v){this.value="",this.done=!1,this.cursor=new Fe(a,u>v?-1:1),this.pos=u>v?a.length:0,this.from=Math.min(u,v),this.to=Math.max(u,v)}nextInner(a,u){if(u<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;a+=Math.max(0,u<0?this.pos-this.to:this.from-this.pos);let v=u<0?this.pos-this.from:this.to-this.pos;a>v&&(a=v),v-=a;let{value:x}=this.cursor.next(a);return this.pos+=(x.length+a)*u,this.value=x.length<=v?x:u<0?x.slice(x.length-v):x.slice(0,v),this.done=!this.value,this}next(a=0){return a<0?a=Math.max(a,this.from-this.pos):a>0&&(a=Math.min(a,this.to-this.pos)),this.nextInner(a,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class ht{constructor(a){this.inner=a,this.afterBreak=!0,this.value="",this.done=!1}next(a=0){let{done:u,lineBreak:v,value:x}=this.inner.next(a);return u&&this.afterBreak?(this.value="",this.afterBreak=!1):u?(this.done=!0,this.value=""):v?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=x,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(m.prototype[Symbol.iterator]=function(){return this.iter()},Fe.prototype[Symbol.iterator]=wt.prototype[Symbol.iterator]=ht.prototype[Symbol.iterator]=function(){return this});class xt{constructor(a,u,v,x){this.from=a,this.to=u,this.number=v,this.text=x}get length(){return this.to-this.from}}function Ke(R,a,u){return a=Math.max(0,Math.min(R.length,a)),[a,Math.max(a,Math.min(R.length,u))]}let it="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(R=>R?parseInt(R,36):1);for(let R=1;R<it.length;R++)it[R]+=it[R-1];function _e(R){for(let a=1;a<it.length;a+=2)if(it[a]>R)return it[a-1]<=R;return!1}function gt(R){return R>=127462&&R<=127487}const fi=8205;function Zt(R,a,u=!0,v=!0){return(u?ge:ct)(R,a,v)}function ge(R,a,u){if(a==R.length)return a;a&&Yt(R.charCodeAt(a))&&wi(R.charCodeAt(a-1))&&a--;let v=ui(R,a);for(a+=di(v);a<R.length;){let x=ui(R,a);if(v==fi||x==fi||u&&_e(x))a+=di(x),v=x;else if(gt(x)){let O=0,D=a-2;for(;D>=0&&gt(ui(R,D));)O++,D-=2;if(O%2==0)break;a+=2}else break}return a}function ct(R,a,u){for(;a>0;){let v=ge(R,a-2,u);if(v<a)return v;a--}return 0}function Yt(R){return R>=56320&&R<57344}function wi(R){return R>=55296&&R<56320}function ui(R,a){let u=R.charCodeAt(a);if(!wi(u)||a+1==R.length)return u;let v=R.charCodeAt(a+1);return Yt(v)?(u-55296<<10)+(v-56320)+65536:u}function Dt(R){return R<=65535?String.fromCharCode(R):(R-=65536,String.fromCharCode((R>>10)+55296,(R&1023)+56320))}function di(R){return R<65536?1:2}const Li=/\r\n?|\n/;var It=function(R){return R[R.Simple=0]="Simple",R[R.TrackDel=1]="TrackDel",R[R.TrackBefore=2]="TrackBefore",R[R.TrackAfter=3]="TrackAfter",R}(It||(It={}));class Lt{constructor(a){this.sections=a}get length(){let a=0;for(let u=0;u<this.sections.length;u+=2)a+=this.sections[u];return a}get newLength(){let a=0;for(let u=0;u<this.sections.length;u+=2){let v=this.sections[u+1];a+=v<0?this.sections[u]:v}return a}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(a){for(let u=0,v=0,x=0;u<this.sections.length;){let O=this.sections[u++],D=this.sections[u++];D<0?(a(v,x,O),x+=O):x+=D,v+=O}}iterChangedRanges(a,u=!1){ii(this,a,u)}get invertedDesc(){let a=[];for(let u=0;u<this.sections.length;){let v=this.sections[u++],x=this.sections[u++];x<0?a.push(v,x):a.push(x,v)}return new Lt(a)}composeDesc(a){return this.empty?a:a.empty?this:Ye(this,a)}mapDesc(a,u=!1){return a.empty?this:ni(this,a,u)}mapPos(a,u=-1,v=It.Simple){let x=0,O=0;for(let D=0;D<this.sections.length;){let W=this.sections[D++],U=this.sections[D++],se=x+W;if(U<0){if(se>a)return O+(a-x);O+=W}else{if(v!=It.Simple&&se>=a&&(v==It.TrackDel&&x<a&&se>a||v==It.TrackBefore&&x<a||v==It.TrackAfter&&se>a))return null;if(se>a||se==a&&u<0&&!W)return a==x||u<0?O:O+U;O+=U}x=se}if(a>x)throw new RangeError(`Position ${a} is out of range for changeset of length ${x}`);return O}touchesRange(a,u=a){for(let v=0,x=0;v<this.sections.length&&x<=u;){let O=this.sections[v++],D=this.sections[v++],W=x+O;if(D>=0&&x<=u&&W>=a)return x<a&&W>u?"cover":!0;x=W}return!1}toString(){let a="";for(let u=0;u<this.sections.length;){let v=this.sections[u++],x=this.sections[u++];a+=(a?" ":"")+v+(x>=0?":"+x:"")}return a}toJSON(){return this.sections}static fromJSON(a){if(!Array.isArray(a)||a.length%2||a.some(u=>typeof u!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Lt(a)}static create(a){return new Lt(a)}}class Pt extends Lt{constructor(a,u){super(a),this.inserted=u}apply(a){if(this.length!=a.length)throw new RangeError("Applying change set to a document with the wrong length");return ii(this,(u,v,x,O,D)=>a=a.replace(x,x+(v-u),D),!1),a}mapDesc(a,u=!1){return ni(this,a,u,!0)}invert(a){let u=this.sections.slice(),v=[];for(let x=0,O=0;x<u.length;x+=2){let D=u[x],W=u[x+1];if(W>=0){u[x]=W,u[x+1]=D;let U=x>>1;for(;v.length<U;)v.push(m.empty);v.push(D?a.slice(O,O+D):m.empty)}O+=D}return new Pt(u,v)}compose(a){return this.empty?a:a.empty?this:Ye(this,a,!0)}map(a,u=!1){return a.empty?this:ni(this,a,u,!0)}iterChanges(a,u=!1){ii(this,a,u)}get desc(){return Lt.create(this.sections)}filter(a){let u=[],v=[],x=[],O=new Ti(this);e:for(let D=0,W=0;;){let U=D==a.length?1e9:a[D++];for(;W<U||W==U&&O.len==0;){if(O.done)break e;let ue=Math.min(O.len,U-W);St(x,ue,-1);let ve=O.ins==-1?-1:O.off==0?O.ins:0;St(u,ue,ve),ve>0&&ci(v,u,O.text),O.forward(ue),W+=ue}let se=a[D++];for(;W<se;){if(O.done)break e;let ue=Math.min(O.len,se-W);St(u,ue,-1),St(x,ue,O.ins==-1?-1:O.off==0?O.ins:0),O.forward(ue),W+=ue}}return{changes:new Pt(u,v),filtered:Lt.create(x)}}toJSON(){let a=[];for(let u=0;u<this.sections.length;u+=2){let v=this.sections[u],x=this.sections[u+1];x<0?a.push(v):x==0?a.push([v]):a.push([v].concat(this.inserted[u>>1].toJSON()))}return a}static of(a,u,v){let x=[],O=[],D=0,W=null;function U(ue=!1){if(!ue&&!x.length)return;D<u&&St(x,u-D,-1);let ve=new Pt(x,O);W=W?W.compose(ve.map(W)):ve,x=[],O=[],D=0}function se(ue){if(Array.isArray(ue))for(let ve of ue)se(ve);else if(ue instanceof Pt){if(ue.length!=u)throw new RangeError(`Mismatched change set length (got ${ue.length}, expected ${u})`);U(),W=W?W.compose(ue.map(W)):ue}else{let{from:ve,to:Re=ve,insert:De}=ue;if(ve>Re||ve<0||Re>u)throw new RangeError(`Invalid change range ${ve} to ${Re} (in doc of length ${u})`);let Nt=De?typeof De=="string"?m.of(De.split(v||Li)):De:m.empty,$i=Nt.length;if(ve==Re&&$i==0)return;ve<D&&U(),ve>D&&St(x,ve-D,-1),St(x,Re-ve,$i),ci(O,x,Nt),D=Re}}return se(a),U(!W),W}static empty(a){return new Pt(a?[a,-1]:[],[])}static fromJSON(a){if(!Array.isArray(a))throw new RangeError("Invalid JSON representation of ChangeSet");let u=[],v=[];for(let x=0;x<a.length;x++){let O=a[x];if(typeof O=="number")u.push(O,-1);else{if(!Array.isArray(O)||typeof O[0]!="number"||O.some((D,W)=>W&&typeof D!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(O.length==1)u.push(O[0],0);else{for(;v.length<x;)v.push(m.empty);v[x]=m.of(O.slice(1)),u.push(O[0],v[x].length)}}}return new Pt(u,v)}static createSet(a,u){return new Pt(a,u)}}function St(R,a,u,v=!1){if(a==0&&u<=0)return;let x=R.length-2;x>=0&&u<=0&&u==R[x+1]?R[x]+=a:a==0&&R[x]==0?R[x+1]+=u:v?(R[x]+=a,R[x+1]+=u):R.push(a,u)}function ci(R,a,u){if(u.length==0)return;let v=a.length-2>>1;if(v<R.length)R[R.length-1]=R[R.length-1].append(u);else{for(;R.length<v;)R.push(m.empty);R.push(u)}}function ii(R,a,u){let v=R.inserted;for(let x=0,O=0,D=0;D<R.sections.length;){let W=R.sections[D++],U=R.sections[D++];if(U<0)x+=W,O+=W;else{let se=x,ue=O,ve=m.empty;for(;se+=W,ue+=U,U&&v&&(ve=ve.append(v[D-2>>1])),!(u||D==R.sections.length||R.sections[D+1]<0);)W=R.sections[D++],U=R.sections[D++];a(x,se,O,ue,ve),x=se,O=ue}}}function ni(R,a,u,v=!1){let x=[],O=v?[]:null,D=new Ti(R),W=new Ti(a);for(let U=-1;;)if(D.ins==-1&&W.ins==-1){let se=Math.min(D.len,W.len);St(x,se,-1),D.forward(se),W.forward(se)}else if(W.ins>=0&&(D.ins<0||U==D.i||D.off==0&&(W.len<D.len||W.len==D.len&&!u))){let se=W.len;for(St(x,W.ins,-1);se;){let ue=Math.min(D.len,se);D.ins>=0&&U<D.i&&D.len<=ue&&(St(x,0,D.ins),O&&ci(O,x,D.text),U=D.i),D.forward(ue),se-=ue}W.next()}else if(D.ins>=0){let se=0,ue=D.len;for(;ue;)if(W.ins==-1){let ve=Math.min(ue,W.len);se+=ve,ue-=ve,W.forward(ve)}else if(W.ins==0&&W.len<ue)ue-=W.len,W.next();else break;St(x,se,U<D.i?D.ins:0),O&&U<D.i&&ci(O,x,D.text),U=D.i,D.forward(D.len-ue)}else{if(D.done&&W.done)return O?Pt.createSet(x,O):Lt.create(x);throw new Error("Mismatched change set lengths")}}function Ye(R,a,u=!1){let v=[],x=u?[]:null,O=new Ti(R),D=new Ti(a);for(let W=!1;;){if(O.done&&D.done)return x?Pt.createSet(v,x):Lt.create(v);if(O.ins==0)St(v,O.len,0,W),O.next();else if(D.len==0&&!D.done)St(v,0,D.ins,W),x&&ci(x,v,D.text),D.next();else{if(O.done||D.done)throw new Error("Mismatched change set lengths");{let U=Math.min(O.len2,D.len),se=v.length;if(O.ins==-1){let ue=D.ins==-1?-1:D.off?0:D.ins;St(v,U,ue,W),x&&ue&&ci(x,v,D.text)}else D.ins==-1?(St(v,O.off?0:O.len,U,W),x&&ci(x,v,O.textBit(U))):(St(v,O.off?0:O.len,D.off?0:D.ins,W),x&&!D.off&&ci(x,v,D.text));W=(O.ins>U||D.ins>=0&&D.len>U)&&(W||v.length>se),O.forward2(U),D.forward(U)}}}}class Ti{constructor(a){this.set=a,this.i=0,this.next()}next(){let{sections:a}=this.set;this.i<a.length?(this.len=a[this.i++],this.ins=a[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:a}=this.set,u=this.i-2>>1;return u>=a.length?m.empty:a[u]}textBit(a){let{inserted:u}=this.set,v=this.i-2>>1;return v>=u.length&&!a?m.empty:u[v].slice(this.off,a==null?void 0:this.off+a)}forward(a){a==this.len?this.next():(this.len-=a,this.off+=a)}forward2(a){this.ins==-1?this.forward(a):a==this.ins?this.next():(this.ins-=a,this.off+=a)}}class Je{constructor(a,u,v){this.from=a,this.to=u,this.flags=v}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let a=this.flags&7;return a==7?null:a}get goalColumn(){let a=this.flags>>6;return a==16777215?void 0:a}map(a,u=-1){let v,x;return this.empty?v=x=a.mapPos(this.from,u):(v=a.mapPos(this.from,1),x=a.mapPos(this.to,-1)),v==this.from&&x==this.to?this:new Je(v,x,this.flags)}extend(a,u=a){if(a<=this.anchor&&u>=this.anchor)return ce.range(a,u);let v=Math.abs(a-this.anchor)>Math.abs(u-this.anchor)?a:u;return ce.range(this.anchor,v)}eq(a,u=!1){return this.anchor==a.anchor&&this.head==a.head&&(!u||!this.empty||this.assoc==a.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(a){if(!a||typeof a.anchor!="number"||typeof a.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ce.range(a.anchor,a.head)}static create(a,u,v){return new Je(a,u,v)}}class ce{constructor(a,u){this.ranges=a,this.mainIndex=u}map(a,u=-1){return a.empty?this:ce.create(this.ranges.map(v=>v.map(a,u)),this.mainIndex)}eq(a,u=!1){if(this.ranges.length!=a.ranges.length||this.mainIndex!=a.mainIndex)return!1;for(let v=0;v<this.ranges.length;v++)if(!this.ranges[v].eq(a.ranges[v],u))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ce([this.main],0)}addRange(a,u=!0){return ce.create([a].concat(this.ranges),u?0:this.mainIndex+1)}replaceRange(a,u=this.mainIndex){let v=this.ranges.slice();return v[u]=a,ce.create(v,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(a=>a.toJSON()),main:this.mainIndex}}static fromJSON(a){if(!a||!Array.isArray(a.ranges)||typeof a.main!="number"||a.main>=a.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ce(a.ranges.map(u=>Je.fromJSON(u)),a.main)}static single(a,u=a){return new ce([ce.range(a,u)],0)}static create(a,u=0){if(a.length==0)throw new RangeError("A selection needs at least one range");for(let v=0,x=0;x<a.length;x++){let O=a[x];if(O.empty?O.from<=v:O.from<v)return ce.normalized(a.slice(),u);v=O.to}return new ce(a,u)}static cursor(a,u=0,v,x){return Je.create(a,a,(u==0?0:u<0?8:16)|(v==null?7:Math.min(6,v))|(x!=null?x:16777215)<<6)}static range(a,u,v,x){let O=(v!=null?v:16777215)<<6|(x==null?7:Math.min(6,x));return u<a?Je.create(u,a,48|O):Je.create(a,u,(u>a?8:0)|O)}static normalized(a,u=0){let v=a[u];a.sort((x,O)=>x.from-O.from),u=a.indexOf(v);for(let x=1;x<a.length;x++){let O=a[x],D=a[x-1];if(O.empty?O.from<=D.to:O.from<D.to){let W=D.from,U=Math.max(O.to,D.to);x<=u&&u--,a.splice(--x,2,O.anchor>O.head?ce.range(U,W):ce.range(W,U))}}return new ce(a,u)}}function xe(R,a){for(let u of R.ranges)if(u.to>a)throw new RangeError("Selection points outside of document")}let ze=0;class Me{constructor(a,u,v,x,O){this.combine=a,this.compareInput=u,this.compare=v,this.isStatic=x,this.id=ze++,this.default=a([]),this.extensions=typeof O=="function"?O(this):O}get reader(){return this}static define(a={}){return new Me(a.combine||(u=>u),a.compareInput||((u,v)=>u===v),a.compare||(a.combine?(u,v)=>u===v:Oe),!!a.static,a.enables)}of(a){return new $t([],this,0,a)}compute(a,u){if(this.isStatic)throw new Error("Can't compute a static facet");return new $t(a,this,1,u)}computeN(a,u){if(this.isStatic)throw new Error("Can't compute a static facet");return new $t(a,this,2,u)}from(a,u){return u||(u=v=>v),this.compute([a],v=>u(v.field(a)))}}function Oe(R,a){return R==a||R.length==a.length&&R.every((u,v)=>u===a[v])}class $t{constructor(a,u,v,x){this.dependencies=a,this.facet=u,this.type=v,this.value=x,this.id=ze++}dynamicSlot(a){var u;let v=this.value,x=this.facet.compareInput,O=this.id,D=a[O]>>1,W=this.type==2,U=!1,se=!1,ue=[];for(let ve of this.dependencies)ve=="doc"?U=!0:ve=="selection"?se=!0:((u=a[ve.id])!==null&&u!==void 0?u:1)&1||ue.push(a[ve.id]);return{create(ve){return ve.values[D]=v(ve),1},update(ve,Re){if(U&&Re.docChanged||se&&(Re.docChanged||Re.selection)||_t(ve,ue)){let De=v(ve);if(W?!Ne(De,ve.values[D],x):!x(De,ve.values[D]))return ve.values[D]=De,1}return 0},reconfigure:(ve,Re)=>{let De,Nt=Re.config.address[O];if(Nt!=null){let $i=$(Re,Nt);if(this.dependencies.every(mi=>mi instanceof Me?Re.facet(mi)===ve.facet(mi):mi instanceof zt?Re.field(mi,!1)==ve.field(mi,!1):!0)||(W?Ne(De=v(ve),$i,x):x(De=v(ve),$i)))return ve.values[D]=$i,0}else De=v(ve);return ve.values[D]=De,1}}}}function Ne(R,a,u){if(R.length!=a.length)return!1;for(let v=0;v<R.length;v++)if(!u(R[v],a[v]))return!1;return!0}function _t(R,a){let u=!1;for(let v of a)F(R,v)&1&&(u=!0);return u}function et(R,a,u){let v=u.map(U=>R[U.id]),x=u.map(U=>U.type),O=v.filter(U=>!(U&1)),D=R[a.id]>>1;function W(U){let se=[];for(let ue=0;ue<v.length;ue++){let ve=$(U,v[ue]);if(x[ue]==2)for(let Re of ve)se.push(Re);else se.push(ve)}return a.combine(se)}return{create(U){for(let se of v)F(U,se);return U.values[D]=W(U),1},update(U,se){if(!_t(U,O))return 0;let ue=W(U);return a.compare(ue,U.values[D])?0:(U.values[D]=ue,1)},reconfigure(U,se){let ue=_t(U,v),ve=se.config.facets[a.id],Re=se.facet(a);if(ve&&!ue&&Oe(u,ve))return U.values[D]=Re,0;let De=W(U);return a.compare(De,Re)?(U.values[D]=Re,0):(U.values[D]=De,1)}}}const Bi=Me.define({static:!0});class zt{constructor(a,u,v,x,O){this.id=a,this.createF=u,this.updateF=v,this.compareF=x,this.spec=O,this.provides=void 0}static define(a){let u=new zt(ze++,a.create,a.update,a.compare||((v,x)=>v===x),a);return a.provide&&(u.provides=a.provide(u)),u}create(a){let u=a.facet(Bi).find(v=>v.field==this);return((u==null?void 0:u.create)||this.createF)(a)}slot(a){let u=a[this.id]>>1;return{create:v=>(v.values[u]=this.create(v),1),update:(v,x)=>{let O=v.values[u],D=this.updateF(O,x);return this.compareF(O,D)?0:(v.values[u]=D,1)},reconfigure:(v,x)=>x.config.address[this.id]!=null?(v.values[u]=x.field(this),0):(v.values[u]=this.create(v),1)}}init(a){return[this,Bi.of({field:this,create:a})]}get extension(){return this}}const yt={lowest:4,low:3,default:2,high:1,highest:0};function oi(R){return a=>new Gi(a,R)}const en={highest:oi(yt.highest),high:oi(yt.high),default:oi(yt.default),low:oi(yt.low),lowest:oi(yt.lowest)};class Gi{constructor(a,u){this.inner=a,this.prec=u}}class te{of(a){return new S(this,a)}reconfigure(a){return te.reconfigure.of({compartment:this,extension:a})}get(a){return a.config.compartments.get(this)}}class S{constructor(a,u){this.compartment=a,this.inner=u}}class A{constructor(a,u,v,x,O,D){for(this.base=a,this.compartments=u,this.dynamicSlots=v,this.address=x,this.staticValues=O,this.facets=D,this.statusTemplate=[];this.statusTemplate.length<v.length;)this.statusTemplate.push(0)}staticFacet(a){let u=this.address[a.id];return u==null?a.default:this.staticValues[u>>1]}static resolve(a,u,v){let x=[],O=Object.create(null),D=new Map;for(let Re of I(a,u,D))Re instanceof zt?x.push(Re):(O[Re.facet.id]||(O[Re.facet.id]=[])).push(Re);let W=Object.create(null),U=[],se=[];for(let Re of x)W[Re.id]=se.length<<1,se.push(De=>Re.slot(De));let ue=v==null?void 0:v.config.facets;for(let Re in O){let De=O[Re],Nt=De[0].facet,$i=ue&&ue[Re]||[];if(De.every(mi=>mi.type==0))if(W[Nt.id]=U.length<<1|1,Oe($i,De))U.push(v.facet(Nt));else{let mi=Nt.combine(De.map(un=>un.value));U.push(v&&Nt.compare(mi,v.facet(Nt))?v.facet(Nt):mi)}else{for(let mi of De)mi.type==0?(W[mi.id]=U.length<<1|1,U.push(mi.value)):(W[mi.id]=se.length<<1,se.push(un=>mi.dynamicSlot(un)));W[Nt.id]=se.length<<1,se.push(mi=>et(mi,Nt,De))}}let ve=se.map(Re=>Re(W));return new A(a,D,ve,W,U,O)}}function I(R,a,u){let v=[[],[],[],[],[]],x=new Map;function O(D,W){let U=x.get(D);if(U!=null){if(U<=W)return;let se=v[U].indexOf(D);se>-1&&v[U].splice(se,1),D instanceof S&&u.delete(D.compartment)}if(x.set(D,W),Array.isArray(D))for(let se of D)O(se,W);else if(D instanceof S){if(u.has(D.compartment))throw new RangeError("Duplicate use of compartment in extensions");let se=a.get(D.compartment)||D.inner;u.set(D.compartment,se),O(se,W)}else if(D instanceof Gi)O(D.inner,D.prec);else if(D instanceof zt)v[W].push(D),D.provides&&O(D.provides,W);else if(D instanceof $t)v[W].push(D),D.facet.extensions&&O(D.facet.extensions,yt.default);else{let se=D.extension;if(!se)throw new Error(`Unrecognized extension value in extension set (${D}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);O(se,W)}}return O(R,yt.default),v.reduce((D,W)=>D.concat(W))}function F(R,a){if(a&1)return 2;let u=a>>1,v=R.status[u];if(v==4)throw new Error("Cyclic dependency between fields and/or facets");if(v&2)return v;R.status[u]=4;let x=R.computeSlot(R,R.config.dynamicSlots[u]);return R.status[u]=2|x}function $(R,a){return a&1?R.config.staticValues[a>>1]:R.values[a>>1]}const ee=Me.define(),re=Me.define({combine:R=>R.some(a=>a),static:!0}),we=Me.define({combine:R=>R.length?R[0]:void 0,static:!0}),He=Me.define(),Le=Me.define(),Qe=Me.define(),tt=Me.define({combine:R=>R.length?R[0]:!1});class ft{constructor(a,u){this.type=a,this.value=u}static define(){return new si}}class si{of(a){return new ft(this,a)}}class ei{constructor(a){this.map=a}of(a){return new Kt(this,a)}}class Kt{constructor(a,u){this.type=a,this.value=u}map(a){let u=this.type.map(this.value,a);return u===void 0?void 0:u==this.value?this:new Kt(this.type,u)}is(a){return this.type==a}static define(a={}){return new ei(a.map||(u=>u))}static mapEffects(a,u){if(!a.length)return a;let v=[];for(let x of a){let O=x.map(u);O&&v.push(O)}return v}}Kt.reconfigure=Kt.define(),Kt.appendConfig=Kt.define();class Ut{constructor(a,u,v,x,O,D){this.startState=a,this.changes=u,this.selection=v,this.effects=x,this.annotations=O,this.scrollIntoView=D,this._doc=null,this._state=null,v&&xe(v,u.newLength),O.some(W=>W.type==Ut.time)||(this.annotations=O.concat(Ut.time.of(Date.now())))}static create(a,u,v,x,O,D){return new Ut(a,u,v,x,O,D)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(a){for(let u of this.annotations)if(u.type==a)return u.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(a){let u=this.annotation(Ut.userEvent);return!!(u&&(u==a||u.length>a.length&&u.slice(0,a.length)==a&&u[a.length]=="."))}}Ut.time=ft.define(),Ut.userEvent=ft.define(),Ut.addToHistory=ft.define(),Ut.remote=ft.define();function Mt(R,a){let u=[];for(let v=0,x=0;;){let O,D;if(v<R.length&&(x==a.length||a[x]>=R[v]))O=R[v++],D=R[v++];else if(x<a.length)O=a[x++],D=a[x++];else return u;!u.length||u[u.length-1]<O?u.push(O,D):u[u.length-1]<D&&(u[u.length-1]=D)}}function Ft(R,a,u){var v;let x,O,D;return u?(x=a.changes,O=Pt.empty(a.changes.length),D=R.changes.compose(a.changes)):(x=a.changes.map(R.changes),O=R.changes.mapDesc(a.changes,!0),D=R.changes.compose(x)),{changes:D,selection:a.selection?a.selection.map(O):(v=R.selection)===null||v===void 0?void 0:v.map(x),effects:Kt.mapEffects(R.effects,x).concat(Kt.mapEffects(a.effects,O)),annotations:R.annotations.length?R.annotations.concat(a.annotations):a.annotations,scrollIntoView:R.scrollIntoView||a.scrollIntoView}}function Si(R,a,u){let v=a.selection,x=rt(a.annotations);return a.userEvent&&(x=x.concat(Ut.userEvent.of(a.userEvent))),{changes:a.changes instanceof Pt?a.changes:Pt.of(a.changes||[],u,R.facet(we)),selection:v&&(v instanceof ce?v:ce.single(v.anchor,v.head)),effects:rt(a.effects),annotations:x,scrollIntoView:!!a.scrollIntoView}}function nt(R,a,u){let v=Si(R,a.length?a[0]:{},R.doc.length);a.length&&a[0].filter===!1&&(u=!1);for(let O=1;O<a.length;O++){a[O].filter===!1&&(u=!1);let D=!!a[O].sequential;v=Ft(v,Si(R,a[O],D?v.changes.newLength:R.doc.length),D)}let x=Ut.create(R,v.changes,v.selection,v.effects,v.annotations,v.scrollIntoView);return We(u?Xe(x):x)}function Xe(R){let a=R.startState,u=!0;for(let x of a.facet(He)){let O=x(R);if(O===!1){u=!1;break}Array.isArray(O)&&(u=u===!0?O:Mt(u,O))}if(u!==!0){let x,O;if(u===!1)O=R.changes.invertedDesc,x=Pt.empty(a.doc.length);else{let D=R.changes.filter(u);x=D.changes,O=D.filtered.mapDesc(D.changes).invertedDesc}R=Ut.create(a,x,R.selection&&R.selection.map(O),Kt.mapEffects(R.effects,O),R.annotations,R.scrollIntoView)}let v=a.facet(Le);for(let x=v.length-1;x>=0;x--){let O=v[x](R);O instanceof Ut?R=O:Array.isArray(O)&&O.length==1&&O[0]instanceof Ut?R=O[0]:R=nt(a,rt(O),!1)}return R}function We(R){let a=R.startState,u=a.facet(Qe),v=R;for(let x=u.length-1;x>=0;x--){let O=u[x](R);O&&Object.keys(O).length&&(v=Ft(v,Si(a,O,R.changes.newLength),!0))}return v==R?R:Ut.create(a,R.changes,R.selection,v.effects,v.annotations,v.scrollIntoView)}const Jt=[];function rt(R){return R==null?Jt:Array.isArray(R)?R:[R]}var st=function(R){return R[R.Word=0]="Word",R[R.Space=1]="Space",R[R.Other=2]="Other",R}(st||(st={}));const vt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ot;try{ot=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Gt(R){if(ot)return ot.test(R);for(let a=0;a<R.length;a++){let u=R[a];if(/\w/.test(u)||u>"\x80"&&(u.toUpperCase()!=u.toLowerCase()||vt.test(u)))return!0}return!1}function Ht(R){return a=>{if(!/\S/.test(a))return st.Space;if(Gt(a))return st.Word;for(let u=0;u<R.length;u++)if(a.indexOf(R[u])>-1)return st.Word;return st.Other}}class ut{constructor(a,u,v,x,O,D){this.config=a,this.doc=u,this.selection=v,this.values=x,this.status=a.statusTemplate.slice(),this.computeSlot=O,D&&(D._state=this);for(let W=0;W<this.config.dynamicSlots.length;W++)F(this,W<<1);this.computeSlot=null}field(a,u=!0){let v=this.config.address[a.id];if(v==null){if(u)throw new RangeError("Field is not present in this state");return}return F(this,v),$(this,v)}update(...a){return nt(this,a,!0)}applyTransaction(a){let u=this.config,{base:v,compartments:x}=u;for(let W of a.effects)W.is(te.reconfigure)?(u&&(x=new Map,u.compartments.forEach((U,se)=>x.set(se,U)),u=null),x.set(W.value.compartment,W.value.extension)):W.is(Kt.reconfigure)?(u=null,v=W.value):W.is(Kt.appendConfig)&&(u=null,v=rt(v).concat(W.value));let O;u?O=a.startState.values.slice():(u=A.resolve(v,x,this),O=new ut(u,this.doc,this.selection,u.dynamicSlots.map(()=>null),(U,se)=>se.reconfigure(U,this),null).values);let D=a.startState.facet(re)?a.newSelection:a.newSelection.asSingle();new ut(u,a.newDoc,D,O,(W,U)=>U.update(W,a),a)}replaceSelection(a){return typeof a=="string"&&(a=this.toText(a)),this.changeByRange(u=>({changes:{from:u.from,to:u.to,insert:a},range:ce.cursor(u.from+a.length)}))}changeByRange(a){let u=this.selection,v=a(u.ranges[0]),x=this.changes(v.changes),O=[v.range],D=rt(v.effects);for(let W=1;W<u.ranges.length;W++){let U=a(u.ranges[W]),se=this.changes(U.changes),ue=se.map(x);for(let Re=0;Re<W;Re++)O[Re]=O[Re].map(ue);let ve=x.mapDesc(se,!0);O.push(U.range.map(ve)),x=x.compose(ue),D=Kt.mapEffects(D,ue).concat(Kt.mapEffects(rt(U.effects),ve))}return{changes:x,selection:ce.create(O,u.mainIndex),effects:D}}changes(a=[]){return a instanceof Pt?a:Pt.of(a,this.doc.length,this.facet(ut.lineSeparator))}toText(a){return m.of(a.split(this.facet(ut.lineSeparator)||Li))}sliceDoc(a=0,u=this.doc.length){return this.doc.sliceString(a,u,this.lineBreak)}facet(a){let u=this.config.address[a.id];return u==null?a.default:(F(this,u),$(this,u))}toJSON(a){let u={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(a)for(let v in a){let x=a[v];x instanceof zt&&this.config.address[x.id]!=null&&(u[v]=x.spec.toJSON(this.field(a[v]),this))}return u}static fromJSON(a,u={},v){if(!a||typeof a.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let x=[];if(v){for(let O in v)if(Object.prototype.hasOwnProperty.call(a,O)){let D=v[O],W=a[O];x.push(D.init(U=>D.spec.fromJSON(W,U)))}}return ut.create({doc:a.doc,selection:ce.fromJSON(a.selection),extensions:u.extensions?x.concat([u.extensions]):x})}static create(a={}){let u=A.resolve(a.extensions||[],new Map),v=a.doc instanceof m?a.doc:m.of((a.doc||"").split(u.staticFacet(ut.lineSeparator)||Li)),x=a.selection?a.selection instanceof ce?a.selection:ce.single(a.selection.anchor,a.selection.head):ce.single(0);return xe(x,v.length),u.staticFacet(re)||(x=x.asSingle()),new ut(u,v,x,u.dynamicSlots.map(()=>null),(O,D)=>D.create(O),null)}get tabSize(){return this.facet(ut.tabSize)}get lineBreak(){return this.facet(ut.lineSeparator)||`
`}get readOnly(){return this.facet(tt)}phrase(a,...u){for(let v of this.facet(ut.phrases))if(Object.prototype.hasOwnProperty.call(v,a)){a=v[a];break}return u.length&&(a=a.replace(/\$(\$|\d*)/g,(v,x)=>{if(x=="$")return"$";let O=+(x||1);return!O||O>u.length?v:u[O-1]})),a}languageDataAt(a,u,v=-1){let x=[];for(let O of this.facet(ee))for(let D of O(this,u,v))Object.prototype.hasOwnProperty.call(D,a)&&x.push(D[a]);return x}charCategorizer(a){return Ht(this.languageDataAt("wordChars",a).join(""))}wordAt(a){let{text:u,from:v,length:x}=this.doc.lineAt(a),O=this.charCategorizer(a),D=a-v,W=a-v;for(;D>0;){let U=Zt(u,D,!1);if(O(u.slice(U,D))!=st.Word)break;D=U}for(;W<x;){let U=Zt(u,W);if(O(u.slice(W,U))!=st.Word)break;W=U}return D==W?null:ce.range(D+v,W+v)}}ut.allowMultipleSelections=re,ut.tabSize=Me.define({combine:R=>R.length?R[0]:4}),ut.lineSeparator=we,ut.readOnly=tt,ut.phrases=Me.define({compare(R,a){let u=Object.keys(R),v=Object.keys(a);return u.length==v.length&&u.every(x=>R[x]==a[x])}}),ut.languageData=ee,ut.changeFilter=He,ut.transactionFilter=Le,ut.transactionExtender=Qe,te.reconfigure=Kt.define();function bt(R,a,u={}){let v={};for(let x of R)for(let O of Object.keys(x)){let D=x[O],W=v[O];if(W===void 0)v[O]=D;else if(!(W===D||D===void 0))if(Object.hasOwnProperty.call(u,O))v[O]=u[O](W,D);else throw new Error("Config merge conflict for field "+O)}for(let x in a)v[x]===void 0&&(v[x]=a[x]);return v}class qt{eq(a){return this==a}range(a,u=a){return pi.create(a,u,this)}}qt.prototype.startSide=qt.prototype.endSide=0,qt.prototype.point=!1,qt.prototype.mapMode=It.TrackDel;class pi{constructor(a,u,v){this.from=a,this.to=u,this.value=v}static create(a,u,v){return new pi(a,u,v)}}function tn(R,a){return R.from-a.from||R.value.startSide-a.value.startSide}class Ni{constructor(a,u,v,x){this.from=a,this.to=u,this.value=v,this.maxPoint=x}get length(){return this.to[this.to.length-1]}findIndex(a,u,v,x=0){let O=v?this.to:this.from;for(let D=x,W=O.length;;){if(D==W)return D;let U=D+W>>1,se=O[U]-a||(v?this.value[U].endSide:this.value[U].startSide)-u;if(U==D)return se>=0?D:W;se>=0?W=U:D=U+1}}between(a,u,v,x){for(let O=this.findIndex(u,-1e9,!0),D=this.findIndex(v,1e9,!1,O);O<D;O++)if(x(this.from[O]+a,this.to[O]+a,this.value[O])===!1)return!1}map(a,u){let v=[],x=[],O=[],D=-1,W=-1;for(let U=0;U<this.value.length;U++){let se=this.value[U],ue=this.from[U]+a,ve=this.to[U]+a,Re,De;if(ue==ve){let Nt=u.mapPos(ue,se.startSide,se.mapMode);if(Nt==null||(Re=De=Nt,se.startSide!=se.endSide&&(De=u.mapPos(ue,se.endSide),De<Re)))continue}else if(Re=u.mapPos(ue,se.startSide),De=u.mapPos(ve,se.endSide),Re>De||Re==De&&se.startSide>0&&se.endSide<=0)continue;(De-Re||se.endSide-se.startSide)<0||(D<0&&(D=Re),se.point&&(W=Math.max(W,De-Re)),v.push(se),x.push(Re-D),O.push(De-D))}return{mapped:v.length?new Ni(x,O,v,W):null,pos:D}}}class Bt{constructor(a,u,v,x){this.chunkPos=a,this.chunk=u,this.nextLayer=v,this.maxPoint=x}static create(a,u,v,x){return new Bt(a,u,v,x)}get length(){let a=this.chunk.length-1;return a<0?0:Math.max(this.chunkEnd(a),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let a=this.nextLayer.size;for(let u of this.chunk)a+=u.value.length;return a}chunkEnd(a){return this.chunkPos[a]+this.chunk[a].length}update(a){let{add:u=[],sort:v=!1,filterFrom:x=0,filterTo:O=this.length}=a,D=a.filter;if(u.length==0&&!D)return this;if(v&&(u=u.slice().sort(tn)),this.isEmpty)return u.length?Bt.of(u):this;let W=new vn(this,null,-1).goto(0),U=0,se=[],ue=new li;for(;W.value||U<u.length;)if(U<u.length&&(W.from-u[U].from||W.startSide-u[U].value.startSide)>=0){let ve=u[U++];ue.addInner(ve.from,ve.to,ve.value)||se.push(ve)}else W.rangeIndex==1&&W.chunkIndex<this.chunk.length&&(U==u.length||this.chunkEnd(W.chunkIndex)<u[U].from)&&(!D||x>this.chunkEnd(W.chunkIndex)||O<this.chunkPos[W.chunkIndex])&&ue.addChunk(this.chunkPos[W.chunkIndex],this.chunk[W.chunkIndex])?W.nextChunk():((!D||x>W.to||O<W.from||D(W.from,W.to,W.value))&&(ue.addInner(W.from,W.to,W.value)||se.push(pi.create(W.from,W.to,W.value))),W.next());return ue.finishInner(this.nextLayer.isEmpty&&!se.length?Bt.empty:this.nextLayer.update({add:se,filter:D,filterFrom:x,filterTo:O}))}map(a){if(a.empty||this.isEmpty)return this;let u=[],v=[],x=-1;for(let D=0;D<this.chunk.length;D++){let W=this.chunkPos[D],U=this.chunk[D],se=a.touchesRange(W,W+U.length);if(se===!1)x=Math.max(x,U.maxPoint),u.push(U),v.push(a.mapPos(W));else if(se===!0){let{mapped:ue,pos:ve}=U.map(W,a);ue&&(x=Math.max(x,ue.maxPoint),u.push(ue),v.push(ve))}}let O=this.nextLayer.map(a);return u.length==0?O:new Bt(v,u,O||Bt.empty,x)}between(a,u,v){if(!this.isEmpty){for(let x=0;x<this.chunk.length;x++){let O=this.chunkPos[x],D=this.chunk[x];if(u>=O&&a<=O+D.length&&D.between(O,a-O,u-O,v)===!1)return}this.nextLayer.between(a,u,v)}}iter(a=0){return Ii.from([this]).goto(a)}get isEmpty(){return this.nextLayer==this}static iter(a,u=0){return Ii.from(a).goto(u)}static compare(a,u,v,x,O=-1){let D=a.filter(ve=>ve.maxPoint>0||!ve.isEmpty&&ve.maxPoint>=O),W=u.filter(ve=>ve.maxPoint>0||!ve.isEmpty&&ve.maxPoint>=O),U=Zi(D,W,v),se=new Et(D,U,O),ue=new Et(W,U,O);v.iterGaps((ve,Re,De)=>Wn(se,ve,ue,Re,De,x)),v.empty&&v.length==0&&Wn(se,0,ue,0,0,x)}static eq(a,u,v=0,x){x==null&&(x=1e9-1);let O=a.filter(ue=>!ue.isEmpty&&u.indexOf(ue)<0),D=u.filter(ue=>!ue.isEmpty&&a.indexOf(ue)<0);if(O.length!=D.length)return!1;if(!O.length)return!0;let W=Zi(O,D),U=new Et(O,W,0).goto(v),se=new Et(D,W,0).goto(v);for(;;){if(U.to!=se.to||!Pn(U.active,se.active)||U.point&&(!se.point||!U.point.eq(se.point)))return!1;if(U.to>x)return!0;U.next(),se.next()}}static spans(a,u,v,x,O=-1){let D=new Et(a,null,O).goto(u),W=u,U=D.openStart;for(;;){let se=Math.min(D.to,v);if(D.point){let ue=D.activeForPoint(D.to),ve=D.pointFrom<u?ue.length+1:D.point.startSide<0?ue.length:Math.min(ue.length,U);x.point(W,se,D.point,ue,ve,D.pointRank),U=Math.min(D.openEnd(se),ue.length)}else se>W&&(x.span(W,se,D.active,U),U=D.openEnd(se));if(D.to>v)return U+(D.point&&D.to>v?1:0);W=D.to,D.next()}}static of(a,u=!1){let v=new li;for(let x of a instanceof pi?[a]:u?ji(a):a)v.add(x.from,x.to,x.value);return v.finish()}static join(a){if(!a.length)return Bt.empty;let u=a[a.length-1];for(let v=a.length-2;v>=0;v--)for(let x=a[v];x!=Bt.empty;x=x.nextLayer)u=new Bt(x.chunkPos,x.chunk,u,Math.max(x.maxPoint,u.maxPoint));return u}}Bt.empty=new Bt([],[],null,-1);function ji(R){if(R.length>1)for(let a=R[0],u=1;u<R.length;u++){let v=R[u];if(tn(a,v)>0)return R.slice().sort(tn);a=v}return R}Bt.empty.nextLayer=Bt.empty;class li{finishChunk(a){this.chunks.push(new Ni(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,a&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(a,u,v){this.addInner(a,u,v)||(this.nextLayer||(this.nextLayer=new li)).add(a,u,v)}addInner(a,u,v){let x=a-this.lastTo||v.startSide-this.last.endSide;if(x<=0&&(a-this.lastFrom||v.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return x<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=a),this.from.push(a-this.chunkStart),this.to.push(u-this.chunkStart),this.last=v,this.lastFrom=a,this.lastTo=u,this.value.push(v),v.point&&(this.maxPoint=Math.max(this.maxPoint,u-a)),!0)}addChunk(a,u){if((a-this.lastTo||u.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,u.maxPoint),this.chunks.push(u),this.chunkPos.push(a);let v=u.value.length-1;return this.last=u.value[v],this.lastFrom=u.from[v]+a,this.lastTo=u.to[v]+a,!0}finish(){return this.finishInner(Bt.empty)}finishInner(a){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return a;let u=Bt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(a):a,this.setMaxPoint);return this.from=null,u}}function Zi(R,a,u){let v=new Map;for(let O of R)for(let D=0;D<O.chunk.length;D++)O.chunk[D].maxPoint<=0&&v.set(O.chunk[D],O.chunkPos[D]);let x=new Set;for(let O of a)for(let D=0;D<O.chunk.length;D++){let W=v.get(O.chunk[D]);W!=null&&(u?u.mapPos(W):W)==O.chunkPos[D]&&!(u!=null&&u.touchesRange(W,W+O.chunk[D].length))&&x.add(O.chunk[D])}return x}class vn{constructor(a,u,v,x=0){this.layer=a,this.skip=u,this.minPoint=v,this.rank=x}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(a,u=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(a,u,!1),this}gotoInner(a,u,v){for(;this.chunkIndex<this.layer.chunk.length;){let x=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(x)||this.layer.chunkEnd(this.chunkIndex)<a||x.maxPoint<this.minPoint))break;this.chunkIndex++,v=!1}if(this.chunkIndex<this.layer.chunk.length){let x=this.layer.chunk[this.chunkIndex].findIndex(a-this.layer.chunkPos[this.chunkIndex],u,!0);(!v||this.rangeIndex<x)&&this.setRangeIndex(x)}this.next()}forward(a,u){(this.to-a||this.endSide-u)<0&&this.gotoInner(a,u,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let a=this.layer.chunkPos[this.chunkIndex],u=this.layer.chunk[this.chunkIndex],v=a+u.from[this.rangeIndex];if(this.from=v,this.to=a+u.to[this.rangeIndex],this.value=u.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(a){if(a==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=a}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(a){return this.from-a.from||this.startSide-a.startSide||this.rank-a.rank||this.to-a.to||this.endSide-a.endSide}}class Ii{constructor(a){this.heap=a}static from(a,u=null,v=-1){let x=[];for(let O=0;O<a.length;O++)for(let D=a[O];!D.isEmpty;D=D.nextLayer)D.maxPoint>=v&&x.push(new vn(D,u,v,O));return x.length==1?x[0]:new Ii(x)}get startSide(){return this.value?this.value.startSide:0}goto(a,u=-1e9){for(let v of this.heap)v.goto(a,u);for(let v=this.heap.length>>1;v>=0;v--)Oi(this.heap,v);return this.next(),this}forward(a,u){for(let v of this.heap)v.forward(a,u);for(let v=this.heap.length>>1;v>=0;v--)Oi(this.heap,v);(this.to-a||this.value.endSide-u)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let a=this.heap[0];this.from=a.from,this.to=a.to,this.value=a.value,this.rank=a.rank,a.value&&a.next(),Oi(this.heap,0)}}}function Oi(R,a){for(let u=R[a];;){let v=(a<<1)+1;if(v>=R.length)break;let x=R[v];if(v+1<R.length&&x.compare(R[v+1])>=0&&(x=R[v+1],v++),u.compare(x)<0)break;R[v]=u,R[a]=x,a=v}}class Et{constructor(a,u,v){this.minPoint=v,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Ii.from(a,u,v)}goto(a,u=-1e9){return this.cursor.goto(a,u),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=a,this.endSide=u,this.openStart=-1,this.next(),this}forward(a,u){for(;this.minActive>-1&&(this.activeTo[this.minActive]-a||this.active[this.minActive].endSide-u)<0;)this.removeActive(this.minActive);this.cursor.forward(a,u)}removeActive(a){qn(this.active,a),qn(this.activeTo,a),qn(this.activeRank,a),this.minActive=bn(this.active,this.activeTo)}addActive(a){let u=0,{value:v,to:x,rank:O}=this.cursor;for(;u<this.activeRank.length&&(O-this.activeRank[u]||x-this.activeTo[u])>0;)u++;Sn(this.active,u,v),Sn(this.activeTo,u,x),Sn(this.activeRank,u,O),a&&Sn(a,u,this.cursor.from),this.minActive=bn(this.active,this.activeTo)}next(){let a=this.to,u=this.point;this.point=null;let v=this.openStart<0?[]:null;for(;;){let x=this.minActive;if(x>-1&&(this.activeTo[x]-this.cursor.from||this.active[x].endSide-this.cursor.startSide)<0){if(this.activeTo[x]>a){this.to=this.activeTo[x],this.endSide=this.active[x].endSide;break}this.removeActive(x),v&&qn(v,x)}else if(this.cursor.value)if(this.cursor.from>a){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let O=this.cursor.value;if(!O.point)this.addActive(v),this.cursor.next();else if(u&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=O,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=O.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(v){this.openStart=0;for(let x=v.length-1;x>=0&&v[x]<a;x--)this.openStart++}}activeForPoint(a){if(!this.active.length)return this.active;let u=[];for(let v=this.active.length-1;v>=0&&!(this.activeRank[v]<this.pointRank);v--)(this.activeTo[v]>a||this.activeTo[v]==a&&this.active[v].endSide>=this.point.endSide)&&u.push(this.active[v]);return u.reverse()}openEnd(a){let u=0;for(let v=this.activeTo.length-1;v>=0&&this.activeTo[v]>a;v--)u++;return u}}function Wn(R,a,u,v,x,O){R.goto(a),u.goto(v);let D=v+x,W=v,U=v-a;for(;;){let se=R.to+U-u.to||R.endSide-u.endSide,ue=se<0?R.to+U:u.to,ve=Math.min(ue,D);if(R.point||u.point?R.point&&u.point&&(R.point==u.point||R.point.eq(u.point))&&Pn(R.activeForPoint(R.to),u.activeForPoint(u.to))||O.comparePoint(W,ve,R.point,u.point):ve>W&&!Pn(R.active,u.active)&&O.compareRange(W,ve,R.active,u.active),ue>D)break;W=ue,se<=0&&R.next(),se>=0&&u.next()}}function Pn(R,a){if(R.length!=a.length)return!1;for(let u=0;u<R.length;u++)if(R[u]!=a[u]&&!R[u].eq(a[u]))return!1;return!0}function qn(R,a){for(let u=a,v=R.length-1;u<v;u++)R[u]=R[u+1];R.pop()}function Sn(R,a,u){for(let v=R.length-1;v>=a;v--)R[v+1]=R[v];R[a]=u}function bn(R,a){let u=-1,v=1e9;for(let x=0;x<a.length;x++)(a[x]-v||R[x].endSide-R[u].endSide)<0&&(u=x,v=a[x]);return u}function Ls(R,a,u=R.length){let v=0;for(let x=0;x<u;)R.charCodeAt(x)==9?(v+=a-v%a,x++):(v++,x=Zt(R,x));return v}function us(R,a,u,v){for(let x=0,O=0;;){if(O>=a)return x;if(x==R.length)break;O+=R.charCodeAt(x)==9?u-O%u:1,x=Zt(R,x)}return v===!0?-1:R.length}},83173:(yn,Wt,q)=>{q.d(Wt,{NZ:()=>Xe,OP:()=>bt,Lz:()=>Rt,wJ:()=>hs,Z9:()=>Ai,xO:()=>Si,HJ:()=>tl,VH:()=>xi,A:()=>Vs,ld:()=>Xr,Eg:()=>Tl,cU:()=>Ho,dz:()=>Ro,Wu:()=>dl,N$:()=>Eo,Ux:()=>El,w4:()=>os,$K:()=>cl,c_:()=>Nt,qf:()=>co,D4:()=>_o,TS:()=>Hs,S7:()=>Io,DK:()=>Yr});for(var m=q(14830),Se=q(98104),he={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},B={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},X=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),Ae=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Fe=0;Fe<10;Fe++)he[48+Fe]=he[96+Fe]=String(Fe);for(var Fe=1;Fe<=24;Fe++)he[Fe+111]="F"+Fe;for(var Fe=65;Fe<=90;Fe++)he[Fe]=String.fromCharCode(Fe+32),B[Fe]=String.fromCharCode(Fe);for(var wt in he)B.hasOwnProperty(wt)||(B[wt]=he[wt]);function ht(o){var e=X&&o.metaKey&&o.shiftKey&&!o.ctrlKey&&!o.altKey||Ae&&o.shiftKey&&o.key&&o.key.length==1||o.key=="Unidentified",t=!e&&o.key||(o.shiftKey?B:he)[o.keyCode]||o.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function xt(o){let e;return o.nodeType==11?e=o.getSelection?o:o.ownerDocument:e=o,e.getSelection()}function Ke(o,e){return e?o==e||o.contains(e.nodeType!=1?e.parentNode:e):!1}function it(o){let e=o.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function _e(o,e){if(!e.anchorNode)return!1;try{return Ke(o,e.anchorNode)}catch{return!1}}function gt(o){return o.nodeType==3?St(o,0,o.nodeValue.length).getClientRects():o.nodeType==1?o.getClientRects():[]}function fi(o,e,t,i){return t?ge(o,e,t,i,-1)||ge(o,e,t,i,1):!1}function Zt(o){for(var e=0;;e++)if(o=o.previousSibling,!o)return e}function ge(o,e,t,i,s){for(;;){if(o==t&&e==i)return!0;if(e==(s<0?0:ct(o))){if(o.nodeName=="DIV")return!1;let h=o.parentNode;if(!h||h.nodeType!=1)return!1;e=Zt(o)+(s<0?0:1),o=h}else if(o.nodeType==1){if(o=o.childNodes[e+(s<0?-1:0)],o.nodeType==1&&o.contentEditable=="false")return!1;e=s<0?ct(o):0}else return!1}}function ct(o){return o.nodeType==3?o.nodeValue.length:o.childNodes.length}function Yt(o,e){let t=e?o.left:o.right;return{left:t,right:t,top:o.top,bottom:o.bottom}}function wi(o){return{left:0,right:o.innerWidth,top:0,bottom:o.innerHeight}}function ui(o,e){let t=e.width/o.offsetWidth,i=e.height/o.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-o.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-o.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function Dt(o,e,t,i,s,h,d,y){let b=o.ownerDocument,M=b.defaultView||window;for(let C=o,H=!1;C&&!H;)if(C.nodeType==1){let j,J=C==b.body,_=1,ae=1;if(J)j=wi(M);else{if(/^(fixed|sticky)$/.test(getComputedStyle(C).position)&&(H=!0),C.scrollHeight<=C.clientHeight&&C.scrollWidth<=C.clientWidth){C=C.assignedSlot||C.parentNode;continue}let $e=C.getBoundingClientRect();({scaleX:_,scaleY:ae}=ui(C,$e)),j={left:$e.left,right:$e.left+C.clientWidth*_,top:$e.top,bottom:$e.top+C.clientHeight*ae}}let ne=0,de=0;if(s=="nearest")e.top<j.top?(de=-(j.top-e.top+d),t>0&&e.bottom>j.bottom+de&&(de=e.bottom-j.bottom+de+d)):e.bottom>j.bottom&&(de=e.bottom-j.bottom+d,t<0&&e.top-de<j.top&&(de=-(j.top+de-e.top+d)));else{let $e=e.bottom-e.top,pt=j.bottom-j.top;de=(s=="center"&&$e<=pt?e.top+$e/2-pt/2:s=="start"||s=="center"&&t<0?e.top-d:e.bottom-pt+d)-j.top}if(i=="nearest"?e.left<j.left?(ne=-(j.left-e.left+h),t>0&&e.right>j.right+ne&&(ne=e.right-j.right+ne+h)):e.right>j.right&&(ne=e.right-j.right+h,t<0&&e.left<j.left+ne&&(ne=-(j.left+ne-e.left+h))):ne=(i=="center"?e.left+(e.right-e.left)/2-(j.right-j.left)/2:i=="start"==y?e.left-h:e.right-(j.right-j.left)+h)-j.left,ne||de)if(J)M.scrollBy(ne,de);else{let $e=0,pt=0;if(de){let Ge=C.scrollTop;C.scrollTop+=de/ae,pt=(C.scrollTop-Ge)*ae}if(ne){let Ge=C.scrollLeft;C.scrollLeft+=ne/_,$e=(C.scrollLeft-Ge)*_}e={left:e.left-$e,top:e.top-pt,right:e.right-$e,bottom:e.bottom-pt},$e&&Math.abs($e-ne)<1&&(i="nearest"),pt&&Math.abs(pt-de)<1&&(s="nearest")}if(J)break;C=C.assignedSlot||C.parentNode}else if(C.nodeType==11)C=C.host;else break}function di(o){let e=o.ownerDocument;for(let t=o.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}class Li{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?ct(t):0),i,Math.min(e.focusOffset,i?ct(i):0))}set(e,t,i,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=s}}let It=null;function Lt(o){if(o.setActive)return o.setActive();if(It)return o.focus(It);let e=[];for(let t=o;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(o.focus(It==null?{get preventScroll(){return It={preventScroll:!0},!0}}:void 0),!It){It=!1;for(let t=0;t<e.length;){let i=e[t++],s=e[t++],h=e[t++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=h&&(i.scrollLeft=h)}}}let Pt;function St(o,e,t=e){let i=Pt||(Pt=document.createRange());return i.setEnd(o,t),i.setStart(o,e),i}function ci(o,e,t){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0},s=new KeyboardEvent("keydown",i);s.synthetic=!0,o.dispatchEvent(s);let h=new KeyboardEvent("keyup",i);return h.synthetic=!0,o.dispatchEvent(h),s.defaultPrevented||h.defaultPrevented}function ii(o){for(;o;){if(o&&(o.nodeType==9||o.nodeType==11&&o.host))return o;o=o.assignedSlot||o.parentNode}return null}function ni(o){for(;o.attributes.length;)o.removeAttributeNode(o.attributes[0])}function Ye(o,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,ct(t));;)if(i){if(t.nodeType!=1)return!1;let s=t.childNodes[i-1];s.contentEditable=="false"?i--:(t=s,i=ct(t))}else{if(t==o)return!0;i=Zt(t),t=t.parentNode}}function Ti(o){return o.scrollTop>Math.max(1,o.scrollHeight-o.clientHeight-4)}class Je{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new Je(e.parentNode,Zt(e),t)}static after(e,t){return new Je(e.parentNode,Zt(e)+1,t)}}const ce=[];class xe{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let i=this.dom,s=null,h;for(let d of this.children){if(d.flags&7){if(!d.dom&&(h=s?s.nextSibling:i.firstChild)){let y=xe.get(h);(!y||!y.parent&&y.canReuseDOM(d))&&d.reuseDOM(h)}d.sync(e,t),d.flags&=-8}if(h=s?s.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&h!=d.dom&&(t.written=!0),d.dom.parentNode==i)for(;h&&h!=d.dom;)h=ze(h);else i.insertBefore(d.dom,h);s=d.dom}for(h=s?s.nextSibling:i.firstChild,h&&t&&t.node==i&&(t.written=!0);h;)h=ze(h)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,t),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let s=ct(e)==0?0:t==0?-1:1;for(;;){let h=e.parentNode;if(h==this.dom)break;s==0&&h.firstChild!=h.lastChild&&(e==h.firstChild?s=-1:s=1),e=h}s<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!xe.get(i);)i=i.nextSibling;if(!i)return this.length;for(let s=0,h=0;;s++){let d=this.children[s];if(d.dom==i)return h;h+=d.length+d.breakAfter}}domBoundsAround(e,t,i=0){let s=-1,h=-1,d=-1,y=-1;for(let b=0,M=i,C=i;b<this.children.length;b++){let H=this.children[b],j=M+H.length;if(M<e&&j>t)return H.domBoundsAround(e,t,M);if(j>=e&&s==-1&&(s=b,h=M),M>t&&H.dom.parentNode==this.dom){d=b,y=C;break}C=j,M=j+H.breakAfter}return{from:h,to:y<0?i+this.length:y,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:d<this.children.length&&d>=0?this.children[d].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=ce){this.markDirty();for(let s=e;s<t;s++){let h=this.children[s];h.parent==this&&i.indexOf(h)<0&&h.destroy()}this.children.splice(e,t-e,...i);for(let s=0;s<i.length;s++)i[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Me(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,i,s,h,d){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}xe.prototype.breakAfter=0;function ze(o){let e=o.nextSibling;return o.parentNode.removeChild(o),e}class Me{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Oe(o,e,t,i,s,h,d,y,b){let{children:M}=o,C=M.length?M[e]:null,H=h.length?h[h.length-1]:null,j=H?H.breakAfter:d;if(!(e==i&&C&&!d&&!j&&h.length<2&&C.merge(t,s,h.length?H:null,t==0,y,b))){if(i<M.length){let J=M[i];J&&(s<J.length||J.breakAfter&&(H!=null&&H.breakAfter))?(e==i&&(J=J.split(s),s=0),!j&&H&&J.merge(0,s,H,!0,0,b)?h[h.length-1]=J:((s||J.children.length&&!J.children[0].length)&&J.merge(0,s,null,!1,0,b),h.push(J))):J!=null&&J.breakAfter&&(H?H.breakAfter=1:d=1),i++}for(C&&(C.breakAfter=d,t>0&&(!d&&h.length&&C.merge(t,C.length,h[0],!1,y,0)?C.breakAfter=h.shift().breakAfter:(t<C.length||C.children.length&&C.children[C.children.length-1].length==0)&&C.merge(t,C.length,null,!1,y,0),e++));e<i&&h.length;)if(M[i-1].become(h[h.length-1]))i--,h.pop(),b=h.length?0:y;else if(M[e].become(h[0]))e++,h.shift(),y=h.length?0:b;else break;!h.length&&e&&i<M.length&&!M[e-1].breakAfter&&M[i].merge(0,0,M[e-1],!1,y,b)&&e--,(e<i||h.length)&&o.replaceChildren(e,i,h)}}function $t(o,e,t,i,s,h){let d=o.childCursor(),{i:y,off:b}=d.findPos(t,1),{i:M,off:C}=d.findPos(e,-1),H=e-t;for(let j of i)H+=j.length;o.length+=H,Oe(o,M,C,y,b,i,0,s,h)}let Ne=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},_t=typeof document!="undefined"?document:{documentElement:{style:{}}};const et=/Edge\/(\d+)/.exec(Ne.userAgent),Bi=/MSIE \d/.test(Ne.userAgent),zt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ne.userAgent),yt=!!(Bi||zt||et),oi=!yt&&/gecko\/(\d+)/i.test(Ne.userAgent),en=!yt&&/Chrome\/(\d+)/.exec(Ne.userAgent),Gi="webkitFontSmoothing"in _t.documentElement.style,te=!yt&&/Apple Computer/.test(Ne.vendor),S=te&&(/Mobile\/\w+/.test(Ne.userAgent)||Ne.maxTouchPoints>2);var A={mac:S||/Mac/.test(Ne.platform),windows:/Win/.test(Ne.platform),linux:/Linux|X11/.test(Ne.platform),ie:yt,ie_version:Bi?_t.documentMode||6:zt?+zt[1]:et?+et[1]:0,gecko:oi,gecko_version:oi?+(/Firefox\/(\d+)/.exec(Ne.userAgent)||[0,0])[1]:0,chrome:!!en,chrome_version:en?+en[1]:0,ios:S,android:/Android\b/.test(Ne.userAgent),webkit:Gi,safari:te,webkit_version:Gi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:_t.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const I=256;class F extends xe{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return this.flags&8||i&&(!(i instanceof F)||this.length-(t-e)+i.length>I||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new F(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Je(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return ee(this.dom,e,t)}}class $ extends xe{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let s of t)s.setParent(this)}setAttrs(e){if(ni(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,i,s,h,d){return i&&(!(i instanceof $&&i.mark.eq(this.mark))||e&&h<=0||t<this.length&&d<=0)?!1:($t(this,e,t,i?i.children.slice():[],h-1,d-1),this.markDirty(),!0)}split(e){let t=[],i=0,s=-1,h=0;for(let y of this.children){let b=i+y.length;b>e&&t.push(i<e?y.split(e-i):y),s<0&&i>=e&&(s=h),i=b,h++}let d=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new $(this.mark,t,d)}domAtPos(e){return He(this,e)}coordsAt(e,t){return Qe(this,e,t)}}function ee(o,e,t){let i=o.nodeValue.length;e>i&&(e=i);let s=e,h=e,d=0;e==0&&t<0||e==i&&t>=0?A.chrome||A.gecko||(e?(s--,d=1):h<i&&(h++,d=-1)):t<0?s--:h<i&&h++;let y=St(o,s,h).getClientRects();if(!y.length)return null;let b=y[(d?d<0:t>=0)?0:y.length-1];return A.safari&&!d&&b.width==0&&(b=Array.prototype.find.call(y,M=>M.width)||b),d?Yt(b,d<0):b||null}class re extends xe{static create(e,t,i){return new re(e,t,i)}constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}split(e){let t=re.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,i,s,h,d){return i&&(!(i instanceof re)||!this.widget.compare(i.widget)||e>0&&h<=0||t<this.length&&d<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e instanceof re&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return m.EY.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,i=t&&t.state.doc,s=this.posAtStart;return i?i.slice(s,s+this.length):m.EY.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Je.before(this.dom):Je.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;let s=this.dom.getClientRects(),h=null;if(!s.length)return null;let d=this.side?this.side<0:e>0;for(let y=d?s.length-1:0;h=s[y],!(e>0?y==0:y==s.length-1||h.top<h.bottom);y+=d?-1:1);return Yt(h,!d)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class we extends xe{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof we&&e.side==this.side}split(){return new we(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Je.before(this.dom):Je.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return m.EY.empty}get isHidden(){return!0}}F.prototype.children=re.prototype.children=we.prototype.children=ce;function He(o,e){let t=o.dom,{children:i}=o,s=0;for(let h=0;s<i.length;s++){let d=i[s],y=h+d.length;if(!(y==h&&d.getSide()<=0)){if(e>h&&e<y&&d.dom.parentNode==t)return d.domAtPos(e-h);if(e<=h)break;h=y}}for(let h=s;h>0;h--){let d=i[h-1];if(d.dom.parentNode==t)return d.domAtPos(d.length)}for(let h=s;h<i.length;h++){let d=i[h];if(d.dom.parentNode==t)return d.domAtPos(0)}return new Je(t,0)}function Le(o,e,t){let i,{children:s}=o;t>0&&e instanceof $&&s.length&&(i=s[s.length-1])instanceof $&&i.mark.eq(e.mark)?Le(i,e.children[0],t-1):(s.push(e),e.setParent(o)),o.length+=e.length}function Qe(o,e,t){let i=null,s=-1,h=null,d=-1;function y(M,C){for(let H=0,j=0;H<M.children.length&&j<=C;H++){let J=M.children[H],_=j+J.length;_>=C&&(J.children.length?y(J,C-j):(!h||h.isHidden&&t>0)&&(_>C||j==_&&J.getSide()>0)?(h=J,d=C-j):(j<C||j==_&&J.getSide()<0&&!J.isHidden)&&(i=J,s=C-j)),j=_}}y(o,e);let b=(t<0?i:h)||i||h;return b?b.coordsAt(Math.max(0,b==i?s:d),t):tt(o)}function tt(o){let e=o.dom.lastChild;if(!e)return o.dom.getBoundingClientRect();let t=gt(e);return t[t.length-1]||null}function ft(o,e){for(let t in o)t=="class"&&e.class?e.class+=" "+o.class:t=="style"&&e.style?e.style+=";"+o.style:e[t]=o[t];return e}const si=Object.create(null);function ei(o,e,t){if(o==e)return!0;o||(o=si),e||(e=si);let i=Object.keys(o),s=Object.keys(e);if(i.length-(t&&i.indexOf(t)>-1?1:0)!=s.length-(t&&s.indexOf(t)>-1?1:0))return!1;for(let h of i)if(h!=t&&(s.indexOf(h)==-1||o[h]!==e[h]))return!1;return!0}function Kt(o,e,t){let i=!1;if(e)for(let s in e)t&&s in t||(i=!0,s=="style"?o.style.cssText="":o.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(i=!0,s=="style"?o.style.cssText=t[s]:o.setAttribute(s,t[s]));return i}function Ut(o){let e=Object.create(null);for(let t=0;t<o.attributes.length;t++){let i=o.attributes[t];e[i.name]=i.value}return e}class Mt extends xe{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,s,h,d){if(i){if(!(i instanceof Mt))return!1;this.dom||i.transferDOM(this)}return s&&this.setDeco(i?i.attrs:null),$t(this,e,t,i?i.children.slice():[],h,d),!0}split(e){let t=new Mt;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:s}=this.childPos(e);s&&(t.append(this.children[i].split(s),0),this.children[i].merge(s,this.children[i].length,null,!1,0,0),i++);for(let h=i;h<this.children.length;h++)t.append(this.children[h],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){ei(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Le(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=ft(t,this.attrs||{})),i&&(this.attrs=ft({class:i},this.attrs||{}))}domAtPos(e){return He(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var i;this.dom?this.flags&4&&(ni(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Kt(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let s=this.dom.lastChild;for(;s&&xe.get(s)instanceof $;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((i=xe.get(s))===null||i===void 0?void 0:i.isEditable)==!1&&(!A.ios||!this.children.some(h=>h instanceof F))){let h=document.createElement("BR");h.cmIgnore=!0,this.dom.appendChild(h)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let i of this.children){if(!(i instanceof F)||/[^ -~]/.test(i.text))return null;let s=gt(i.dom);if(s.length!=1)return null;e+=s[0].width,t=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let i=Qe(this,e,t);if(!this.children.length&&i&&this.parent){let{heightOracle:s}=this.parent.view.viewState,h=i.bottom-i.top;if(Math.abs(h-s.lineHeight)<2&&s.textHeight<h){let d=(h-s.textHeight)/2;return{top:i.top+d,bottom:i.bottom-d,left:i.left,right:i.left}}}return i}become(e){return!1}covers(){return!0}static find(e,t){for(let i=0,s=0;i<e.children.length;i++){let h=e.children[i],d=s+h.length;if(d>=t){if(h instanceof Mt)return h;if(d>t)break}s=d+h.breakAfter}return null}}class Ft extends xe{constructor(e,t,i){super(),this.widget=e,this.length=t,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,s,h,d){return i&&(!(i instanceof Ft)||!this.widget.compare(i.widget)||e>0&&h<=0||t<this.length&&d<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Je.before(this.dom):Je.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new Ft(this.widget,t,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return ce}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):m.EY.empty}domBoundsAround(){return null}become(e){return e instanceof Ft&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:i}=this.deco;return t==i?!1:e<0?t<0:i>0}}class Si{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var nt=function(o){return o[o.Text=0]="Text",o[o.WidgetBefore=1]="WidgetBefore",o[o.WidgetAfter=2]="WidgetAfter",o[o.WidgetRange=3]="WidgetRange",o}(nt||(nt={}));class Xe extends m.FB{constructor(e,t,i,s){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new We(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new rt(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:h,end:d}=st(e,t);i=(h?t?-3e8:-1:5e8)-1,s=(d?t?2e8:1:-6e8)+1}return new rt(e,i,s,t,e.widget||null,!0)}static line(e){return new Jt(e)}static set(e,t=!1){return m.om.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Xe.none=m.om.empty;class We extends Xe{constructor(e){let{start:t,end:i}=st(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,i;return this==e||e instanceof We&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&ei(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}We.prototype.point=!1;class Jt extends Xe{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Jt&&this.spec.class==e.spec.class&&ei(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Jt.prototype.mapMode=m.iR.TrackBefore,Jt.prototype.point=!0;class rt extends Xe{constructor(e,t,i,s,h,d){super(t,i,h,e),this.block=s,this.isReplace=d,this.mapMode=s?t<=0?m.iR.TrackBefore:m.iR.TrackAfter:m.iR.TrackDel}get type(){return this.startSide!=this.endSide?nt.WidgetRange:this.startSide<=0?nt.WidgetBefore:nt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof rt&&vt(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}rt.prototype.point=!0;function st(o,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=o;return t==null&&(t=o.inclusive),i==null&&(i=o.inclusive),{start:t!=null?t:e,end:i!=null?i:e}}function vt(o,e){return o==e||!!(o&&e&&o.compare(e))}function ot(o,e,t,i=0){let s=t.length-1;s>=0&&t[s]+i>=o?t[s]=Math.max(t[s],e):t.push(o,e)}class Gt{constructor(e,t,i,s){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Ft&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Mt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Ht(new we(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Ft)&&this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:h,lineBreak:d,done:y}=this.cursor.next(this.skip);if(this.skip=0,y)throw new Error("Ran out of text content when drawing inline views");if(d){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=h,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-i)),this.getLine().append(Ht(new F(this.text.slice(this.textOff,this.textOff+s)),t),i),this.atCursorPos=!0,this.textOff+=s,e-=s,i=0}}span(e,t,i,s){this.buildText(t-e,i,s),this.pos=t,this.openStart<0&&(this.openStart=s)}point(e,t,i,s,h,d){if(this.disallowBlockEffectsFor[d]&&i instanceof rt){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let y=t-e;if(i instanceof rt)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Ft(i.widget||new ut("div"),y,i));else{let b=re.create(i.widget||new ut("span"),y,y?0:i.startSide),M=this.atCursorPos&&!b.isEditable&&h<=s.length&&(e<t||i.startSide>0),C=!b.isEditable&&(e<t||h>s.length||i.startSide<=0),H=this.getLine();this.pendingBuffer==2&&!M&&!b.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),M&&(H.append(Ht(new we(1),s),h),h=s.length+Math.max(0,h-s.length)),H.append(Ht(b,s),h),this.atCursorPos=C,this.pendingBuffer=C?e<t||h>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);y&&(this.textOff+y<=this.text.length?this.textOff+=y:(this.skip+=y-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=h)}static build(e,t,i,s,h){let d=new Gt(e,t,i,h);return d.openEnd=m.om.spans(s,t,i,d),d.openStart<0&&(d.openStart=d.openEnd),d.finish(d.openEnd),d}}function Ht(o,e){for(let t of e)o=new $(t,[o],o.length);return o}class ut extends Si{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}var bt=function(o){return o[o.LTR=0]="LTR",o[o.RTL=1]="RTL",o}(bt||(bt={}));const qt=bt.LTR,pi=bt.RTL;function tn(o){let e=[];for(let t=0;t<o.length;t++)e.push(1<<+o[t]);return e}const Ni=tn("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Bt=tn("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),ji=Object.create(null),li=[];for(let o of["()","[]","{}"]){let e=o.charCodeAt(0),t=o.charCodeAt(1);ji[e]=t,ji[t]=-e}function Zi(o){return o<=247?Ni[o]:1424<=o&&o<=1524?2:1536<=o&&o<=1785?Bt[o-1536]:1774<=o&&o<=2220?4:8192<=o&&o<=8204?256:64336<=o&&o<=65023?4:1}const vn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ii{get dir(){return this.level%2?pi:qt}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,s){let h=-1;for(let d=0;d<e.length;d++){let y=e[d];if(y.from<=t&&y.to>=t){if(y.level==i)return d;(h<0||(s!=0?s<0?y.from<t:y.to>t:e[h].level>y.level))&&(h=d)}}if(h<0)throw new RangeError("Index out of range");return h}}function Oi(o,e){if(o.length!=e.length)return!1;for(let t=0;t<o.length;t++){let i=o[t],s=e[t];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!Oi(i.inner,s.inner))return!1}return!0}const Et=[];function Wn(o,e,t,i,s){for(let h=0;h<=i.length;h++){let d=h?i[h-1].to:e,y=h<i.length?i[h].from:t,b=h?256:s;for(let M=d,C=b,H=b;M<y;M++){let j=Zi(o.charCodeAt(M));j==512?j=C:j==8&&H==4&&(j=16),Et[M]=j==4?2:j,j&7&&(H=j),C=j}for(let M=d,C=b,H=b;M<y;M++){let j=Et[M];if(j==128)M<y-1&&C==Et[M+1]&&C&24?j=Et[M]=C:Et[M]=256;else if(j==64){let J=M+1;for(;J<y&&Et[J]==64;)J++;let _=M&&C==8||J<t&&Et[J]==8?H==1?1:8:256;for(let ae=M;ae<J;ae++)Et[ae]=_;M=J-1}else j==8&&H==1&&(Et[M]=1);C=j,j&7&&(H=j)}}}function Pn(o,e,t,i,s){let h=s==1?2:1;for(let d=0,y=0,b=0;d<=i.length;d++){let M=d?i[d-1].to:e,C=d<i.length?i[d].from:t;for(let H=M,j,J,_;H<C;H++)if(J=ji[j=o.charCodeAt(H)])if(J<0){for(let ae=y-3;ae>=0;ae-=3)if(li[ae+1]==-J){let ne=li[ae+2],de=ne&2?s:ne&4?ne&1?h:s:0;de&&(Et[H]=Et[li[ae]]=de),y=ae;break}}else{if(li.length==189)break;li[y++]=H,li[y++]=j,li[y++]=b}else if((_=Et[H])==2||_==1){let ae=_==s;b=ae?0:1;for(let ne=y-3;ne>=0;ne-=3){let de=li[ne+2];if(de&2)break;if(ae)li[ne+2]|=2;else{if(de&4)break;li[ne+2]|=4}}}}}function qn(o,e,t,i){for(let s=0,h=i;s<=t.length;s++){let d=s?t[s-1].to:o,y=s<t.length?t[s].from:e;for(let b=d;b<y;){let M=Et[b];if(M==256){let C=b+1;for(;;)if(C==y){if(s==t.length)break;C=t[s++].to,y=s<t.length?t[s].from:e}else if(Et[C]==256)C++;else break;let H=h==1,j=(C<e?Et[C]:i)==1,J=H==j?H?1:2:i;for(let _=C,ae=s,ne=ae?t[ae-1].to:o;_>b;)_==ne&&(_=t[--ae].from,ne=ae?t[ae-1].to:o),Et[--_]=J;b=C}else h=M,b++}}}function Sn(o,e,t,i,s,h,d){let y=i%2?2:1;if(i%2==s%2)for(let b=e,M=0;b<t;){let C=!0,H=!1;if(M==h.length||b<h[M].from){let ae=Et[b];ae!=y&&(C=!1,H=ae==16)}let j=!C&&y==1?[]:null,J=C?i:i+1,_=b;e:for(;;)if(M<h.length&&_==h[M].from){if(H)break e;let ae=h[M];if(!C)for(let ne=ae.to,de=M+1;;){if(ne==t)break e;if(de<h.length&&h[de].from==ne)ne=h[de++].to;else{if(Et[ne]==y)break e;break}}if(M++,j)j.push(ae);else{ae.from>b&&d.push(new Ii(b,ae.from,J));let ne=ae.direction==qt!=!(J%2);bn(o,ne?i+1:i,s,ae.inner,ae.from,ae.to,d),b=ae.to}_=ae.to}else{if(_==t||(C?Et[_]!=y:Et[_]==y))break;_++}j?Sn(o,b,_,i+1,s,j,d):b<_&&d.push(new Ii(b,_,J)),b=_}else for(let b=t,M=h.length;b>e;){let C=!0,H=!1;if(!M||b>h[M-1].to){let ae=Et[b-1];ae!=y&&(C=!1,H=ae==16)}let j=!C&&y==1?[]:null,J=C?i:i+1,_=b;e:for(;;)if(M&&_==h[M-1].to){if(H)break e;let ae=h[--M];if(!C)for(let ne=ae.from,de=M;;){if(ne==e)break e;if(de&&h[de-1].to==ne)ne=h[--de].from;else{if(Et[ne-1]==y)break e;break}}if(j)j.push(ae);else{ae.to<b&&d.push(new Ii(ae.to,b,J));let ne=ae.direction==qt!=!(J%2);bn(o,ne?i+1:i,s,ae.inner,ae.from,ae.to,d),b=ae.from}_=ae.from}else{if(_==e||(C?Et[_-1]!=y:Et[_-1]==y))break;_--}j?Sn(o,_,b,i+1,s,j,d):_<b&&d.push(new Ii(_,b,J)),b=_}}function bn(o,e,t,i,s,h,d){let y=e%2?2:1;Wn(o,s,h,i,y),Pn(o,s,h,i,y),qn(s,h,i,y),Sn(o,s,h,e,t,i,d)}function Ls(o,e,t){if(!o)return[new Ii(0,0,e==pi?1:0)];if(e==qt&&!t.length&&!vn.test(o))return us(o.length);if(t.length)for(;o.length>Et.length;)Et[Et.length]=256;let i=[],s=e==qt?0:1;return bn(o,s,s,t,0,o.length,i),i}function us(o){return[new Ii(0,o,0)]}let R="";function a(o,e,t,i,s){var h;let d=i.head-o.from,y=Ii.find(e,d,(h=i.bidiLevel)!==null&&h!==void 0?h:-1,i.assoc),b=e[y],M=b.side(s,t);if(d==M){let j=y+=s?1:-1;if(j<0||j>=e.length)return null;b=e[y=j],d=b.side(!s,t),M=b.side(s,t)}let C=(0,m.zK)(o.text,d,b.forward(s,t));(C<b.from||C>b.to)&&(C=M),R=o.text.slice(Math.min(d,C),Math.max(d,C));let H=y==(s?e.length-1:0)?null:e[y+(s?1:-1)];return H&&C==M&&H.level+(s?0:1)<b.level?m.OF.cursor(H.side(!s,t)+o.from,H.forward(s,t)?1:-1,H.level):m.OF.cursor(C+o.from,b.forward(s,t)?-1:1,b.level)}function u(o,e,t){for(let i=e;i<t;i++){let s=Zi(o.charCodeAt(i));if(s==1)return qt;if(s==2||s==4)return pi}return qt}const v=m.sj.define(),x=m.sj.define(),O=m.sj.define(),D=m.sj.define(),W=m.sj.define(),U=m.sj.define(),se=m.sj.define(),ue=m.sj.define({combine:o=>o.some(e=>e)}),ve=m.sj.define({combine:o=>o.some(e=>e)});class Re{constructor(e,t="nearest",i="nearest",s=5,h=5,d=!1){this.range=e,this.y=t,this.x=i,this.yMargin=s,this.xMargin=h,this.isSnapshot=d}map(e){return e.empty?this:new Re(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Re(m.OF.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const De=m.Pe.define({map:(o,e)=>o.map(e)});function Nt(o,e,t){let i=o.facet(D);i.length?i[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const $i=m.sj.define({combine:o=>o.length?o[0]:!0});let mi=0;const un=m.sj.define();class Ai{constructor(e,t,i,s,h){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=s,this.extension=h(this)}static define(e,t){const{eventHandlers:i,eventObservers:s,provide:h,decorations:d}=t||{};return new Ai(mi++,e,i,s,y=>{let b=[un.of(y)];return d&&b.push(Rn.of(M=>{let C=M.plugin(y);return C?d(C):Xe.none})),h&&b.push(h(y)),b})}static fromClass(e,t){return Ai.define(i=>new e(i),t)}}class kn{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(Nt(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Nt(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){Nt(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const ds=m.sj.define(),zn=m.sj.define(),Rn=m.sj.define(),Bs=m.sj.define(),ps=m.sj.define(),Ys=m.sj.define();function ms(o,e){let t=o.state.facet(Ys);if(!t.length)return t;let i=t.map(h=>h instanceof Function?h(o):h),s=[];return m.om.spans(i,e.from,e.to,{point(){},span(h,d,y,b){let M=h-e.from,C=d-e.from,H=s;for(let j=y.length-1;j>=0;j--,b--){let J=y[j].spec.bidiIsolate,_;if(J==null&&(J=u(e.text,M,C)),b>0&&H.length&&(_=H[H.length-1]).to==M&&_.direction==J)_.to=C,H=_.inner;else{let ae={from:M,to:C,direction:J,inner:[]};H.push(ae),H=ae.inner}}}}),s}const An=m.sj.define();function Qn(o){let e=0,t=0,i=0,s=0;for(let h of o.state.facet(An)){let d=h(o);d&&(d.left!=null&&(e=Math.max(e,d.left)),d.right!=null&&(t=Math.max(t,d.right)),d.top!=null&&(i=Math.max(i,d.top)),d.bottom!=null&&(s=Math.max(s,d.bottom)))}return{left:e,right:t,top:i,bottom:s}}const Ln=m.sj.define();class Ki{constructor(e,t,i,s){this.fromA=e,this.toA=t,this.fromB=i,this.toB=s}join(e){return new Ki(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let s=0,h=0,d=0,y=0;;s++){let b=s==e.length?null:e[s],M=d-y,C=b?b.fromB:1e9;for(;h<t.length&&t[h]<C;){let H=t[h],j=t[h+1],J=Math.max(y,H),_=Math.min(C,j);if(J<=_&&new Ki(J+M,_+M,J,_).addToSet(i),j>C)break;h+=2}if(!b)return i;new Ki(b.fromA,b.toA,b.fromB,b.toB).addToSet(i),d=b.toA,y=b.toB}}}class _n{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=m.VR.empty(this.startState.doc.length);for(let h of i)this.changes=this.changes.compose(h.changes);let s=[];this.changes.iterChangedRanges((h,d,y,b)=>s.push(new Ki(h,d,y,b))),this.changedRanges=s}static create(e,t,i){return new _n(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class es extends xe{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Mt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Ki(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:M,toA:C})=>C<this.minWidthFrom||M>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let s=-1;this.view.inputState.composing>=0&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!N(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let h=s>-1?Tr(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:M,to:C}=this.hasComposition;i=new Ki(M,C,e.changes.mapPos(M,-1),e.changes.mapPos(C,1)).addToSet(i.slice())}this.hasComposition=h?{from:h.range.fromB,to:h.range.toB}:null,(A.ie||A.chrome)&&!h&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let d=this.decorations,y=this.updateDeco(),b=w(d,y,e.changes);return i=Ki.extendWithRanges(i,b),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,h),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,i);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let d=A.chrome||A.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,d),this.flags&=-8,d&&(d.written||s.selectionRange.focusNode!=d.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(d=>d.flags&=-9);let h=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let d of this.children)d instanceof Ft&&d.widget instanceof Js&&h.push(d.dom);s.updateGaps(h)}updateChildren(e,t,i){let s=i?i.range.addToSet(e.slice()):e,h=this.childCursor(t);for(let d=s.length-1;;d--){let y=d>=0?s[d]:null;if(!y)break;let{fromA:b,toA:M,fromB:C,toB:H}=y,j,J,_,ae;if(i&&i.range.fromB<H&&i.range.toB>C){let Ge=Gt.build(this.view.state.doc,C,i.range.fromB,this.decorations,this.dynamicDecorationMap),mt=Gt.build(this.view.state.doc,i.range.toB,H,this.decorations,this.dynamicDecorationMap);J=Ge.breakAtStart,_=Ge.openStart,ae=mt.openEnd;let Ot=this.compositionView(i);mt.breakAtStart?Ot.breakAfter=1:mt.content.length&&Ot.merge(Ot.length,Ot.length,mt.content[0],!1,mt.openStart,0)&&(Ot.breakAfter=mt.content[0].breakAfter,mt.content.shift()),Ge.content.length&&Ot.merge(0,0,Ge.content[Ge.content.length-1],!0,0,Ge.openEnd)&&Ge.content.pop(),j=Ge.content.concat(Ot).concat(mt.content)}else({content:j,breakAtStart:J,openStart:_,openEnd:ae}=Gt.build(this.view.state.doc,C,H,this.decorations,this.dynamicDecorationMap));let{i:ne,off:de}=h.findPos(M,1),{i:$e,off:pt}=h.findPos(b,-1);Oe(this,$e,pt,ne,de,j,J,_,ae)}i&&this.fixCompositionDOM(i)}compositionView(e){let t=new F(e.text.nodeValue);t.flags|=8;for(let{deco:s}of e.marks)t=new $(s,[t],t.length);let i=new Mt;return i.append(t,0),i}fixCompositionDOM(e){let t=(h,d)=>{d.flags|=8|(d.children.some(b=>b.flags&7)?1:0),this.markedForComposition.add(d);let y=xe.get(h);y&&y!=d&&(y.dom=null),d.setDOM(h)},i=this.childPos(e.range.fromB,1),s=this.children[i.i];t(e.line,s);for(let h=e.marks.length-1;h>=-1;h--)i=s.childPos(i.off,1),s=s.children[i.i],t(h>=0?e.marks[h].node:e.text,s)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,s=i==this.dom,h=!s&&_e(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(s||t||h))return;let d=this.forceSelection;this.forceSelection=!1;let y=this.view.state.selection.main,b=this.moveToLine(this.domAtPos(y.anchor)),M=y.empty?b:this.moveToLine(this.domAtPos(y.head));if(A.gecko&&y.empty&&!this.hasComposition&&or(b)){let H=document.createTextNode("");this.view.observer.ignore(()=>b.node.insertBefore(H,b.node.childNodes[b.offset]||null)),b=M=new Je(H,0),d=!0}let C=this.view.observer.selectionRange;(d||!C.focusNode||(!fi(b.node,b.offset,C.anchorNode,C.anchorOffset)||!fi(M.node,M.offset,C.focusNode,C.focusOffset))&&!this.suppressWidgetCursorChange(C,y))&&(this.view.observer.ignore(()=>{A.android&&A.chrome&&this.dom.contains(C.focusNode)&&P(C.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let H=xt(this.view.root);if(H)if(y.empty){if(A.gecko){let j=T(b.node,b.offset);if(j&&j!=3){let J=gs(b.node,b.offset,j==1?1:-1);J&&(b=new Je(J.node,J.offset))}}H.collapse(b.node,b.offset),y.bidiLevel!=null&&H.caretBidiLevel!==void 0&&(H.caretBidiLevel=y.bidiLevel)}else if(H.extend){H.collapse(b.node,b.offset);try{H.extend(M.node,M.offset)}catch{}}else{let j=document.createRange();y.anchor>y.head&&([b,M]=[M,b]),j.setEnd(M.node,M.offset),j.setStart(b.node,b.offset),H.removeAllRanges(),H.addRange(j)}h&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(b,M)),this.impreciseAnchor=b.precise?null:new Je(C.anchorNode,C.anchorOffset),this.impreciseHead=M.precise?null:new Je(C.focusNode,C.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&fi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=xt(e.root),{anchorNode:s,anchorOffset:h}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let d=Mt.find(this,t.head);if(!d)return;let y=d.posAtStart;if(t.head==y||t.head==y+d.length)return;let b=this.coordsAt(t.head,-1),M=this.coordsAt(t.head,1);if(!b||!M||b.bottom>M.top)return;let C=this.domAtPos(t.head+t.assoc);i.collapse(C.node,C.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let H=e.observer.selectionRange;e.docView.posFromDOM(H.anchorNode,H.anchorOffset)!=t.from&&i.collapse(s,h)}moveToLine(e){let t=this.dom,i;if(e.node!=t)return e;for(let s=e.offset;!i&&s<t.childNodes.length;s++){let h=xe.get(t.childNodes[s]);h instanceof Mt&&(i=h.domAtPos(0))}for(let s=e.offset-1;!i&&s>=0;s--){let h=xe.get(t.childNodes[s]);h instanceof Mt&&(i=h.domAtPos(h.length))}return i?new Je(i.node,i.offset,!0):e}nearest(e){for(let t=e;t;){let i=xe.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let s=this.children[t];if(i<s.length||s instanceof Mt)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){let i=null,s=0;for(let h=this.length,d=this.children.length-1;d>=0;d--){let y=this.children[d],b=h-y.breakAfter,M=b-y.length;if(b<e)break;M<=e&&(M<e||y.covers(-1))&&(b>e||y.covers(1))&&(!i||y instanceof Mt&&!(i instanceof Mt&&t>=0))&&(i=y,s=M),h=M}return i?i.coordsAt(e-s,t):null}coordsForChar(e){let{i:t,off:i}=this.childPos(e,1),s=this.children[t];if(!(s instanceof Mt))return null;for(;s.children.length;){let{i:y,off:b}=s.childPos(i,1);for(;;y++){if(y==s.children.length)return null;if((s=s.children[y]).length)break}i=b}if(!(s instanceof F))return null;let h=(0,m.zK)(s.text,i);if(h==i)return null;let d=St(s.dom,i,h).getClientRects();for(let y=0;y<d.length;y++){let b=d[y];if(y==d.length-1||b.top<b.bottom&&b.left<b.right)return b}return null}measureVisibleLineHeights(e){let t=[],{from:i,to:s}=e,h=this.view.contentDOM.clientWidth,d=h>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,y=-1,b=this.view.textDirection==bt.LTR;for(let M=0,C=0;C<this.children.length;C++){let H=this.children[C],j=M+H.length;if(j>s)break;if(M>=i){let J=H.dom.getBoundingClientRect();if(t.push(J.height),d){let _=H.dom.lastChild,ae=_?gt(_):[];if(ae.length){let ne=ae[ae.length-1],de=b?ne.right-J.left:J.right-ne.left;de>y&&(y=de,this.minWidth=h,this.minWidthFrom=M,this.minWidthTo=j)}}}M=j+H.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?bt.RTL:bt.LTR}measureTextSize(){for(let h of this.children)if(h instanceof Mt){let d=h.measureTextSize();if(d)return d}let e=document.createElement("div"),t,i,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let h=gt(e.firstChild)[0];t=e.getBoundingClientRect().height,i=h?h.width/27:7,s=h?h.height:t,e.remove()}),{lineHeight:t,charWidth:i,textHeight:s}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Me(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,s=0;;s++){let h=s==t.viewports.length?null:t.viewports[s],d=h?h.from-1:this.length;if(d>i){let y=(t.lineBlockAt(d).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(Xe.replace({widget:new Js(y),block:!0,inclusive:!0,isBlockGap:!0}).range(i,d))}if(!h)break;i=h.to+1}return Xe.set(e)}updateDeco(){let e=this.view.state.facet(Rn).map((s,h)=>(this.dynamicDecorationMap[h]=typeof s=="function")?s(this.view):s),t=!1,i=this.view.state.facet(Bs).map((s,h)=>{let d=typeof s=="function";return d&&(t=!0),d?s(this.view):s});i.length&&(this.dynamicDecorationMap[e.length]=t,e.push(m.om.join(i)));for(let s=e.length;s<e.length+3;s++)this.dynamicDecorationMap[s]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){if(e.isSnapshot){let M=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=M.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!i)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let h=Qn(this.view),d={left:i.left-h.left,top:i.top-h.top,right:i.right+h.right,bottom:i.bottom+h.bottom},{offsetWidth:y,offsetHeight:b}=this.view.scrollDOM;Dt(this.view.scrollDOM,d,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,y),-y),Math.max(Math.min(e.yMargin,b),-b),this.view.textDirection==bt.LTR)}}function or(o){return o.node.nodeType==1&&o.node.firstChild&&(o.offset==0||o.node.childNodes[o.offset-1].contentEditable=="false")&&(o.offset==o.node.childNodes.length||o.node.childNodes[o.offset].contentEditable=="false")}class Js extends Si{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function Ns(o,e){let t=o.observer.selectionRange,i=t.focusNode&&gs(t.focusNode,t.focusOffset,0);if(!i)return null;let s=e-i.offset;return{from:s,to:s+i.node.nodeValue.length,node:i.node}}function Tr(o,e,t){let i=Ns(o,t);if(!i)return null;let{node:s,from:h,to:d}=i,y=s.nodeValue;if(/[\n\r]/.test(y)||o.state.doc.sliceString(i.from,i.to)!=y)return null;let b=e.invertedDesc,M=new Ki(b.mapPos(h),b.mapPos(d),h,d),C=[];for(let H=s.parentNode;;H=H.parentNode){let j=xe.get(H);if(j instanceof $)C.push({node:H,deco:j.mark});else{if(j instanceof Mt||H.nodeName=="DIV"&&H.parentNode==o.contentDOM)return{range:M,text:s,marks:C,line:H};if(H!=o.contentDOM)C.push({node:H,deco:new We({inclusive:!0,attributes:Ut(H),tagName:H.tagName.toLowerCase()})});else return null}}}function gs(o,e,t){if(t<=0)for(let i=o,s=e;;){if(i.nodeType==3)return{node:i,offset:s};if(i.nodeType==1&&s>0)i=i.childNodes[s-1],s=ct(i);else break}if(t>=0)for(let i=o,s=e;;){if(i.nodeType==3)return{node:i,offset:s};if(i.nodeType==1&&s<i.childNodes.length&&t>=0)i=i.childNodes[s],s=0;else break}return null}function T(o,e){return o.nodeType!=1?0:(e&&o.childNodes[e-1].contentEditable=="false"?1:0)|(e<o.childNodes.length&&o.childNodes[e].contentEditable=="false"?2:0)}let g=class{constructor(){this.changes=[]}compareRange(e,t){ot(e,t,this.changes)}comparePoint(e,t){ot(e,t,this.changes)}};function w(o,e,t){let i=new g;return m.om.compare(o,e,t,i),i.changes}function P(o,e){for(let t=o;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function N(o,e){let t=!1;return e&&o.iterChangedRanges((i,s)=>{i<e.to&&s>e.from&&(t=!0)}),t}function K(o,e,t=1){let i=o.charCategorizer(e),s=o.doc.lineAt(e),h=e-s.from;if(s.length==0)return m.OF.cursor(e);h==0?t=1:h==s.length&&(t=-1);let d=h,y=h;t<0?d=(0,m.zK)(s.text,h,!1):y=(0,m.zK)(s.text,h);let b=i(s.text.slice(d,y));for(;d>0;){let M=(0,m.zK)(s.text,d,!1);if(i(s.text.slice(M,d))!=b)break;d=M}for(;y<s.length;){let M=(0,m.zK)(s.text,y);if(i(s.text.slice(y,M))!=b)break;y=M}return m.OF.range(d+s.from,y+s.from)}function G(o,e){return e.left>o?e.left-o:Math.max(0,o-e.right)}function le(o,e){return e.top>o?e.top-o:Math.max(0,o-e.bottom)}function oe(o,e){return o.top<e.bottom-1&&o.bottom>e.top+1}function pe(o,e){return e<o.top?{top:e,left:o.left,right:o.right,bottom:o.bottom}:o}function Be(o,e){return e>o.bottom?{top:o.top,left:o.left,right:o.right,bottom:e}:o}function dt(o,e,t){let i,s,h,d,y=!1,b,M,C,H;for(let _=o.firstChild;_;_=_.nextSibling){let ae=gt(_);for(let ne=0;ne<ae.length;ne++){let de=ae[ne];s&&oe(s,de)&&(de=pe(Be(de,s.bottom),s.top));let $e=G(e,de),pt=le(t,de);if($e==0&&pt==0)return _.nodeType==3?Ci(_,e,t):dt(_,e,t);if(!i||d>pt||d==pt&&h>$e){i=_,s=de,h=$e,d=pt;let Ge=pt?t<de.top?-1:1:$e?e<de.left?-1:1:0;y=!Ge||(Ge>0?ne<ae.length-1:ne>0)}$e==0?t>de.bottom&&(!C||C.bottom<de.bottom)?(b=_,C=de):t<de.top&&(!H||H.top>de.top)&&(M=_,H=de):C&&oe(C,de)?C=Be(C,de.bottom):H&&oe(H,de)&&(H=pe(H,de.top))}}if(C&&C.bottom>=t?(i=b,s=C):H&&H.top<=t&&(i=M,s=H),!i)return{node:o,offset:0};let j=Math.max(s.left,Math.min(s.right,e));if(i.nodeType==3)return Ci(i,j,t);if(y&&i.contentEditable!="false")return dt(i,j,t);let J=Array.prototype.indexOf.call(o.childNodes,i)+(e>=(s.left+s.right)/2?1:0);return{node:o,offset:J}}function Ci(o,e,t){let i=o.nodeValue.length,s=-1,h=1e9,d=0;for(let y=0;y<i;y++){let b=St(o,y,y+1).getClientRects();for(let M=0;M<b.length;M++){let C=b[M];if(C.top==C.bottom)continue;d||(d=e-C.left);let H=(C.top>t?C.top-t:t-C.bottom)-1;if(C.left-1<=e&&C.right+1>=e&&H<h){let j=e>=(C.left+C.right)/2,J=j;if((A.chrome||A.gecko)&&St(o,y).getBoundingClientRect().left==C.right&&(J=!j),H<=0)return{node:o,offset:y+(J?1:0)};s=y+(J?1:0),h=H}}}return{node:o,offset:s>-1?s:d>0?o.nodeValue.length:0}}function gi(o,e,t,i=-1){var s,h;let d=o.contentDOM.getBoundingClientRect(),y=d.top+o.viewState.paddingTop,b,{docHeight:M}=o.viewState,{x:C,y:H}=e,j=H-y;if(j<0)return 0;if(j>M)return o.state.doc.length;for(let Ge=o.viewState.heightOracle.textHeight/2,mt=!1;b=o.elementAtHeight(j),b.type!=nt.Text;)for(;j=i>0?b.bottom+Ge:b.top-Ge,!(j>=0&&j<=M);){if(mt)return t?null:0;mt=!0,i=-i}H=y+j;let J=b.from;if(J<o.viewport.from)return o.viewport.from==0?0:t?null:yi(o,d,b,C,H);if(J>o.viewport.to)return o.viewport.to==o.state.doc.length?o.state.doc.length:t?null:yi(o,d,b,C,H);let _=o.dom.ownerDocument,ae=o.root.elementFromPoint?o.root:_,ne=ae.elementFromPoint(C,H);ne&&!o.contentDOM.contains(ne)&&(ne=null),ne||(C=Math.max(d.left+1,Math.min(d.right-1,C)),ne=ae.elementFromPoint(C,H),ne&&!o.contentDOM.contains(ne)&&(ne=null));let de,$e=-1;if(ne&&((s=o.docView.nearest(ne))===null||s===void 0?void 0:s.isEditable)!=!1){if(_.caretPositionFromPoint){let Ge=_.caretPositionFromPoint(C,H);Ge&&({offsetNode:de,offset:$e}=Ge)}else if(_.caretRangeFromPoint){let Ge=_.caretRangeFromPoint(C,H);Ge&&({startContainer:de,startOffset:$e}=Ge,(!o.contentDOM.contains(de)||A.safari&&ln(de,$e,C)||A.chrome&&ts(de,$e,C))&&(de=void 0))}}if(!de||!o.docView.dom.contains(de)){let Ge=Mt.find(o.docView,J);if(!Ge)return j>b.top+b.height/2?b.to:b.from;({node:de,offset:$e}=dt(Ge.dom,C,H))}let pt=o.docView.nearest(de);if(!pt)return null;if(pt.isWidget&&((h=pt.dom)===null||h===void 0?void 0:h.nodeType)==1){let Ge=pt.dom.getBoundingClientRect();return e.y<Ge.top||e.y<=Ge.bottom&&e.x<=(Ge.left+Ge.right)/2?pt.posAtStart:pt.posAtEnd}else return pt.localPosFromDOM(de,$e)+pt.posAtStart}function yi(o,e,t,i,s){let h=Math.round((i-e.left)*o.defaultCharacterWidth);if(o.lineWrapping&&t.height>o.defaultLineHeight*1.5){let y=o.viewState.heightOracle.textHeight,b=Math.floor((s-t.top-(o.defaultLineHeight-y)*.5)/y);h+=b*o.viewState.heightOracle.lineLength}let d=o.state.sliceDoc(t.from,t.to);return t.from+(0,m.kn)(d,h,o.state.tabSize)}function ln(o,e,t){let i;if(o.nodeType!=3||e!=(i=o.nodeValue.length))return!1;for(let s=o.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return St(o,i-1,i).getBoundingClientRect().left>t}function ts(o,e,t){if(e!=0)return!1;for(let s=o;;){let h=s.parentNode;if(!h||h.nodeType!=1||h.firstChild!=s)return!1;if(h.classList.contains("cm-line"))break;s=h}let i=o.nodeType==1?o.getBoundingClientRect():St(o,0,Math.max(o.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function an(o,e){let t=o.lineBlockAt(e);if(Array.isArray(t.type)){for(let i of t.type)if(i.to>e||i.to==e&&(i.to==t.to||i.type==nt.Text))return i}return t}function Vn(o,e,t,i){let s=an(o,e.head),h=!i||s.type!=nt.Text||!(o.lineWrapping||s.widgetLineBreaks)?null:o.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(h){let d=o.dom.getBoundingClientRect(),y=o.textDirectionAt(s.from),b=o.posAtCoords({x:t==(y==bt.LTR)?d.right-1:d.left+1,y:(h.top+h.bottom)/2});if(b!=null)return m.OF.cursor(b,t?-1:1)}return m.OF.cursor(t?s.to:s.from,t?-1:1)}function Bn(o,e,t,i){let s=o.state.doc.lineAt(e.head),h=o.bidiSpans(s),d=o.textDirectionAt(s.from);for(let y=e,b=null;;){let M=a(s,h,d,y,t),C=R;if(!M){if(s.number==(t?o.state.doc.lines:1))return y;C=`
`,s=o.state.doc.line(s.number+(t?1:-1)),h=o.bidiSpans(s),M=o.visualLineSide(s,!t)}if(b){if(!b(C))return y}else{if(!i)return M;b=i(C)}y=M}}function ys(o,e,t){let i=o.state.charCategorizer(e),s=i(t);return h=>{let d=i(h);return s==m.Je.Space&&(s=d),s==d}}function Co(o,e,t,i){let s=e.head,h=t?1:-1;if(s==(t?o.state.doc.length:0))return m.OF.cursor(s,e.assoc);let d=e.goalColumn,y,b=o.contentDOM.getBoundingClientRect(),M=o.coordsAtPos(s,e.assoc||-1),C=o.documentTop;if(M)d==null&&(d=M.left-b.left),y=h<0?M.top:M.bottom;else{let J=o.viewState.lineBlockAt(s);d==null&&(d=Math.min(b.right-b.left,o.defaultCharacterWidth*(s-J.from))),y=(h<0?J.top:J.bottom)+C}let H=b.left+d,j=i!=null?i:o.viewState.heightOracle.textHeight>>1;for(let J=0;;J+=10){let _=y+(j+J)*h,ae=gi(o,{x:H,y:_},!1,h);if(_<b.top||_>b.bottom||(h<0?ae<s:ae>s)){let ne=o.docView.coordsForChar(ae),de=!ne||_<ne.top?-1:1;return m.OF.cursor(ae,de,void 0,d)}}}function Xs(o,e,t){for(;;){let i=0;for(let s of o)s.between(e-1,e+1,(h,d,y)=>{if(e>h&&e<d){let b=i||t||(e-h<d-e?-1:1);e=b<0?h:d,i=b}});if(!i)return e}}function lr(o,e,t){let i=Xs(o.state.facet(ps).map(s=>s(o)),t.from,e.head>t.from?-1:1);return i==t.from?t:m.OF.cursor(i,i<t.from?1:-1)}class no{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,A.safari&&e.contentDOM.addEventListener("input",()=>null),A.gecko&&Ve(e.contentDOM.ownerDocument)}handleEvent(e){!Is(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let i=this.handlers[e];if(i){for(let s of i.observers)s(this.view,t);for(let s of i.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=ri(e),i=this.handlers,s=this.view.contentDOM;for(let h in t)if(h!="scroll"){let d=!t[h].handlers.length,y=i[h];y&&d!=!y.handlers.length&&(s.removeEventListener(h,this.handleEvent),y=null),y||s.addEventListener(h,this.handleEvent,{passive:d})}for(let h in i)h!="scroll"&&!t[h]&&s.removeEventListener(h,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&jn.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),A.android&&A.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return A.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=hr.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||Or.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,ci(this.view.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:A.safari&&!A.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function ar(o,e){return(t,i)=>{try{return e.call(o,i,t)}catch(s){Nt(t.state,s)}}}function ri(o){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of o){let s=i.spec;if(s&&s.domEventHandlers)for(let h in s.domEventHandlers){let d=s.domEventHandlers[h];d&&t(h).handlers.push(ar(i.value,d))}if(s&&s.domEventObservers)for(let h in s.domEventObservers){let d=s.domEventObservers[h];d&&t(h).observers.push(ar(i.value,d))}}for(let i in hn)t(i).handlers.push(hn[i]);for(let i in nn)t(i).observers.push(nn[i]);return e}const hr=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Or="dthko",jn=[16,17,18,20,91,92,224,225],vs=6;function bs(o){return Math.max(0,o)*.7+8}function Dr(o,e){return Math.max(Math.abs(o.clientX-e.clientX),Math.abs(o.clientY-e.clientY))}class $n{constructor(e,t,i,s){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=di(e.contentDOM),this.atoms=e.state.facet(ps).map(d=>d(e));let h=e.contentDOM.ownerDocument;h.addEventListener("mousemove",this.move=this.move.bind(this)),h.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(m.$t.allowMultipleSelections)&&xs(e,t),this.dragging=Rr(e,t)&&Wr(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Dr(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let i=0,s=0,h=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},d=Qn(this.view);e.clientX-d.left<=h.left+vs?i=-bs(h.left-e.clientX):e.clientX+d.right>=h.right-vs&&(i=bs(e.clientX-h.right)),e.clientY-d.top<=h.top+vs?s=-bs(h.top-e.clientY):e.clientY+d.bottom>=h.bottom-vs&&(s=bs(e.clientY-h.bottom)),this.setScrollSpeed(i,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let i=0;i<e.ranges.length;i++){let s=e.ranges[i],h=null;if(s.empty){let d=Xs(this.atoms,s.from,0);d!=s.from&&(h=m.OF.cursor(d,-1))}else{let d=Xs(this.atoms,s.from,-1),y=Xs(this.atoms,s.to,1);(d!=s.from||y!=s.to)&&(h=m.OF.range(s.from==s.anchor?d:y,s.from==s.head?d:y))}h&&(t||(t=e.ranges.slice()),t[i]=h)}return t?m.OF.create(t,e.mainIndex):e}select(e){let{view:t}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function xs(o,e){let t=o.state.facet(v);return t.length?t[0](e):A.mac?e.metaKey:e.ctrlKey}function Pr(o,e){let t=o.state.facet(x);return t.length?t[0](e):A.mac?!e.altKey:!e.ctrlKey}function Rr(o,e){let{main:t}=o.state.selection;if(t.empty)return!1;let i=xt(o.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let h=0;h<s.length;h++){let d=s[h];if(d.left<=e.clientX&&d.right>=e.clientX&&d.top<=e.clientY&&d.bottom>=e.clientY)return!0}return!1}function Is(o,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=o.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=xe.get(t))&&i.ignoreEvent(e))return!1;return!0}const hn=Object.create(null),nn=Object.create(null),cr=A.ie&&A.ie_version<15||A.ios&&A.webkit_version<604;function fr(o){let e=o.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{o.focus(),t.remove(),Lr(o,t.value)},50)}function Lr(o,e){let{state:t}=o,i,s=1,h=t.toText(e),d=h.lines==t.selection.ranges.length;if(Q!=null&&t.selection.ranges.every(b=>b.empty)&&Q==h.toString()){let b=-1;i=t.changeByRange(M=>{let C=t.doc.lineAt(M.from);if(C.from==b)return{range:M};b=C.from;let H=t.toText((d?h.line(s++).text:e)+t.lineBreak);return{changes:{from:C.from,insert:H},range:m.OF.cursor(M.from+H.length)}})}else d?i=t.changeByRange(b=>{let M=h.line(s++);return{changes:{from:b.from,to:b.to,insert:M.text},range:m.OF.cursor(b.from+M.length)}}):i=t.replaceSelection(h);o.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}nn.scroll=o=>{o.inputState.lastScrollTop=o.scrollDOM.scrollTop,o.inputState.lastScrollLeft=o.scrollDOM.scrollLeft},hn.keydown=(o,e)=>(o.inputState.setSelectionOrigin("select"),e.keyCode==27&&(o.inputState.lastEscPress=Date.now()),!1),nn.touchstart=(o,e)=>{o.inputState.lastTouchTime=Date.now(),o.inputState.setSelectionOrigin("select.pointer")},nn.touchmove=o=>{o.inputState.setSelectionOrigin("select.pointer")},hn.mousedown=(o,e)=>{if(o.observer.flush(),o.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of o.state.facet(O))if(t=i(o,e),t)break;if(!t&&e.button==0&&(t=ro(o,e)),t){let i=!o.hasFocus;o.inputState.startMouseSelection(new $n(o,e,t,i)),i&&o.observer.ignore(()=>Lt(o.contentDOM));let s=o.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}return!1};function Br(o,e,t,i){if(i==1)return m.OF.cursor(e,t);if(i==2)return K(o.state,e,t);{let s=Mt.find(o.docView,e),h=o.state.doc.lineAt(s?s.posAtEnd:e),d=s?s.posAtStart:h.from,y=s?s.posAtEnd:h.to;return y<o.state.doc.length&&y==h.to&&y++,m.OF.range(d,y)}}let ur=(o,e)=>o>=e.top&&o<=e.bottom,Nr=(o,e,t)=>ur(e,t)&&o>=t.left&&o<=t.right;function so(o,e,t,i){let s=Mt.find(o.docView,e);if(!s)return 1;let h=e-s.posAtStart;if(h==0)return 1;if(h==s.length)return-1;let d=s.coordsAt(h,-1);if(d&&Nr(t,i,d))return-1;let y=s.coordsAt(h,1);return y&&Nr(t,i,y)?1:d&&ur(i,d)?-1:1}function Ir(o,e){let t=o.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:so(o,t,e.clientX,e.clientY)}}const Zs=A.ie&&A.ie_version<=11;let qs=null,Fr=0,Hr=0;function Wr(o){if(!Zs)return o.detail;let e=qs,t=Hr;return qs=o,Hr=Date.now(),Fr=!e||t>Date.now()-400&&Math.abs(e.clientX-o.clientX)<2&&Math.abs(e.clientY-o.clientY)<2?(Fr+1)%3:1}function ro(o,e){let t=Ir(o,e),i=Wr(e),s=o.state.selection;return{update(h){h.docChanged&&(t.pos=h.changes.mapPos(t.pos),s=s.map(h.changes))},get(h,d,y){let b=Ir(o,h),M,C=Br(o,b.pos,b.bias,i);if(t.pos!=b.pos&&!d){let H=Br(o,t.pos,t.bias,i),j=Math.min(H.from,C.from),J=Math.max(H.to,C.to);C=j<C.from?m.OF.range(j,J):m.OF.range(J,j)}return d?s.replaceRange(s.main.extend(C.from,C.to)):y&&i==1&&s.ranges.length>1&&(M=oo(s,b.pos))?M:y?s.addRange(C):m.OF.create([C])}}}function oo(o,e){for(let t=0;t<o.ranges.length;t++){let{from:i,to:s}=o.ranges[t];if(i<=e&&s>=e)return m.OF.create(o.ranges.slice(0,t).concat(o.ranges.slice(t+1)),o.mainIndex==t?0:o.mainIndex-(o.mainIndex>t?1:0))}return null}hn.dragstart=(o,e)=>{let{selection:{main:t}}=o.state;if(e.target.draggable){let s=o.docView.nearest(e.target);if(s&&s.isWidget){let h=s.posAtStart,d=h+s.length;(h>=t.to||d<=t.from)&&(t=m.OF.range(h,d))}}let{inputState:i}=o;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",o.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove"),!1},hn.dragend=o=>(o.inputState.draggedContent=null,!1);function Kn(o,e,t,i){if(!t)return;let s=o.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:h}=o.inputState,d=i&&h&&Pr(o,e)?{from:h.from,to:h.to}:null,y={from:s,insert:t},b=o.state.changes(d?[d,y]:y);o.focus(),o.dispatch({changes:b,selection:{anchor:b.mapPos(s,-1),head:b.mapPos(s,1)},userEvent:d?"move.drop":"input.drop"}),o.inputState.draggedContent=null}hn.drop=(o,e)=>{if(!e.dataTransfer)return!1;if(o.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),s=0,h=()=>{++s==t.length&&Kn(o,e,i.filter(d=>d!=null).join(o.state.lineBreak),!1)};for(let d=0;d<t.length;d++){let y=new FileReader;y.onerror=h,y.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(y.result)||(i[d]=y.result),h()},y.readAsText(t[d])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return Kn(o,e,i,!0),!0}return!1},hn.paste=(o,e)=>{if(o.state.readOnly)return!0;o.observer.flush();let t=cr?null:e.clipboardData;return t?(Lr(o,t.getData("text/plain")||t.getData("text/uri-text")),!0):(fr(o),!1)};function z(o,e){let t=o.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),o.focus()},50)}function V(o){let e=[],t=[],i=!1;for(let s of o.selection.ranges)s.empty||(e.push(o.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:h}of o.selection.ranges){let d=o.doc.lineAt(h);d.number>s&&(e.push(d.text),t.push({from:d.from,to:Math.min(o.doc.length,d.to+1)})),s=d.number}i=!0}return{text:e.join(o.lineBreak),ranges:t,linewise:i}}let Q=null;hn.copy=hn.cut=(o,e)=>{let{text:t,ranges:i,linewise:s}=V(o.state);if(!t&&!s)return!1;Q=s?t:null,e.type=="cut"&&!o.state.readOnly&&o.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let h=cr?null:e.clipboardData;return h?(h.clearData(),h.setData("text/plain",t),!0):(z(o,t),!1)};const ie=m.YH.define();function fe(o,e){let t=[];for(let i of o.facet(se)){let s=i(o,e);s&&t.push(s)}return t?o.update({effects:t,annotations:ie.of(!0)}):null}function me(o){setTimeout(()=>{let e=o.hasFocus;if(e!=o.inputState.notifiedFocused){let t=fe(o.state,e);t?o.dispatch(t):o.update([])}},10)}nn.focus=o=>{o.inputState.lastFocusTime=Date.now(),!o.scrollDOM.scrollTop&&(o.inputState.lastScrollTop||o.inputState.lastScrollLeft)&&(o.scrollDOM.scrollTop=o.inputState.lastScrollTop,o.scrollDOM.scrollLeft=o.inputState.lastScrollLeft),me(o)},nn.blur=o=>{o.observer.clearSelectionRange(),me(o)},nn.compositionstart=nn.compositionupdate=o=>{o.inputState.compositionFirstChange==null&&(o.inputState.compositionFirstChange=!0),o.inputState.composing<0&&(o.inputState.composing=0)},nn.compositionend=o=>{o.inputState.composing=-1,o.inputState.compositionEndedAt=Date.now(),o.inputState.compositionPendingKey=!0,o.inputState.compositionPendingChange=o.observer.pendingRecords().length>0,o.inputState.compositionFirstChange=null,A.chrome&&A.android?o.observer.flushSoon():o.inputState.compositionPendingChange?Promise.resolve().then(()=>o.observer.flush()):setTimeout(()=>{o.inputState.composing<0&&o.docView.hasComposition&&o.update([])},50)},nn.contextmenu=o=>{o.inputState.lastContextMenu=Date.now()},hn.beforeinput=(o,e)=>{var t;let i;if(A.chrome&&A.android&&(i=hr.find(s=>s.inputType==e.inputType))&&(o.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var h;(((h=window.visualViewport)===null||h===void 0?void 0:h.height)||0)>s+10&&o.hasFocus&&(o.contentDOM.blur(),o.focus())},100)}return!1};const be=new Set;function Ve(o){be.has(o)||(be.add(o),o.addEventListener("copy",()=>{}),o.addEventListener("cut",()=>{}))}const Tt=["pre-wrap","normal","pre-line","break-spaces"];class kt{constructor(e){this.lineWrapping=e,this.doc=m.EY.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Tt.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,i,s,h,d){let y=Tt.indexOf(e)>-1,b=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=y;if(this.lineWrapping=y,this.lineHeight=t,this.charWidth=i,this.textHeight=s,this.lineLength=h,b){this.heightSamples={};for(let M=0;M<d.length;M++){let C=d[M];C<0?M++:this.heightSamples[Math.floor(C*10)]=!0}}return b}}class Ze{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Te{constructor(e,t,i,s,h){this.from=e,this.length=t,this.top=i,this.height=s,this._content=h}get type(){return typeof this._content=="number"?nt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof rt?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Te(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var ke=function(o){return o[o.ByPos=0]="ByPos",o[o.ByHeight=1]="ByHeight",o[o.ByPosNoHeight=2]="ByPosNoHeight",o}(ke||(ke={}));const lt=.001;class Ue{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>lt&&(e.heightChanged=!0),this.height=t)}replace(e,t,i){return Ue.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,s){let h=this,d=i.doc;for(let y=s.length-1;y>=0;y--){let{fromA:b,toA:M,fromB:C,toB:H}=s[y],j=h.lineAt(b,ke.ByPosNoHeight,i.setDoc(t),0,0),J=j.to>=M?j:h.lineAt(M,ke.ByPosNoHeight,i,0,0);for(H+=J.to-M,M=J.to;y>0&&j.from<=s[y-1].toA;)b=s[y-1].fromA,C=s[y-1].fromB,y--,b<j.from&&(j=h.lineAt(b,ke.ByPosNoHeight,i,0,0));C+=j.from-b,b=j.from;let _=Fi.build(i.setDoc(d),e,C,H);h=h.replace(b,M,_)}return h.updateHeight(i,0)}static empty(){return new Xt(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,s=0,h=0;for(;;)if(t==i)if(s>h*2){let y=e[t-1];y.break?e.splice(--t,1,y.left,null,y.right):e.splice(--t,1,y.left,y.right),i+=1+y.break,s-=y.size}else if(h>s*2){let y=e[i];y.break?e.splice(i,1,y.left,null,y.right):e.splice(i,1,y.left,y.right),i+=2+y.break,h-=y.size}else break;else if(s<h){let y=e[t++];y&&(s+=y.size)}else{let y=e[--i];y&&(h+=y.size)}let d=0;return e[t-1]==null?(d=1,t--):e[t]==null&&(d=1,i++),new Yi(Ue.of(e.slice(0,t)),d,Ue.of(e.slice(i)))}}Ue.prototype.size=1;class ai extends Ue{constructor(e,t,i){super(e,t),this.deco=i}blockAt(e,t,i,s){return new Te(s,this.length,i,this.height,this.deco||0)}lineAt(e,t,i,s,h){return this.blockAt(0,i,s,h)}forEachLine(e,t,i,s,h,d){e<=h+this.length&&t>=h&&d(this.blockAt(0,i,s,h))}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more&&this.setHeight(e,s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Xt extends ai{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,i,s){return new Te(s,this.length,i,this.height,this.breaks)}replace(e,t,i){let s=i[0];return i.length==1&&(s instanceof Xt||s instanceof Vt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Vt?s=new Xt(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):Ue.of(i)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more?this.setHeight(e,s.heights[s.index++]):(i||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Vt extends Ue{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,h=s-i+1,d,y=0;if(e.lineWrapping){let b=Math.min(this.height,e.lineHeight*h);d=b/h,this.length>h+1&&(y=(this.height-b)/(this.length-h-1))}else d=this.height/h;return{firstLine:i,lastLine:s,perLine:d,perChar:y}}blockAt(e,t,i,s){let{firstLine:h,lastLine:d,perLine:y,perChar:b}=this.heightMetrics(t,s);if(t.lineWrapping){let M=s+Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length),C=t.doc.lineAt(M),H=y+C.length*b,j=Math.max(i,e-H/2);return new Te(C.from,C.length,j,H,0)}else{let M=Math.max(0,Math.min(d-h,Math.floor((e-i)/y))),{from:C,length:H}=t.doc.line(h+M);return new Te(C,H,i+y*M,y,0)}}lineAt(e,t,i,s,h){if(t==ke.ByHeight)return this.blockAt(e,i,s,h);if(t==ke.ByPosNoHeight){let{from:J,to:_}=i.doc.lineAt(e);return new Te(J,_-J,0,0,0)}let{firstLine:d,perLine:y,perChar:b}=this.heightMetrics(i,h),M=i.doc.lineAt(e),C=y+M.length*b,H=M.number-d,j=s+y*H+b*(M.from-h-H);return new Te(M.from,M.length,Math.max(s,Math.min(j,s+this.height-C)),C,0)}forEachLine(e,t,i,s,h,d){e=Math.max(e,h),t=Math.min(t,h+this.length);let{firstLine:y,perLine:b,perChar:M}=this.heightMetrics(i,h);for(let C=e,H=s;C<=t;){let j=i.doc.lineAt(C);if(C==e){let _=j.number-y;H+=b*_+M*(e-h-_)}let J=b+M*j.length;d(new Te(j.from,j.length,H,J,0)),H+=J,C=j.to+1}}replace(e,t,i){let s=this.length-t;if(s>0){let h=i[i.length-1];h instanceof Vt?i[i.length-1]=new Vt(h.length+s):i.push(null,new Vt(s-1))}if(e>0){let h=i[0];h instanceof Vt?i[0]=new Vt(e+h.length):i.unshift(new Vt(e-1),null)}return Ue.of(i)}decomposeLeft(e,t){t.push(new Vt(e-1),null)}decomposeRight(e,t){t.push(null,new Vt(this.length-e-1))}updateHeight(e,t=0,i=!1,s){let h=t+this.length;if(s&&s.from<=t+this.length&&s.more){let d=[],y=Math.max(t,s.from),b=-1;for(s.from>t&&d.push(new Vt(s.from-t-1).updateHeight(e,t));y<=h&&s.more;){let C=e.doc.lineAt(y).length;d.length&&d.push(null);let H=s.heights[s.index++];b==-1?b=H:Math.abs(H-b)>=lt&&(b=-2);let j=new Xt(C,H);j.outdated=!1,d.push(j),y+=C+1}y<=h&&d.push(null,new Vt(h-y).updateHeight(e,y));let M=Ue.of(d);return(b<0||Math.abs(M.height-this.height)>=lt||Math.abs(b-this.heightMetrics(e,t).perLine)>=lt)&&(e.heightChanged=!0),M}else(i||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Yi extends Ue{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,s){let h=i+this.left.height;return e<h?this.left.blockAt(e,t,i,s):this.right.blockAt(e,t,h,s+this.left.length+this.break)}lineAt(e,t,i,s,h){let d=s+this.left.height,y=h+this.left.length+this.break,b=t==ke.ByHeight?e<d:e<y,M=b?this.left.lineAt(e,t,i,s,h):this.right.lineAt(e,t,i,d,y);if(this.break||(b?M.to<y:M.from>y))return M;let C=t==ke.ByPosNoHeight?ke.ByPosNoHeight:ke.ByPos;return b?M.join(this.right.lineAt(y,C,i,d,y)):this.left.lineAt(y,C,i,s,h).join(M)}forEachLine(e,t,i,s,h,d){let y=s+this.left.height,b=h+this.left.length+this.break;if(this.break)e<b&&this.left.forEachLine(e,t,i,s,h,d),t>=b&&this.right.forEachLine(e,t,i,y,b,d);else{let M=this.lineAt(b,ke.ByPos,i,s,h);e<M.from&&this.left.forEachLine(e,M.from-1,i,s,h,d),M.to>=e&&M.from<=t&&d(M),t>M.to&&this.right.forEachLine(M.to+1,t,i,y,b,d)}}replace(e,t,i){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,i));let h=[];e>0&&this.decomposeLeft(e,h);let d=h.length;for(let y of i)h.push(y);if(e>0&&Di(h,d-1),t<this.length){let y=h.length;this.decomposeRight(t,h),Di(h,y)}return Ue.of(h)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Ue.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,s){let{left:h,right:d}=this,y=t+h.length+this.break,b=null;return s&&s.from<=t+h.length&&s.more?b=h=h.updateHeight(e,t,i,s):h.updateHeight(e,t,i),s&&s.from<=y+d.length&&s.more?b=d=d.updateHeight(e,y,i,s):d.updateHeight(e,y,i),b?this.balanced(h,d):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Di(o,e){let t,i;o[e]==null&&(t=o[e-1])instanceof Vt&&(i=o[e+1])instanceof Vt&&o.splice(e-1,3,new Vt(t.length+1+i.length))}const Pi=5;class Fi{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Xt?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Xt(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0,h=i.widget?i.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let d=t-e;i.block?this.addBlock(new ai(d,s,i)):(d||h||s>=Pi)&&this.addLineDeco(s,h,d)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Xt(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new Vt(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Xt)return e;let t=new Xt(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Xt)&&!this.isCovered?this.nodes.push(new Xt(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof Xt&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,t,i,s){let h=new Fi(i,e);return m.om.spans(t,i,s,h,0),h.finish(i)}}function jt(o,e,t){let i=new Un;return m.om.compare(o,e,t,i,0),i.changes}class Un{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,s){(e<t||i&&i.heightRelevant||s&&s.heightRelevant)&&ot(e,t,this.changes,5)}}function vi(o,e){let t=o.getBoundingClientRect(),i=o.ownerDocument,s=i.defaultView||window,h=Math.max(0,t.left),d=Math.min(s.innerWidth,t.right),y=Math.max(0,t.top),b=Math.min(s.innerHeight,t.bottom);for(let M=o.parentNode;M&&M!=i.body;)if(M.nodeType==1){let C=M,H=window.getComputedStyle(C);if((C.scrollHeight>C.clientHeight||C.scrollWidth>C.clientWidth)&&H.overflow!="visible"){let j=C.getBoundingClientRect();h=Math.max(h,j.left),d=Math.min(d,j.right),y=Math.max(y,j.top),b=M==o.parentNode?j.bottom:Math.min(b,j.bottom)}M=H.position=="absolute"||H.position=="fixed"?C.offsetParent:C.parentNode}else if(M.nodeType==11)M=M.host;else break;return{left:h-t.left,right:Math.max(h,d)-t.left,top:y-(t.top+e),bottom:Math.max(y,b)-(t.top+e)}}function Hi(o,e){let t=o.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Ui{constructor(e,t,i){this.from=e,this.to=t,this.size=i}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],h=t[i];if(s.from!=h.from||s.to!=h.to||s.size!=h.size)return!1}return!0}draw(e,t){return Xe.replace({widget:new dn(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class dn extends Si{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Cn{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=wn,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=bt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(zn).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new kt(t),this.stateDeco=e.facet(Rn).filter(i=>typeof i!="function"),this.heightMap=Ue.empty().applyChanges(this.stateDeco,m.EY.empty,this.heightOracle.setDoc(e.doc),[new Ki(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Xe.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let s=i?t.head:t.anchor;if(!e.some(({from:h,to:d})=>s>=h&&s<=d)){let{from:h,to:d}=this.lineBlockAt(s);e.push(new hi(h,d))}}this.viewports=e.sort((i,s)=>i.from-s.from),this.scaler=this.heightMap.height<=7e6?wn:new Ji(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Mn(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Rn).filter(C=>typeof C!="function");let s=e.changedRanges,h=Ki.extendWithRanges(s,jt(i,this.stateDeco,e?e.changes:m.VR.empty(this.state.doc.length))),d=this.heightMap.height,y=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),h),this.heightMap.height!=d&&(e.flags|=2),y?(this.scrollAnchorPos=e.changes.mapPos(y.from,-1),this.scrollAnchorHeight=y.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let b=h.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<b.from||t.range.head>b.to)||!this.viewportIsAppropriate(b))&&(b=this.getViewport(0,t));let M=!e.changes.empty||e.flags&2||b.from!=this.viewport.from||b.to!=this.viewport.to;this.viewport=b,this.updateForViewport(),M&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(ve)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),s=this.heightOracle,h=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?bt.RTL:bt.LTR;let d=this.heightOracle.mustRefreshForWrapping(h),y=t.getBoundingClientRect(),b=d||this.mustMeasureContent||this.contentDOMHeight!=y.height;this.contentDOMHeight=y.height,this.mustMeasureContent=!1;let M=0,C=0;if(y.width&&y.height){let{scaleX:Ge,scaleY:mt}=ui(t,y);(this.scaleX!=Ge||this.scaleY!=mt)&&(this.scaleX=Ge,this.scaleY=mt,M|=8,d=b=!0)}let H=(parseInt(i.paddingTop)||0)*this.scaleY,j=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=H||this.paddingBottom!=j)&&(this.paddingTop=H,this.paddingBottom=j,M|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(b=!0),this.editorWidth=e.scrollDOM.clientWidth,M|=8);let J=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=J&&(this.scrollAnchorHeight=-1,this.scrollTop=J),this.scrolledToBottom=Ti(e.scrollDOM);let _=(this.printing?Hi:vi)(t,this.paddingTop),ae=_.top-this.pixelViewport.top,ne=_.bottom-this.pixelViewport.bottom;this.pixelViewport=_;let de=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(de!=this.inView&&(this.inView=de,de&&(b=!0)),!this.inView&&!this.scrollTarget)return 0;let $e=y.width;if((this.contentDOMWidth!=$e||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=y.width,this.editorHeight=e.scrollDOM.clientHeight,M|=8),b){let Ge=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(Ge)&&(d=!0),d||s.lineWrapping&&Math.abs($e-this.contentDOMWidth)>s.charWidth){let{lineHeight:mt,charWidth:Ot,textHeight:Vi}=e.docView.measureTextSize();d=mt>0&&s.refresh(h,mt,Ot,Vi,$e/Ot,Ge),d&&(e.docView.minWidth=0,M|=8)}ae>0&&ne>0?C=Math.max(ae,ne):ae<0&&ne<0&&(C=Math.min(ae,ne)),s.heightChanged=!1;for(let mt of this.viewports){let Ot=mt.from==this.viewport.from?Ge:e.docView.measureVisibleLineHeights(mt);this.heightMap=(d?Ue.empty().applyChanges(this.stateDeco,m.EY.empty,this.heightOracle,[new Ki(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,d,new Ze(mt.from,Ot))}s.heightChanged&&(M|=2)}let pt=!this.viewportIsAppropriate(this.viewport,C)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return pt&&(this.viewport=this.getViewport(C,this.scrollTarget)),this.updateForViewport(),(M&2||pt)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(d?[]:this.lineGaps,e)),M|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),M}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,h=this.heightOracle,{visibleTop:d,visibleBottom:y}=this,b=new hi(s.lineAt(d-i*1e3,ke.ByHeight,h,0,0).from,s.lineAt(y+(1-i)*1e3,ke.ByHeight,h,0,0).to);if(t){let{head:M}=t.range;if(M<b.from||M>b.to){let C=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),H=s.lineAt(M,ke.ByPos,h,0,0),j;t.y=="center"?j=(H.top+H.bottom)/2-C/2:t.y=="start"||t.y=="nearest"&&M<b.from?j=H.top:j=H.bottom-C,b=new hi(s.lineAt(j-1e3/2,ke.ByHeight,h,0,0).from,s.lineAt(j+C+1e3/2,ke.ByHeight,h,0,0).to)}}return b}mapViewport(e,t){let i=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new hi(this.heightMap.lineAt(i,ke.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,ke.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,ke.ByPos,this.heightOracle,0,0),{bottom:h}=this.heightMap.lineAt(t,ke.ByPos,this.heightOracle,0,0),{visibleTop:d,visibleBottom:y}=this;return(e==0||s<=d-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||h>=y+Math.max(10,Math.min(i,250)))&&s>d-2*1e3&&h<y+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let s of e)t.touchesRange(s.from,s.to)||i.push(new Ui(t.mapPos(s.from),t.mapPos(s.to),s.size));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,h=s>>1,d=s<<1;if(this.defaultTextDirection!=bt.LTR&&!i)return[];let y=[],b=(M,C,H,j)=>{if(C-M<h)return;let J=this.state.selection.main,_=[J.from];J.empty||_.push(J.to);for(let ne of _)if(ne>M&&ne<C){b(M,ne-10,H,j),b(ne+10,C,H,j);return}let ae=Qs(e,ne=>ne.from>=H.from&&ne.to<=H.to&&Math.abs(ne.from-M)<h&&Math.abs(ne.to-C)<h&&!_.some(de=>ne.from<de&&ne.to>de));if(!ae){if(C<H.to&&t&&i&&t.visibleRanges.some(ne=>ne.from<=C&&ne.to>=C)){let ne=t.moveToLineBoundary(m.OF.cursor(C),!1,!0).head;ne>M&&(C=ne)}ae=new Ui(M,C,this.gapSize(H,M,C,j))}y.push(ae)};for(let M of this.viewportLines){if(M.length<d)continue;let C=xn(M.from,M.to,this.stateDeco);if(C.total<d)continue;let H=this.scrollTarget?this.scrollTarget.range.head:null,j,J;if(i){let _=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,ae,ne;if(H!=null){let de=is(C,H),$e=((this.visibleBottom-this.visibleTop)/2+_)/M.height;ae=de-$e,ne=de+$e}else ae=(this.visibleTop-M.top-_)/M.height,ne=(this.visibleBottom-M.top+_)/M.height;j=Ri(C,ae),J=Ri(C,ne)}else{let _=C.total*this.heightOracle.charWidth,ae=s*this.heightOracle.charWidth,ne,de;if(H!=null){let $e=is(C,H),pt=((this.pixelViewport.right-this.pixelViewport.left)/2+ae)/_;ne=$e-pt,de=$e+pt}else ne=(this.pixelViewport.left-ae)/_,de=(this.pixelViewport.right+ae)/_;j=Ri(C,ne),J=Ri(C,de)}j>M.from&&b(M.from,j,M,C),J<M.to&&b(J,M.to,M,C)}return y}gapSize(e,t,i,s){let h=is(s,i)-is(s,t);return this.heightOracle.lineWrapping?e.height*h:s.total*this.heightOracle.charWidth*h}updateLineGaps(e){Ui.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Xe.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];m.om.spans(e,this.viewport.from,this.viewport.to,{span(s,h){t.push({from:s,to:h})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some((s,h)=>s.from!=t[h].from||s.to!=t[h].to);return this.visibleRanges=t,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Mn(this.heightMap.lineAt(e,ke.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return Mn(this.heightMap.lineAt(this.scaler.fromDOM(e),ke.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Mn(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class hi{constructor(e,t){this.from=e,this.to=t}}function xn(o,e,t){let i=[],s=o,h=0;return m.om.spans(t,o,e,{span(){},point(d,y){d>s&&(i.push({from:s,to:d}),h+=d-s),s=y}},20),s<e&&(i.push({from:s,to:e}),h+=e-s),{total:h,ranges:i}}function Ri({total:o,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(o*t);for(let s=0;;s++){let{from:h,to:d}=e[s],y=d-h;if(i<=y)return h+i;i-=y}}function is(o,e){let t=0;for(let{from:i,to:s}of o.ranges){if(e<=s){t+=e-i;break}t+=s-i}return t/o.total}function Qs(o,e){for(let t of o)if(e(t))return t}const wn={toDOM(o){return o},fromDOM(o){return o},scale:1};class Ji{constructor(e,t,i){let s=0,h=0,d=0;this.viewports=i.map(({from:y,to:b})=>{let M=t.lineAt(y,ke.ByPos,e,0,0).top,C=t.lineAt(b,ke.ByPos,e,0,0).bottom;return s+=C-M,{from:y,to:b,top:M,bottom:C,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let y of this.viewports)y.domTop=d+(y.top-h)*this.scale,d=y.domBottom=y.domTop+(y.bottom-y.top),h=y.bottom}toDOM(e){for(let t=0,i=0,s=0;;t++){let h=t<this.viewports.length?this.viewports[t]:null;if(!h||e<h.top)return s+(e-i)*this.scale;if(e<=h.bottom)return h.domTop+(e-h.top);i=h.bottom,s=h.domBottom}}fromDOM(e){for(let t=0,i=0,s=0;;t++){let h=t<this.viewports.length?this.viewports[t]:null;if(!h||e<h.domTop)return i+(e-s)/this.scale;if(e<=h.domBottom)return h.top+(e-h.domTop);i=h.bottom,s=h.domBottom}}}function Mn(o,e){if(e.scale==1)return o;let t=e.toDOM(o.top),i=e.toDOM(o.bottom);return new Te(o.from,o.length,t,i-t,Array.isArray(o._content)?o._content.map(s=>Mn(s,e)):o._content)}const En=m.sj.define({combine:o=>o.join(" ")}),Wi=m.sj.define({combine:o=>o.indexOf(!0)>-1}),Tn=Se.G.newName(),pn=Se.G.newName(),ws=Se.G.newName(),Ss={"&light":"."+pn,"&dark":"."+ws};function cn(o,e,t){return new Se.G(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return o;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):o+" "+i}})}const _s=cn("."+Tn,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Ss),Nn="\uFFFF";class ks{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(m.$t.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Nn}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s);let h=this.text.length;this.readNode(s);let d=s.nextSibling;if(d==t)break;let y=xe.get(s),b=xe.get(d);(y&&b?y.breakAfter:(y?y.breakAfter:sn(s))||sn(d)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>h)&&this.lineBreak(),s=d}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let h=-1,d=1,y;if(this.lineSeparator?(h=t.indexOf(this.lineSeparator,i),d=this.lineSeparator.length):(y=s.exec(t))&&(h=y.index,d=y[0].length),this.append(t.slice(i,h<0?t.length:h)),h<0)break;if(this.lineBreak(),d>1)for(let b of this.points)b.node==e&&b.pos>this.text.length&&(b.pos-=d-1);i=h+d}}readNode(e){if(e.cmIgnore)return;let t=xe.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(Gn(e,i.node,i.offset)?t:0))}}function Gn(o,e,t){for(;;){if(!e||t<ct(e))return!1;if(e==o)return!0;t=Zt(e)+1,e=e.parentNode}}function sn(o){return o.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(o.nodeName)}class As{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class In{constructor(e,t,i,s){this.typeOver=s,this.bounds=null,this.text="";let{impreciseHead:h,impreciseAnchor:d}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,i,0))){let y=h||d?[]:Fn(e),b=new ks(y,e.state);b.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=b.text,this.newSel=ns(y,this.bounds.from)}else{let y=e.observer.selectionRange,b=h&&h.node==y.focusNode&&h.offset==y.focusOffset||!Ke(e.contentDOM,y.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(y.focusNode,y.focusOffset),M=d&&d.node==y.anchorNode&&d.offset==y.anchorOffset||!Ke(e.contentDOM,y.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(y.anchorNode,y.anchorOffset),C=e.viewport;if((A.ios||A.chrome)&&e.state.selection.main.empty&&b!=M&&(C.from>0||C.to<e.state.doc.length)){let H=Math.min(b,M),j=Math.max(b,M),J=C.from-H,_=C.to-j;(J==0||J==1||H==0)&&(_==0||_==-1||j==e.state.doc.length)&&(b=0,M=e.state.doc.length)}this.newSel=m.OF.single(M,b)}}}function On(o,e){let t,{newSel:i}=e,s=o.state.selection.main,h=o.inputState.lastKeyTime>Date.now()-100?o.inputState.lastKeyCode:-1;if(e.bounds){let{from:d,to:y}=e.bounds,b=s.from,M=null;(h===8||A.android&&e.text.length<y-d)&&(b=s.to,M="end");let C=Jn(o.state.doc.sliceString(d,y,Nn),e.text,b-d,M);C&&(A.chrome&&h==13&&C.toB==C.from+2&&e.text.slice(C.from,C.toB)==Nn+Nn&&C.toB--,t={from:d+C.from,to:d+C.toA,insert:m.EY.of(e.text.slice(C.from,C.toB).split(Nn))})}else i&&(!o.hasFocus&&o.state.facet($i)||i.main.eq(s))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!s.empty&&i&&i.main.empty?t={from:s.from,to:s.to,insert:o.state.doc.slice(s.from,s.to)}:t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:o.state.doc.slice(s.from,t.from).append(t.insert).append(o.state.doc.slice(t.to,s.to))}:(A.mac||A.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&o.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=m.OF.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:m.EY.of([" "])}):A.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&o.lineWrapping&&(i&&(i=m.OF.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:m.EY.of([" "])}),t){if(A.ios&&o.inputState.flushIOSKey()||A.android&&(t.from==s.from&&t.to==s.to&&t.insert.length==1&&t.insert.lines==2&&ci(o.contentDOM,"Enter",13)||(t.from==s.from-1&&t.to==s.to&&t.insert.length==0||h==8&&t.insert.length<t.to-t.from&&t.to>s.head)&&ci(o.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&t.insert.length==0&&ci(o.contentDOM,"Delete",46)))return!0;let d=t.insert.toString();o.inputState.composing>=0&&o.inputState.composing++;let y,b=()=>y||(y=Yn(o,t,i));return o.state.facet(U).some(M=>M(o,t.from,t.to,d,b))||o.dispatch(b()),!0}else if(i&&!i.main.eq(s)){let d=!1,y="select";return o.inputState.lastSelectionTime>Date.now()-50&&(o.inputState.lastSelectionOrigin=="select"&&(d=!0),y=o.inputState.lastSelectionOrigin),o.dispatch({selection:i,scrollIntoView:d,userEvent:y}),!0}else return!1}function Yn(o,e,t){let i,s=o.state,h=s.selection.main;if(e.from>=h.from&&e.to<=h.to&&e.to-e.from>=(h.to-h.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&o.inputState.composing<0){let y=h.from<e.from?s.sliceDoc(h.from,e.from):"",b=h.to>e.to?s.sliceDoc(e.to,h.to):"";i=s.replaceSelection(o.state.toText(y+e.insert.sliceString(0,void 0,o.state.lineBreak)+b))}else{let y=s.changes(e),b=t&&t.main.to<=y.newLength?t.main:void 0;if(s.selection.ranges.length>1&&o.inputState.composing>=0&&e.to<=h.to&&e.to>=h.to-10){let M=o.state.sliceDoc(e.from,e.to),C,H=t&&Ns(o,t.main.head);if(H){let _=e.insert.length-(e.to-e.from);C={from:H.from,to:H.to-_}}else C=o.state.doc.lineAt(h.head);let j=h.to-e.to,J=h.to-h.from;i=s.changeByRange(_=>{if(_.from==h.from&&_.to==h.to)return{changes:y,range:b||_.map(y)};let ae=_.to-j,ne=ae-M.length;if(_.to-_.from!=J||o.state.sliceDoc(ne,ae)!=M||_.to>=C.from&&_.from<=C.to)return{range:_};let de=s.changes({from:ne,to:ae,insert:e.insert}),$e=_.to-h.to;return{changes:de,range:b?m.OF.range(Math.max(0,b.anchor+$e),Math.max(0,b.head+$e)):_.map(de)}})}else i={changes:y,selection:b&&s.selection.replaceRange(b)}}let d="input.type";return(o.composing||o.inputState.compositionPendingChange&&o.inputState.compositionEndedAt>Date.now()-50)&&(o.inputState.compositionPendingChange=!1,d+=".compose",o.inputState.compositionFirstChange&&(d+=".start",o.inputState.compositionFirstChange=!1)),s.update(i,{userEvent:d,scrollIntoView:!0})}function Jn(o,e,t,i){let s=Math.min(o.length,e.length),h=0;for(;h<s&&o.charCodeAt(h)==e.charCodeAt(h);)h++;if(h==s&&o.length==e.length)return null;let d=o.length,y=e.length;for(;d>0&&y>0&&o.charCodeAt(d-1)==e.charCodeAt(y-1);)d--,y--;if(i=="end"){let b=Math.max(0,h-Math.min(d,y));t-=d+b-h}if(d<h&&o.length<e.length){let b=t<=h&&t>=d?h-t:0;h-=b,y=h+(y-d),d=h}else if(y<h){let b=t<=h&&t>=y?h-t:0;h-=b,d=h+(d-y),y=h}return{from:h,toA:d,toB:y}}function Fn(o){let e=[];if(o.root.activeElement!=o.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:h}=o.observer.selectionRange;return t&&(e.push(new As(t,i)),(s!=t||h!=i)&&e.push(new As(s,h))),e}function ns(o,e){if(o.length==0)return null;let t=o[0].pos,i=o.length==2?o[1].pos:t;return t>-1&&i>-1?m.OF.single(t+e,i+e):null}const Fs={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},bi=A.ie&&A.ie_version<=11;class mn{constructor(e){this.view=e,this.active=!1,this.selectionRange=new Li,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(A.ie&&A.ie_version<=11||A.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),bi&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet($i)?i.root.activeElement!=this.dom:!_e(i.dom,s))return;let h=s.anchorNode&&i.docView.nearest(s.anchorNode);if(h&&h.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(A.ie&&A.ie_version<=11||A.android&&A.chrome)&&!i.state.selection.main.empty&&s.focusNode&&fi(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=A.safari&&e.root.nodeType==11&&it(this.dom.ownerDocument)==this.dom&&gn(this.view)||xt(e.root);if(!t||this.selectionRange.eq(t))return!1;let i=_e(this.dom,t);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Ye(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Fs),bi&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),bi&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let s=()=>{let h=this.delayedAndroidKey;h&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=h.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&h.force&&ci(this.dom,h.key,h.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,s=!1;for(let h of e){let d=this.readMutation(h);d&&(d.typeOver&&(s=!0),t==-1?{from:t,to:i}=d:(t=Math.min(d.from,t),i=Math.max(d.to,i)))}return{from:t,to:i,typeOver:s}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),s=this.selectionChanged&&_e(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let h=new In(this.view,e,t,i);return this.view.docView.domChanged={newSel:h.newSel?h.newSel.main:null},h}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,s=On(this.view,t);return this.view.state==i&&this.view.update([]),s}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let i=Hn(t,e.previousSibling||e.target.previousSibling,-1),s=Hn(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function Hn(o,e,t){for(;e;){let i=xe.get(e);if(i&&i.parent==o)return i;let s=e.parentNode;e=s!=o.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function gn(o){let e=null;function t(b){b.preventDefault(),b.stopImmediatePropagation(),e=b.getTargetRanges()[0]}if(o.contentDOM.addEventListener("beforeinput",t,!0),o.dom.ownerDocument.execCommand("indent"),o.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let i=e.startContainer,s=e.startOffset,h=e.endContainer,d=e.endOffset,y=o.docView.domAtPos(o.state.selection.main.anchor);return fi(y.node,y.offset,h,d)&&([i,s,h,d]=[h,d,i,s]),{anchorNode:i,anchorOffset:s,focusNode:h,focusOffset:d}}class Rt{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:t}=e;this.dispatchTransactions=e.dispatchTransactions||t&&(i=>i.forEach(s=>t(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||ii(e.parent)||document,this.viewState=new Cn(e.state||m.$t.create(e)),e.scrollTo&&e.scrollTo.is(De)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(un).map(i=>new kn(i));for(let i of this.plugins)i.update(this);this.observer=new mn(this),this.inputState=new no(this),this.inputState.ensureHandlers(this.plugins),this.docView=new es(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let t=e.length==1&&e[0]instanceof m.ZX?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,s,h=this.state;for(let j of e){if(j.startState!=h)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");h=j.state}if(this.destroyed){this.viewState.state=h;return}let d=this.hasFocus,y=0,b=null;e.some(j=>j.annotation(ie))?(this.inputState.notifiedFocused=d,y=1):d!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=d,b=fe(h,d),b||(y=1));let M=this.observer.delayedAndroidKey,C=null;if(M?(this.observer.clearDelayedAndroidKey(),C=this.observer.readChange(),(C&&!this.state.doc.eq(h.doc)||!this.state.selection.eq(h.selection))&&(C=null)):this.observer.clear(),h.facet(m.$t.phrases)!=this.state.facet(m.$t.phrases))return this.setState(h);s=_n.create(this,h,e),s.flags|=y;let H=this.viewState.scrollTarget;try{this.updateState=2;for(let j of e){if(H&&(H=H.map(j.changes)),j.scrollIntoView){let{main:J}=j.state.selection;H=new Re(J.empty?J:m.OF.cursor(J.head,J.head>J.anchor?-1:1))}for(let J of j.effects)J.is(De)&&(H=J.value.clip(this.state))}this.viewState.update(s,H),this.bidiCache=Cs.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(Ln)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(j=>j.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(En)!=s.state.facet(En)&&(this.viewState.mustMeasureContent=!0),(t||i||H||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!s.empty)for(let j of this.state.facet(W))try{j(s)}catch(J){Nt(this.state,J,"update listener")}(b||C)&&Promise.resolve().then(()=>{b&&this.state==b.startState&&this.dispatch(b),C&&!On(this,C)&&M.force&&ci(this.contentDOM,M.key,M.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Cn(e),this.plugins=e.facet(un).map(i=>new kn(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new es(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(un),i=e.state.facet(un);if(t!=i){let s=[];for(let h of i){let d=t.indexOf(h);if(d<0)s.push(new kn(h));else{let y=this.plugins[d];y.mustUpdate=e,s.push(y)}}for(let h of this.plugins)h.mustUpdate!=e&&h.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:h,scrollAnchorHeight:d}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(d=-1),this.viewState.scrollAnchorHeight=-1;try{for(let y=0;;y++){if(d<0)if(Ti(i))h=-1,d=this.viewState.heightMap.height;else{let J=this.viewState.scrollAnchorAt(s);h=J.from,d=J.top}this.updateState=1;let b=this.viewState.measure(this);if(!b&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(y>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let M=[];b&4||([this.measureRequests,M]=[M,this.measureRequests]);let C=M.map(J=>{try{return J.read(this)}catch(_){return Nt(this.state,_),tr}}),H=_n.create(this,this.state,[]),j=!1;H.flags|=b,t?t.flags|=b:t=H,this.updateState=2,H.empty||(this.updatePlugins(H),this.inputState.update(H),this.updateAttrs(),j=this.docView.update(H));for(let J=0;J<M.length;J++)if(C[J]!=tr)try{let _=M[J];_.write&&_.write(C[J],this)}catch(_){Nt(this.state,_)}if(j&&this.docView.updateSelection(!0),!H.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,d=-1;continue}else{let _=(h<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(h).top)-d;if(_>1||_<-1){s=s+_,i.scrollTop=s/this.scaleY,d=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let y of this.state.facet(W))y(t)}get themeClasses(){return Tn+" "+(this.state.facet(Wi)?ws:pn)+" "+this.state.facet(En)}updateAttrs(){let e=ss(this,ds,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet($i)?"true":"false",class:"cm-content",style:`${A.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),ss(this,zn,t);let i=this.observer.ignore(()=>{let s=Kt(this.contentDOM,this.contentAttrs,t),h=Kt(this.dom,this.editorAttrs,e);return s||h});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let s of i.effects)if(s.is(Rt.announce)){t&&(this.announceDOM.textContent=""),t=!1;let h=this.announceDOM.appendChild(document.createElement("div"));h.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Ln);let e=this.state.facet(Rt.cspNonce);Se.G.mount(this.root,this.styleModules.concat(_s).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return lr(this,e,Bn(this,e,t,i))}moveByGroup(e,t){return lr(this,e,Bn(this,e,t,i=>ys(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),s=this.textDirectionAt(e.from),h=i[t?i.length-1:0];return m.OF.cursor(h.side(t,s)+e.from,h.forward(!t,s)?1:-1)}moveToLineBoundary(e,t,i=!0){return Vn(this,e,t,i)}moveVertically(e,t,i){return lr(this,e,Co(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),gi(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),h=this.bidiSpans(s),d=h[Ii.find(h,e-s.from,-1,t)];return Yt(i,d.dir==bt.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ue)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>er)return us(e.length);let t=this.textDirectionAt(e.from),i;for(let h of this.bidiCache)if(h.from==e.from&&h.dir==t&&(h.fresh||Oi(h.isolates,i=ms(this,e))))return h.order;i||(i=ms(this,e));let s=Ls(e.text,t,i);return this.bidiCache.push(new Cs(e.from,e.to,t,i,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||A.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Lt(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return De.of(new Re(typeof e=="number"?m.OF.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return De.of(new Re(m.OF.cursor(i.from),"start","start",i.top-e,t,!0))}static domEventHandlers(e){return Ai.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Ai.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=Se.G.newName(),s=[En.of(i),Ln.of(cn(`.${i}`,e))];return t&&t.dark&&s.push(Wi.of(!0)),s}static baseTheme(e){return m.Nb.lowest(Ln.of(cn("."+Tn,e,Ss)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),s=i&&xe.get(i)||xe.get(e);return((t=s==null?void 0:s.rootView)===null||t===void 0?void 0:t.view)||null}}Rt.styleModule=Ln,Rt.inputHandler=U,Rt.focusChangeEffect=se,Rt.perLineTextDirection=ue,Rt.exceptionSink=D,Rt.updateListener=W,Rt.editable=$i,Rt.mouseSelectionStyle=O,Rt.dragMovesSelection=x,Rt.clickAddsSelectionRange=v,Rt.decorations=Rn,Rt.outerDecorations=Bs,Rt.atomicRanges=ps,Rt.bidiIsolatedRanges=Ys,Rt.scrollMargins=An,Rt.darkTheme=Wi,Rt.cspNonce=m.sj.define({combine:o=>o.length?o[0]:""}),Rt.contentAttributes=zn,Rt.editorAttributes=ds,Rt.lineWrapping=Rt.contentAttributes.of({class:"cm-lineWrapping"}),Rt.announce=m.Pe.define();const er=4096,tr={};class Cs{constructor(e,t,i,s,h,d){this.from=e,this.to=t,this.dir=i,this.isolates=s,this.fresh=h,this.order=d}static update(e,t){if(t.empty&&!e.some(h=>h.fresh))return e;let i=[],s=e.length?e[e.length-1].dir:bt.LTR;for(let h=Math.max(0,e.length-10);h<e.length;h++){let d=e[h];d.dir==s&&!t.touchesRange(d.from,d.to)&&i.push(new Cs(t.mapPos(d.from,1),t.mapPos(d.to,-1),d.dir,d.isolates,!1,d.order))}return i}}function ss(o,e,t){for(let i=o.state.facet(e),s=i.length-1;s>=0;s--){let h=i[s],d=typeof h=="function"?h(o):h;d&&ft(d,t)}return t}const qi=A.mac?"mac":A.windows?"win":A.linux?"linux":"key";function Pe(o,e){const t=o.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let s,h,d,y;for(let b=0;b<t.length-1;++b){const M=t[b];if(/^(cmd|meta|m)$/i.test(M))y=!0;else if(/^a(lt)?$/i.test(M))s=!0;else if(/^(c|ctrl|control)$/i.test(M))h=!0;else if(/^s(hift)?$/i.test(M))d=!0;else if(/^mod$/i.test(M))e=="mac"?y=!0:h=!0;else throw new Error("Unrecognized modifier name: "+M)}return s&&(i="Alt-"+i),h&&(i="Ctrl-"+i),y&&(i="Meta-"+i),d&&(i="Shift-"+i),i}function Qt(o,e,t){return e.altKey&&(o="Alt-"+o),e.ctrlKey&&(o="Ctrl-"+o),e.metaKey&&(o="Meta-"+o),t!==!1&&e.shiftKey&&(o="Shift-"+o),o}const rs=m.Nb.default(Rt.domEventHandlers({keydown(o,e){return ir(zr(e.state),o,e,"editor")}})),os=m.sj.define({enables:rs}),dr=new WeakMap;function zr(o){let e=o.facet(os),t=dr.get(e);return t||dr.set(e,t=lo(e.reduce((i,s)=>i.concat(s),[]))),t}function Hs(o,e,t){return ir(zr(o.state),e,o,t)}let ki=null;const Ms=4e3;function lo(o,e=qi){let t=Object.create(null),i=Object.create(null),s=(d,y)=>{let b=i[d];if(b==null)i[d]=y;else if(b!=y)throw new Error("Key binding "+d+" is used both as a regular binding and as a multi-stroke prefix")},h=(d,y,b,M,C)=>{var H,j;let J=t[d]||(t[d]=Object.create(null)),_=y.split(/ (?!$)/).map(de=>Pe(de,e));for(let de=1;de<_.length;de++){let $e=_.slice(0,de).join(" ");s($e,!0),J[$e]||(J[$e]={preventDefault:!0,stopPropagation:!1,run:[pt=>{let Ge=ki={view:pt,prefix:$e,scope:d};return setTimeout(()=>{ki==Ge&&(ki=null)},Ms),!0}]})}let ae=_.join(" ");s(ae,!1);let ne=J[ae]||(J[ae]={preventDefault:!1,stopPropagation:!1,run:((j=(H=J._any)===null||H===void 0?void 0:H.run)===null||j===void 0?void 0:j.slice())||[]});b&&ne.run.push(b),M&&(ne.preventDefault=!0),C&&(ne.stopPropagation=!0)};for(let d of o){let y=d.scope?d.scope.split(" "):["editor"];if(d.any)for(let M of y){let C=t[M]||(t[M]=Object.create(null));C._any||(C._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let H in C)C[H].run.push(d.any)}let b=d[e]||d.key;if(b)for(let M of y)h(M,b,d.run,d.preventDefault,d.stopPropagation),d.shift&&h(M,"Shift-"+b,d.shift,d.preventDefault,d.stopPropagation)}return t}function ir(o,e,t,i){let s=ht(e),h=(0,m.vS)(s,0),d=(0,m.Fh)(h)==s.length&&s!=" ",y="",b=!1,M=!1,C=!1;ki&&ki.view==t&&ki.scope==i&&(y=ki.prefix+" ",jn.indexOf(e.keyCode)<0&&(M=!0,ki=null));let H=new Set,j=ne=>{if(ne){for(let de of ne.run)if(!H.has(de)&&(H.add(de),de(t,e)))return ne.stopPropagation&&(C=!0),!0;ne.preventDefault&&(ne.stopPropagation&&(C=!0),M=!0)}return!1},J=o[i],_,ae;return J&&(j(J[y+Qt(s,e,!d)])?b=!0:d&&(e.altKey||e.metaKey||e.ctrlKey)&&!(A.windows&&e.ctrlKey&&e.altKey)&&(_=he[e.keyCode])&&_!=s?(j(J[y+Qt(_,e,!0)])||e.shiftKey&&(ae=B[e.keyCode])!=s&&ae!=_&&j(J[y+Qt(ae,e,!1)]))&&(b=!0):d&&e.shiftKey&&j(J[y+Qt(s,e,!0)])&&(b=!0),!b&&j(J._any)&&(b=!0)),M&&(b=!0),b&&C&&e.stopPropagation(),b}class Xn{constructor(e,t,i,s,h){this.className=e,this.left=t,this.top=i,this.width=s,this.height=h}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let s=e.coordsAtPos(i.head,i.assoc||1);if(!s)return[];let h=zi(e);return[new Xn(t,s.left-h.left,s.top-h.top,null,s.bottom-s.top)]}else return ls(e,t,i)}}function zi(o){let e=o.scrollDOM.getBoundingClientRect();return{left:(o.textDirection==bt.LTR?e.left:e.right-o.scrollDOM.clientWidth*o.scaleX)-o.scrollDOM.scrollLeft*o.scaleX,top:e.top-o.scrollDOM.scrollTop*o.scaleY}}function pr(o,e,t){let i=m.OF.cursor(e);return{from:Math.max(t.from,o.moveToLineBoundary(i,!1,!0).from),to:Math.min(t.to,o.moveToLineBoundary(i,!0,!0).from),type:nt.Text}}function ls(o,e,t){if(t.to<=o.viewport.from||t.from>=o.viewport.to)return[];let i=Math.max(t.from,o.viewport.from),s=Math.min(t.to,o.viewport.to),h=o.textDirection==bt.LTR,d=o.contentDOM,y=d.getBoundingClientRect(),b=zi(o),M=d.querySelector(".cm-line"),C=M&&window.getComputedStyle(M),H=y.left+(C?parseInt(C.paddingLeft)+Math.min(0,parseInt(C.textIndent)):0),j=y.right-(C?parseInt(C.paddingRight):0),J=an(o,i),_=an(o,s),ae=J.type==nt.Text?J:null,ne=_.type==nt.Text?_:null;if(ae&&(o.lineWrapping||J.widgetLineBreaks)&&(ae=pr(o,i,ae)),ne&&(o.lineWrapping||_.widgetLineBreaks)&&(ne=pr(o,s,ne)),ae&&ne&&ae.from==ne.from)return $e(pt(t.from,t.to,ae));{let mt=ae?pt(t.from,null,ae):Ge(J,!1),Ot=ne?pt(null,t.to,ne):Ge(_,!0),Vi=[];return(ae||J).to<(ne||_).from-(ae&&ne?1:0)||J.widgetLineBreaks>1&&mt.bottom+o.defaultLineHeight/2<Ot.top?Vi.push(de(H,mt.bottom,j,Ot.top)):mt.bottom<Ot.top&&o.elementAtHeight((mt.bottom+Ot.top)/2).type==nt.Text&&(mt.bottom=Ot.top=(mt.bottom+Ot.top)/2),$e(mt).concat(Vi).concat($e(Ot))}function de(mt,Ot,Vi,_i){return new Xn(e,mt-b.left,Ot-b.top-.01,Vi-mt,_i-Ot+.01)}function $e({top:mt,bottom:Ot,horizontal:Vi}){let _i=[];for(let Es=0;Es<Vi.length;Es+=2)_i.push(de(Vi[Es],mt,Vi[Es+1],Ot));return _i}function pt(mt,Ot,Vi){let _i=1e9,Es=-1e9,_r=[];function Vo(Us,Ts,rr,Os,Er){let r=o.coordsAtPos(Us,Us==Vi.to?-2:2),n=o.coordsAtPos(rr,rr==Vi.from?2:-2);!r||!n||(_i=Math.min(r.top,n.top,_i),Es=Math.max(r.bottom,n.bottom,Es),Er==bt.LTR?_r.push(h&&Ts?H:r.left,h&&Os?j:n.right):_r.push(!h&&Os?H:n.left,!h&&Ts?j:r.right))}let Mr=mt!=null?mt:Vi.from,eo=Ot!=null?Ot:Vi.to;for(let Us of o.visibleRanges)if(Us.to>Mr&&Us.from<eo)for(let Ts=Math.max(Us.from,Mr),rr=Math.min(Us.to,eo);;){let Os=o.state.doc.lineAt(Ts);for(let Er of o.bidiSpans(Os)){let r=Er.from+Os.from,n=Er.to+Os.from;if(r>=rr)break;n>Ts&&Vo(Math.max(r,Ts),mt==null&&r<=Mr,Math.min(n,rr),Ot==null&&n>=eo,Er.dir)}if(Ts=Os.to+1,Ts>=rr)break}return _r.length==0&&Vo(Mr,mt==null,eo,Ot==null,o.textDirection),{top:_i,bottom:Es,horizontal:_r}}function Ge(mt,Ot){let Vi=y.top+(Ot?mt.top:mt.bottom);return{top:Vi,bottom:Vi,horizontal:[]}}}function qe(o,e){return o.constructor==e.constructor&&o.eq(e)}class Ee{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Ce)!=e.state.facet(Ce)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}setOrder(e){let t=0,i=e.facet(Ce);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!qe(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let s of e)s.update&&t&&s.constructor&&this.drawn[i].constructor&&s.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(s.draw(),t);for(;t;){let s=t.nextSibling;t.remove(),t=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Ce=m.sj.define();function je(o){return[Ai.define(e=>new Ee(e,o)),Ce.of(o)]}const At=!A.ios,Ct=m.sj.define({combine(o){return(0,m.QR)(o,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function xi(o={}){return[Ct.of(o),mr,gr,Ko,ve.of(!0)]}function Mi(o){return o.facet(Ct)}function fn(o){return o.startState.facet(Ct)!=o.state.facet(Ct)}const mr=je({above:!0,markers(o){let{state:e}=o,t=e.facet(Ct),i=[];for(let s of e.selection.ranges){let h=s==e.selection.main;if(s.empty?!h||At:t.drawRangeCursor){let d=h?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",y=s.empty?s:m.OF.cursor(s.head,s.head>s.anchor?-1:1);for(let b of Xn.forRange(o,d,y))i.push(b)}}return i},update(o,e){o.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=fn(o);return t&&Ws(o.state,e),o.docChanged||o.selectionSet||t},mount(o,e){Ws(e.state,o)},class:"cm-cursorLayer"});function Ws(o,e){e.style.animationDuration=o.facet(Ct).cursorBlinkRate+"ms"}const gr=je({above:!1,markers(o){return o.state.selection.ranges.map(e=>e.empty?[]:Xn.forRange(o,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(o,e){return o.docChanged||o.selectionSet||o.viewportChanged||fn(o)},class:"cm-selectionLayer"}),ao={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};At&&(ao[".cm-line"].caretColor="transparent !important",ao[".cm-content"]={caretColor:"transparent !important"});const Ko=m.Nb.highest(Rt.theme(ao)),zs=m.Pe.define({map(o,e){return o==null?null:e.mapPos(o)}}),as=m.sU.define({create(){return null},update(o,e){return o!=null&&(o=e.changes.mapPos(o)),e.effects.reduce((t,i)=>i.is(zs)?i.value:t,o)}}),Uo=Ai.fromClass(class{constructor(o){this.view=o,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(o){var e;let t=o.state.field(as);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(o.startState.field(as)!=t||o.docChanged||o.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:o}=this,e=o.state.field(as),t=e!=null&&o.coordsAtPos(e);if(!t)return null;let i=o.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+o.scrollDOM.scrollLeft*o.scaleX,top:t.top-i.top+o.scrollDOM.scrollTop*o.scaleY,height:t.bottom-t.top}}drawCursor(o){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;o?(this.cursor.style.left=o.left/e+"px",this.cursor.style.top=o.top/t+"px",this.cursor.style.height=o.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(o){this.view.state.field(as)!=o&&this.view.dispatch({effects:zs.of(o)})}},{eventObservers:{dragover(o){this.setDropPos(this.view.posAtCoords({x:o.clientX,y:o.clientY}))},dragleave(o){(o.target==this.view.contentDOM||!this.view.contentDOM.contains(o.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Vs(){return[as,Uo]}function Vr(o,e,t,i,s){e.lastIndex=0;for(let h=o.iterRange(t,i),d=t,y;!h.next().done;d+=h.value.length)if(!h.lineBreak)for(;y=e.exec(h.value);)s(d+y.index,y)}function Go(o,e){let t=o.visibleRanges;if(t.length==1&&t[0].from==o.viewport.from&&t[0].to==o.viewport.to)return t;let i=[];for(let{from:s,to:h}of t)s=Math.max(o.state.doc.lineAt(s).from,s-e),h=Math.min(o.state.doc.lineAt(h).to,h+e),i.length&&i[i.length-1].to>=s?i[i.length-1].to=h:i.push({from:s,to:h});return i}class jr{constructor(e){const{regexp:t,decoration:i,decorate:s,boundary:h,maxLength:d=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,s)this.addMatch=(y,b,M,C)=>s(C,M,M+y[0].length,y,b);else if(typeof i=="function")this.addMatch=(y,b,M,C)=>{let H=i(y,b,M);H&&C(M,M+y[0].length,H)};else if(i)this.addMatch=(y,b,M,C)=>C(M,M+y[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=h,this.maxLength=d}createDeco(e){let t=new m.vB,i=t.add.bind(t);for(let{from:s,to:h}of Go(e,this.maxLength))Vr(e.state.doc,this.regexp,s,h,(d,y)=>this.addMatch(y,e,d,i));return t.finish()}updateDeco(e,t){let i=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((h,d,y,b)=>{b>e.view.viewport.from&&y<e.view.viewport.to&&(i=Math.min(y,i),s=Math.max(b,s))}),e.viewportChanged||s-i>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),i,s):t}updateRange(e,t,i,s){for(let h of e.visibleRanges){let d=Math.max(h.from,i),y=Math.min(h.to,s);if(y>d){let b=e.state.doc.lineAt(d),M=b.to<y?e.state.doc.lineAt(y):b,C=Math.max(h.from,b.from),H=Math.min(h.to,M.to);if(this.boundary){for(;d>b.from;d--)if(this.boundary.test(b.text[d-1-b.from])){C=d;break}for(;y<M.to;y++)if(this.boundary.test(M.text[y-M.from])){H=y;break}}let j=[],J,_=(ae,ne,de)=>j.push(de.range(ae,ne));if(b==M)for(this.regexp.lastIndex=C-b.from;(J=this.regexp.exec(b.text))&&J.index<H-b.from;)this.addMatch(J,e,J.index+b.from,_);else Vr(e.state.doc,this.regexp,C,H,(ae,ne)=>this.addMatch(ne,e,ae,_));t=t.update({filterFrom:C,filterTo:H,filter:(ae,ne)=>ae<C||ne>H,add:j})}}return t}}const ho=/x/.unicode!=null?"gu":"g",Yo=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,ho),Jo={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Mo=null;function xl(){var o;if(Mo==null&&typeof document!="undefined"&&document.body){let e=document.body.style;Mo=((o=e.tabSize)!==null&&o!==void 0?o:e.MozTabSize)!=null}return Mo||!1}const $r=m.sj.define({combine(o){let e=(0,m.QR)(o,{render:null,specialChars:Yo,addSpecialChars:null});return(e.replaceTabs=!xl())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,ho)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,ho)),e}});function Eo(o={}){return[$r.of(o),wl()]}let To=null;function wl(){return To||(To=Ai.fromClass(class{constructor(o){this.view=o,this.decorations=Xe.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(o.state.facet($r)),this.decorations=this.decorator.createDeco(o)}makeDecorator(o){return new jr({regexp:o.specialChars,decoration:(e,t,i)=>{let{doc:s}=t.state,h=(0,m.vS)(e[0],0);if(h==9){let d=s.lineAt(i),y=t.state.tabSize,b=(0,m.y$)(d.text,y,i-d.from);return Xe.replace({widget:new Do((y-b%y)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[h]||(this.decorationCache[h]=Xe.replace({widget:new Oo(o,h)}))},boundary:o.replaceTabs?void 0:/[^]/})}update(o){let e=o.state.facet($r);o.startState.facet($r)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(o.view)):this.decorations=this.decorator.updateDeco(o,this.decorations)}},{decorations:o=>o.decorations}))}const Xo="\u2022";function Zo(o){return o>=32?Xo:o==10?"\u2424":String.fromCharCode(9216+o)}class Oo extends Si{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Zo(this.code),i=e.state.phrase("Control character")+" "+(Jo[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,t);if(s)return s;let h=document.createElement("span");return h.textContent=t,h.title=i,h.setAttribute("aria-label",i),h.className="cm-specialChar",h}ignoreEvent(){return!1}}class Do extends Si{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const Po=null;function qo(){return[Po,zn.of(o=>{var e;return((e=o.plugin(Po))===null||e===void 0?void 0:e.attrs)||null})]}function Ro(){return yr}const Sl=Xe.line({class:"cm-activeLine"}),yr=Ai.fromClass(class{constructor(o){this.decorations=this.getDeco(o)}update(o){(o.docChanged||o.selectionSet)&&(this.decorations=this.getDeco(o.view))}getDeco(o){let e=-1,t=[];for(let i of o.state.selection.ranges){let s=o.lineBlockAt(i.head);s.from>e&&(t.push(Sl.range(s.from)),e=s.from)}return Xe.set(t)}},{decorations:o=>o.decorations});class js extends Si{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){let t=e.firstChild?gt(e.firstChild):[];if(!t.length)return null;let i=window.getComputedStyle(e.parentNode),s=Yt(t[0],i.direction!="rtl"),h=parseInt(i.lineHeight);return s.bottom-s.top>h*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+h}:s}ignoreEvent(){return!1}}function co(o){return Ai.fromClass(class{constructor(e){this.view=e,this.placeholder=o?Xe.set([Xe.widget({widget:new js(o),side:1}).range(0)]):Xe.none}get decorations(){return this.view.state.doc.length?Xe.none:this.placeholder}},{decorations:e=>e.decorations})}const Kr=2e3;function Qo(o,e,t){let i=Math.min(e.line,t.line),s=Math.max(e.line,t.line),h=[];if(e.off>Kr||t.off>Kr||e.col<0||t.col<0){let d=Math.min(e.off,t.off),y=Math.max(e.off,t.off);for(let b=i;b<=s;b++){let M=o.doc.line(b);M.length<=y&&h.push(m.OF.range(M.from+d,M.to+y))}}else{let d=Math.min(e.col,t.col),y=Math.max(e.col,t.col);for(let b=i;b<=s;b++){let M=o.doc.line(b),C=(0,m.kn)(M.text,d,o.tabSize,!0);if(C<0)h.push(m.OF.cursor(M.to));else{let H=(0,m.kn)(M.text,y,o.tabSize);h.push(m.OF.range(M.from+C,M.from+H))}}}return h}function fo(o,e){let t=o.coordsAtPos(o.viewport.from);return t?Math.round(Math.abs((t.left-e)/o.defaultCharacterWidth)):-1}function uo(o,e){let t=o.posAtCoords({x:e.clientX,y:e.clientY},!1),i=o.state.doc.lineAt(t),s=t-i.from,h=s>Kr?-1:s==i.length?fo(o,e.clientX):(0,m.y$)(i.text,o.state.tabSize,t-i.from);return{line:i.number,col:h,off:s}}function Lo(o,e){let t=uo(o,e),i=o.state.selection;return t?{update(s){if(s.docChanged){let h=s.changes.mapPos(s.startState.doc.line(t.line).from),d=s.state.doc.lineAt(h);t={line:d.number,col:t.col,off:Math.min(t.off,d.length)},i=i.map(s.changes)}},get(s,h,d){let y=uo(o,s);if(!y)return i;let b=Qo(o.state,t,y);return b.length?d?m.OF.create(b.concat(i.ranges)):m.OF.create(b):i}}:null}function _o(o){let e=(o==null?void 0:o.eventFilter)||(t=>t.altKey&&t.button==0);return Rt.mouseSelectionStyle.of((t,i)=>e(i)?Lo(t,i):null)}const el={Alt:[18,o=>!!o.altKey],Control:[17,o=>!!o.ctrlKey],Shift:[16,o=>!!o.shiftKey],Meta:[91,o=>!!o.metaKey]},kl={style:"cursor: crosshair"};function tl(o={}){let[e,t]=el[o.key||"Alt"],i=Ai.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)},mousemove(s){this.set(t(s))}}});return[i,Rt.contentAttributes.of(s=>{var h;return!((h=s.plugin(i))===null||h===void 0)&&h.isDown?kl:null})]}const vr="-10000px";class po{constructor(e,t,i,s){this.facet=t,this.createTooltipView=i,this.removeTooltipView=s,this.input=e.state.facet(t),this.tooltips=this.input.filter(d=>d);let h=null;this.tooltipViews=this.tooltips.map(d=>h=i(d,h))}update(e,t){var i;let s=e.state.facet(this.facet),h=s.filter(b=>b);if(s===this.input){for(let b of this.tooltipViews)b.update&&b.update(e);return!1}let d=[],y=t?[]:null;for(let b=0;b<h.length;b++){let M=h[b],C=-1;if(M){for(let H=0;H<this.tooltips.length;H++){let j=this.tooltips[H];j&&j.create==M.create&&(C=H)}if(C<0)d[b]=this.createTooltipView(M,b?d[b-1]:null),y&&(y[b]=!!M.above);else{let H=d[b]=this.tooltipViews[C];y&&(y[b]=t[C]),H.update&&H.update(e)}}}for(let b of this.tooltipViews)d.indexOf(b)<0&&(this.removeTooltipView(b),(i=b.destroy)===null||i===void 0||i.call(b));return t&&(y.forEach((b,M)=>t[M]=b),t.length=y.length),this.input=s,this.tooltips=h,this.tooltipViews=d,!0}}function mo(o={}){return Ur.of(o)}function il(o){let{win:e}=o;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Ur=m.sj.define({combine:o=>{var e,t,i;return{position:A.ios?"absolute":((e=o.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=o.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=o.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||il}}}),Bo=new WeakMap,Gr=Ai.fromClass(class{constructor(o){this.view=o,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=o.state.facet(Ur);this.position=e.position,this.parent=e.parent,this.classes=o.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new po(o,Yr,(t,i)=>this.createTooltip(t,i),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),o.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let o of this.manager.tooltipViews)this.intersectionObserver.observe(o.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(o){o.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(o,this.above);e&&this.observeIntersection();let t=e||o.geometryChanged,i=o.state.facet(Ur);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(o,e){let t=o.create(this.view),i=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),o.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",t.dom.insertBefore(s,i)}return t.dom.style.position=this.position,t.dom.style.top=vr,t.dom.style.left="0px",this.container.insertBefore(t.dom,i),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var o,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(o=i.destroy)===null||o===void 0||o.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let o=this.view.dom.getBoundingClientRect(),e=1,t=1,i=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(A.gecko)i=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==vr&&s.style.left=="0px"){let h=s.getBoundingClientRect();i=Math.abs(h.top+1e4)>1||Math.abs(h.left)>1}}if(i||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(e=s.width/this.parent.offsetWidth,t=s.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);return{editor:o,parent:this.parent?this.container.getBoundingClientRect():o,pos:this.manager.tooltips.map((s,h)=>{let d=this.manager.tooltipViews[h];return d.getCoords?d.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(Ur).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:i}}writeMeasure(o){var e;if(o.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let y of this.manager.tooltipViews)y.dom.style.position="absolute"}let{editor:t,space:i,scaleX:s,scaleY:h}=o,d=[];for(let y=0;y<this.manager.tooltips.length;y++){let b=this.manager.tooltips[y],M=this.manager.tooltipViews[y],{dom:C}=M,H=o.pos[y],j=o.size[y];if(!H||H.bottom<=Math.max(t.top,i.top)||H.top>=Math.min(t.bottom,i.bottom)||H.right<Math.max(t.left,i.left)-.1||H.left>Math.min(t.right,i.right)+.1){C.style.top=vr;continue}let J=b.arrow?M.dom.querySelector(".cm-tooltip-arrow"):null,_=J?7:0,ae=j.right-j.left,ne=(e=Bo.get(M))!==null&&e!==void 0?e:j.bottom-j.top,de=M.offset||nl,$e=this.view.textDirection==bt.LTR,pt=j.width>i.right-i.left?$e?i.left:i.right-j.width:$e?Math.min(H.left-(J?14:0)+de.x,i.right-ae):Math.max(i.left,H.left-ae+(J?14:0)-de.x),Ge=this.above[y];!b.strictSide&&(Ge?H.top-(j.bottom-j.top)-de.y<i.top:H.bottom+(j.bottom-j.top)+de.y>i.bottom)&&Ge==i.bottom-H.bottom>H.top-i.top&&(Ge=this.above[y]=!Ge);let mt=(Ge?H.top-i.top:i.bottom-H.bottom)-_;if(mt<ne&&M.resize!==!1){if(mt<this.view.defaultLineHeight){C.style.top=vr;continue}Bo.set(M,ne),C.style.height=(ne=mt)/h+"px"}else C.style.height&&(C.style.height="");let Ot=Ge?H.top-ne-_-de.y:H.bottom+_+de.y,Vi=pt+ae;if(M.overlap!==!0)for(let _i of d)_i.left<Vi&&_i.right>pt&&_i.top<Ot+ne&&_i.bottom>Ot&&(Ot=Ge?_i.top-ne-2-_:_i.bottom+_+2);if(this.position=="absolute"?(C.style.top=(Ot-o.parent.top)/h+"px",C.style.left=(pt-o.parent.left)/s+"px"):(C.style.top=Ot/h+"px",C.style.left=pt/s+"px"),J){let _i=H.left+($e?de.x:-de.x)-(pt+14-7);J.style.left=_i/s+"px"}M.overlap!==!0&&d.push({left:pt,top:Ot,right:Vi,bottom:Ot+ne}),C.classList.toggle("cm-tooltip-above",Ge),C.classList.toggle("cm-tooltip-below",!Ge),M.positioned&&M.positioned(o.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let o of this.manager.tooltipViews)o.dom.style.top=vr}},{eventObservers:{scroll(){this.maybeMeasure()}}}),No=Rt.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),nl={x:0,y:0},Yr=m.sj.define({enables:[Gr,No]}),br=m.sj.define({combine:o=>o.reduce((e,t)=>e.concat(t),[])});class xr{static create(e){return new xr(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new po(e,br,(t,i)=>this.createHostedView(t,i),t=>t.dom.remove())}createHostedView(e,t){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let i of this.manager.tooltipViews){let s=i[e];if(s!==void 0){if(t===void 0)t=s;else if(t!==s)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const sl=Yr.compute([br],o=>{let e=o.facet(br);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var i;return(i=t.end)!==null&&i!==void 0?i:t.pos})),create:xr.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Al{constructor(e,t,i,s,h){this.view=e,this.source=t,this.field=i,this.setHover=s,this.hoverTime=h,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,i=e.docView.nearest(t.target);if(!i)return;let s,h=1;if(i instanceof re)s=i.posAtStart;else{if(s=e.posAtCoords(t),s==null)return;let y=e.coordsAtPos(s);if(!y||t.y<y.top||t.y>y.bottom||t.x<y.left-e.defaultCharacterWidth||t.x>y.right+e.defaultCharacterWidth)return;let b=e.bidiSpans(e.state.doc.lineAt(s)).find(C=>C.from<=s&&C.to>=s),M=b&&b.dir==bt.RTL?-1:1;h=t.x<y.left?-M:M}let d=this.source(e,s,h);if(d!=null&&d.then){let y=this.pending={pos:s};d.then(b=>{this.pending==y&&(this.pending=null,b&&!(Array.isArray(b)&&!b.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(b)?b:[b])}))},b=>Nt(e.state,b,"hover tooltip"))}else d&&!(Array.isArray(d)&&!d.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(d)?d:[d])})}get tooltip(){let e=this.view.plugin(Gr),t=e?e.manager.tooltips.findIndex(i=>i.create==xr.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:h}=this;if(s.length&&h&&!Cl(h.dom,e)||this.pending){let{pos:d}=s[0]||this.pending,y=(i=(t=s[0])===null||t===void 0?void 0:t.end)!==null&&i!==void 0?i:d;(d==y?this.view.posAtCoords(this.lastMove)!=d:!Ml(this.view,d,y,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=i=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const wr=4;function Cl(o,e){let t=o.getBoundingClientRect();return e.clientX>=t.left-wr&&e.clientX<=t.right+wr&&e.clientY>=t.top-wr&&e.clientY<=t.bottom+wr}function Ml(o,e,t,i,s,h){let d=o.scrollDOM.getBoundingClientRect(),y=o.documentTop+o.documentPadding.top+o.contentHeight;if(d.left>i||d.right<i||d.top>s||Math.min(d.bottom,y)<s)return!1;let b=o.posAtCoords({x:i,y:s},!1);return b>=e&&b<=t}function El(o,e={}){let t=m.Pe.define(),i=m.sU.define({create(){return[]},update(s,h){if(s.length&&(e.hideOnChange&&(h.docChanged||h.selection)?s=[]:e.hideOn&&(s=s.filter(d=>!e.hideOn(h,d))),h.docChanged)){let d=[];for(let y of s){let b=h.changes.mapPos(y.pos,-1,m.iR.TrackDel);if(b!=null){let M=Object.assign(Object.create(null),y);M.pos=b,M.end!=null&&(M.end=h.changes.mapPos(M.end)),d.push(M)}}s=d}for(let d of h.effects)d.is(t)&&(s=d.value),d.is($s)&&(s=[]);return s},provide:s=>br.from(s)});return[i,Ai.define(s=>new Al(s,o,i,t,e.hoverTime||300)),sl]}function Tl(o,e){let t=o.plugin(Gr);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}function Ol(o){return o.facet(br).some(e=>e)}const $s=m.Pe.define(),Sr=null;function rl(o){let e=o.plugin(Gr);e&&e.maybeMeasure()}const Jr=m.sj.define({combine(o){let e,t;for(let i of o)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Pl(o){return o?[Jr.of(o)]:[]}function Xr(o,e){let t=o.plugin(Zr),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const Zr=Ai.fromClass(class{constructor(o){this.input=o.state.facet(Io),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(o));let e=o.state.facet(Jr);this.top=new kr(o,!0,e.topContainer),this.bottom=new kr(o,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(o){let e=o.state.facet(Jr);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new kr(o.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new kr(o.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=o.state.facet(Io);if(t!=this.input){let i=t.filter(b=>b),s=[],h=[],d=[],y=[];for(let b of i){let M=this.specs.indexOf(b),C;M<0?(C=b(o.view),y.push(C)):(C=this.panels[M],C.update&&C.update(o)),s.push(C),(C.top?h:d).push(C)}this.specs=i,this.panels=s,this.top.sync(h),this.bottom.sync(d);for(let b of y)b.dom.classList.add("cm-panel"),b.mount&&b.mount()}else for(let i of this.panels)i.update&&i.update(o)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:o=>Rt.scrollMargins.of(e=>{let t=e.plugin(o);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class kr{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Qi(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Qi(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Qi(o){let e=o.nextSibling;return o.remove(),e}const Io=m.sj.define({enables:Zr});class hs extends m.FB{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}hs.prototype.elementClass="",hs.prototype.toDOM=void 0,hs.prototype.mapMode=m.iR.TrackBefore,hs.prototype.startSide=hs.prototype.endSide=-1,hs.prototype.point=!0;const qr=m.sj.define(),Fo={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>m.om.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Ar=m.sj.define();function Ho(o){return[ol(),Ar.of(Object.assign(Object.assign({},Fo),o))]}const go=m.sj.define({combine:o=>o.some(e=>e)});function ol(o){let e=[ll];return o&&o.fixed===!1&&e.push(go.of(!0)),e}const ll=Ai.fromClass(class{constructor(o){this.view=o,this.prevViewport=o.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=o.state.facet(Ar).map(e=>new al(o,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!o.state.facet(go),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),o.scrollDOM.insertBefore(this.dom,o.contentDOM)}update(o){if(this.updateGutters(o)){let e=this.prevViewport,t=o.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}o.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(go)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=o.view.viewport}syncGutters(o){let e=this.dom.nextSibling;o&&this.dom.remove();let t=m.om.iter(this.view.state.facet(qr),this.view.viewport.from),i=[],s=this.gutters.map(h=>new Dl(h,this.view.viewport,-this.view.documentPadding.top));for(let h of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(h.type)){let d=!0;for(let y of h.type)if(y.type==nt.Text&&d){Cr(t,i,y.from);for(let b of s)b.line(this.view,y,i);d=!1}else if(y.widget)for(let b of s)b.widget(this.view,y)}else if(h.type==nt.Text){Cr(t,i,h.from);for(let d of s)d.line(this.view,h,i)}else if(h.widget)for(let d of s)d.widget(this.view,h);for(let h of s)h.finish();o&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(o){let e=o.startState.facet(Ar),t=o.state.facet(Ar),i=o.docChanged||o.heightChanged||o.viewportChanged||!m.om.eq(o.startState.facet(qr),o.state.facet(qr),o.view.viewport.from,o.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(o)&&(i=!0);else{i=!0;let s=[];for(let h of t){let d=e.indexOf(h);d<0?s.push(new al(this.view,h)):(this.gutters[d].update(o),s.push(this.gutters[d]))}for(let h of this.gutters)h.dom.remove(),s.indexOf(h)<0&&h.destroy();for(let h of s)this.dom.appendChild(h.dom);this.gutters=s}return i}destroy(){for(let o of this.gutters)o.destroy();this.dom.remove()}},{provide:o=>Rt.scrollMargins.of(e=>{let t=e.plugin(o);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==bt.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function yo(o){return Array.isArray(o)?o:[o]}function Cr(o,e,t){for(;o.value&&o.from<=t;)o.from==t&&e.push(o.value),o.next()}class Dl{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=m.om.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:s}=this,h=(t.top-this.height)/e.scaleY,d=t.height/e.scaleY;if(this.i==s.elements.length){let y=new vo(e,d,h,i);s.elements.push(y),s.dom.appendChild(y.dom)}else s.elements[this.i].update(e,d,h,i);this.height=t.bottom,this.i++}line(e,t,i){let s=[];Cr(this.cursor,s,t.from),i.length&&(s=s.concat(i));let h=this.gutter.config.lineMarker(e,t,s);h&&s.unshift(h);let d=this.gutter;s.length==0&&!d.config.renderEmptyElements||this.addElement(e,t,s)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t);i&&this.addElement(e,t,[i])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class al{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,s=>{let h=s.target,d;if(h!=this.dom&&this.dom.contains(h)){for(;h.parentNode!=this.dom;)h=h.parentNode;let b=h.getBoundingClientRect();d=(b.top+b.bottom)/2}else d=s.clientY;let y=e.lineBlockAtHeight(d-e.documentTop);t.domEventHandlers[i](e,y,s)&&s.preventDefault()});this.markers=yo(t.markers(e)),t.initialSpacer&&(this.spacer=new vo(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=yo(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let i=e.view.viewport;return!m.om.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class vo{constructor(e,t,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,s)}update(e,t,i,s){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),Wo(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let i="cm-gutterElement",s=this.dom.firstChild;for(let h=0,d=0;;){let y=d,b=h<t.length?t[h++]:null,M=!1;if(b){let C=b.elementClass;C&&(i+=" "+C);for(let H=d;H<this.markers.length;H++)if(this.markers[H].compare(b)){y=H,M=!0;break}}else y=this.markers.length;for(;d<y;){let C=this.markers[d++];if(C.toDOM){C.destroy(s);let H=s.nextSibling;s.remove(),s=H}}if(!b)break;b.toDOM&&(M?s=s.nextSibling:this.dom.insertBefore(b.toDOM(e),s)),M&&d++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function Wo(o,e){if(o.length!=e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].compare(e[t]))return!1;return!0}const hl=m.sj.define(),Ks=m.sj.define({combine(o){return(0,m.QR)(o,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let s in t){let h=i[s],d=t[s];i[s]=h?(y,b,M)=>h(y,b,M)||d(y,b,M):d}return i}})}});class nr extends hs{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function sr(o,e){return o.state.facet(Ks).formatNumber(e,o.state)}const Qr=Ar.compute([Ks],o=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(hl)},lineMarker(e,t,i){return i.some(s=>s.toDOM)?null:new nr(sr(e,e.state.doc.lineAt(t.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(Ks)!=e.state.facet(Ks),initialSpacer(e){return new nr(sr(e,bo(e.state.doc.lines)))},updateSpacer(e,t){let i=sr(t.view,bo(t.view.state.doc.lines));return i==e.number?e:new nr(i)},domEventHandlers:o.facet(Ks).domEventHandlers}));function cl(o={}){return[Ks.of(o),ol(),Qr]}function bo(o){let e=9;for(;e<o;)e=e*10+9;return e}const fl=new class extends hs{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},ul=qr.compute(["selection"],o=>{let e=[],t=-1;for(let i of o.selection.ranges){let s=o.doc.lineAt(i.head).from;s>t&&(t=s,e.push(fl.range(s)))}return m.om.of(e)});function dl(){return ul}const zo=new Map;function pl(o){let e=zo.get(o);return e||zo.set(o,e=Xe.mark({attributes:o==="	"?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":o.replace(/ /g,"\xB7")}})),e}function xo(o){return Ai.define(e=>({decorations:o.createDeco(e),update(t){this.decorations=o.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}const wo=xo(new jr({regexp:/\t| +/g,decoration:o=>pl(o[0]),boundary:/\S/}));function ml(){return wo}const gl=xo(new jr({regexp:/\s+$/g,decoration:Xe.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function yl(){return gl}const So={HeightMap:Ue,HeightOracle:kt,MeasuredHeights:Ze,QueryType:ke,ChangedRange:Ki,computeOrder:Ls,moveVisually:a}},79066:(yn,Wt,q)=>{q.d(Wt,{PH:()=>it,Qj:()=>Ke,Z6:()=>Fe,fI:()=>wt,iX:()=>Je,rr:()=>Ti,uY:()=>B});const m=1024;let Se=0;class he{constructor(S,A){this.from=S,this.to=A}}class B{constructor(S={}){this.id=Se++,this.perNode=!!S.perNode,this.deserialize=S.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(S){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof S!="function"&&(S=Fe.match(S)),A=>{let I=S(A);return I===void 0?null:[this,I]}}}B.closedBy=new B({deserialize:te=>te.split(" ")}),B.openedBy=new B({deserialize:te=>te.split(" ")}),B.group=new B({deserialize:te=>te.split(" ")}),B.isolate=new B({deserialize:te=>{if(te&&te!="rtl"&&te!="ltr"&&te!="auto")throw new RangeError("Invalid value for isolate: "+te);return te||"auto"}}),B.contextHash=new B({perNode:!0}),B.lookAhead=new B({perNode:!0}),B.mounted=new B({perNode:!0});class X{constructor(S,A,I){this.tree=S,this.overlay=A,this.parser=I}static get(S){return S&&S.props&&S.props[B.mounted.id]}}const Ae=Object.create(null);class Fe{constructor(S,A,I,F=0){this.name=S,this.props=A,this.id=I,this.flags=F}static define(S){let A=S.props&&S.props.length?Object.create(null):Ae,I=(S.top?1:0)|(S.skipped?2:0)|(S.error?4:0)|(S.name==null?8:0),F=new Fe(S.name||"",A,S.id,I);if(S.props){for(let $ of S.props)if(Array.isArray($)||($=$(F)),$){if($[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");A[$[0].id]=$[1]}}return F}prop(S){return this.props[S.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(S){if(typeof S=="string"){if(this.name==S)return!0;let A=this.prop(B.group);return A?A.indexOf(S)>-1:!1}return this.id==S}static match(S){let A=Object.create(null);for(let I in S)for(let F of I.split(" "))A[F]=S[I];return I=>{for(let F=I.prop(B.group),$=-1;$<(F?F.length:0);$++){let ee=A[$<0?I.name:F[$]];if(ee)return ee}}}}Fe.none=new Fe("",Object.create(null),0,8);class wt{constructor(S){this.types=S;for(let A=0;A<S.length;A++)if(S[A].id!=A)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...S){let A=[];for(let I of this.types){let F=null;for(let $ of S){let ee=$(I);ee&&(F||(F=Object.assign({},I.props)),F[ee[0].id]=ee[1])}A.push(F?new Fe(I.name,F,I.id,I.flags):I)}return new wt(A)}}const ht=new WeakMap,xt=new WeakMap;var Ke;(function(te){te[te.ExcludeBuffers=1]="ExcludeBuffers",te[te.IncludeAnonymous=2]="IncludeAnonymous",te[te.IgnoreMounts=4]="IgnoreMounts",te[te.IgnoreOverlays=8]="IgnoreOverlays"})(Ke||(Ke={}));class it{constructor(S,A,I,F,$){if(this.type=S,this.children=A,this.positions=I,this.length=F,this.props=null,$&&$.length){this.props=Object.create(null);for(let[ee,re]of $)this.props[typeof ee=="number"?ee:ee.id]=re}}toString(){let S=X.get(this);if(S&&!S.overlay)return S.tree.toString();let A="";for(let I of this.children){let F=I.toString();F&&(A&&(A+=","),A+=F)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(A.length?"("+A+")":""):A}cursor(S=0){return new Lt(this.topNode,S)}cursorAt(S,A=0,I=0){let F=ht.get(this)||this.topNode,$=new Lt(F);return $.moveTo(S,A),ht.set(this,$._tree),$}get topNode(){return new ct(this,0,0,null)}resolve(S,A=0){let I=Zt(ht.get(this)||this.topNode,S,A,!1);return ht.set(this,I),I}resolveInner(S,A=0){let I=Zt(xt.get(this)||this.topNode,S,A,!0);return xt.set(this,I),I}resolveStack(S,A=0){return It(this,S,A)}iterate(S){let{enter:A,leave:I,from:F=0,to:$=this.length}=S,ee=S.mode||0,re=(ee&Ke.IncludeAnonymous)>0;for(let we=this.cursor(ee|Ke.IncludeAnonymous);;){let He=!1;if(we.from<=$&&we.to>=F&&(!re&&we.type.isAnonymous||A(we)!==!1)){if(we.firstChild())continue;He=!0}for(;He&&I&&(re||!we.type.isAnonymous)&&I(we),!we.nextSibling();){if(!we.parent())return;He=!0}}}prop(S){return S.perNode?this.props?this.props[S.id]:void 0:this.type.prop(S)}get propValues(){let S=[];if(this.props)for(let A in this.props)S.push([+A,this.props[A]]);return S}balance(S={}){return this.children.length<=8?this:ni(Fe.none,this.children,this.positions,0,this.children.length,0,this.length,(A,I,F)=>new it(this.type,A,I,F,this.propValues),S.makeTree||((A,I,F)=>new it(Fe.none,A,I,F)))}static build(S){return St(S)}}it.empty=new it(Fe.none,[],[],0);class _e{constructor(S,A){this.buffer=S,this.index=A}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new _e(this.buffer,this.index)}}class gt{constructor(S,A,I){this.buffer=S,this.length=A,this.set=I}get type(){return Fe.none}toString(){let S=[];for(let A=0;A<this.buffer.length;)S.push(this.childString(A)),A=this.buffer[A+3];return S.join(",")}childString(S){let A=this.buffer[S],I=this.buffer[S+3],F=this.set.types[A],$=F.name;if(/\W/.test($)&&!F.isError&&($=JSON.stringify($)),S+=4,I==S)return $;let ee=[];for(;S<I;)ee.push(this.childString(S)),S=this.buffer[S+3];return $+"("+ee.join(",")+")"}findChild(S,A,I,F,$){let{buffer:ee}=this,re=-1;for(let we=S;we!=A&&!(fi($,F,ee[we+1],ee[we+2])&&(re=we,I>0));we=ee[we+3]);return re}slice(S,A,I){let F=this.buffer,$=new Uint16Array(A-S),ee=0;for(let re=S,we=0;re<A;){$[we++]=F[re++],$[we++]=F[re++]-I;let He=$[we++]=F[re++]-I;$[we++]=F[re++]-S,ee=Math.max(ee,He)}return new gt($,ee,this.set)}}function fi(te,S,A,I){switch(te){case-2:return A<S;case-1:return I>=S&&A<S;case 0:return A<S&&I>S;case 1:return A<=S&&I>S;case 2:return I>S;case 4:return!0}}function Zt(te,S,A,I){for(var F;te.from==te.to||(A<1?te.from>=S:te.from>S)||(A>-1?te.to<=S:te.to<S);){let ee=!I&&te instanceof ct&&te.index<0?null:te.parent;if(!ee)return te;te=ee}let $=I?0:Ke.IgnoreOverlays;if(I)for(let ee=te,re=ee.parent;re;ee=re,re=ee.parent)ee instanceof ct&&ee.index<0&&((F=re.enter(S,A,$))===null||F===void 0?void 0:F.from)!=ee.from&&(te=re);for(;;){let ee=te.enter(S,A,$);if(!ee)return te;te=ee}}class ge{cursor(S=0){return new Lt(this,S)}getChild(S,A=null,I=null){let F=Yt(this,S,A,I);return F.length?F[0]:null}getChildren(S,A=null,I=null){return Yt(this,S,A,I)}resolve(S,A=0){return Zt(this,S,A,!1)}resolveInner(S,A=0){return Zt(this,S,A,!0)}matchContext(S){return wi(this,S)}enterUnfinishedNodesBefore(S){let A=this.childBefore(S),I=this;for(;A;){let F=A.lastChild;if(!F||F.to!=A.to)break;F.type.isError&&F.from==F.to?(I=A,A=F.prevSibling):A=F}return I}get node(){return this}get next(){return this.parent}}class ct extends ge{constructor(S,A,I,F){super(),this._tree=S,this.from=A,this.index=I,this._parent=F}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(S,A,I,F,$=0){for(let ee=this;;){for(let{children:re,positions:we}=ee._tree,He=A>0?re.length:-1;S!=He;S+=A){let Le=re[S],Qe=we[S]+ee.from;if(fi(F,I,Qe,Qe+Le.length)){if(Le instanceof gt){if($&Ke.ExcludeBuffers)continue;let tt=Le.findChild(0,Le.buffer.length,A,I-Qe,F);if(tt>-1)return new Dt(new ui(ee,Le,S,Qe),null,tt)}else if($&Ke.IncludeAnonymous||!Le.type.isAnonymous||Pt(Le)){let tt;if(!($&Ke.IgnoreMounts)&&(tt=X.get(Le))&&!tt.overlay)return new ct(tt.tree,Qe,S,ee);let ft=new ct(Le,Qe,S,ee);return $&Ke.IncludeAnonymous||!ft.type.isAnonymous?ft:ft.nextChild(A<0?Le.children.length-1:0,A,I,F)}}}if($&Ke.IncludeAnonymous||!ee.type.isAnonymous||(ee.index>=0?S=ee.index+A:S=A<0?-1:ee._parent._tree.children.length,ee=ee._parent,!ee))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(S){return this.nextChild(0,1,S,2)}childBefore(S){return this.nextChild(this._tree.children.length-1,-1,S,-2)}enter(S,A,I=0){let F;if(!(I&Ke.IgnoreOverlays)&&(F=X.get(this._tree))&&F.overlay){let $=S-this.from;for(let{from:ee,to:re}of F.overlay)if((A>0?ee<=$:ee<$)&&(A<0?re>=$:re>$))return new ct(F.tree,F.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,S,A,I)}nextSignificantParent(){let S=this;for(;S.type.isAnonymous&&S._parent;)S=S._parent;return S}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Yt(te,S,A,I){let F=te.cursor(),$=[];if(!F.firstChild())return $;if(A!=null){for(let ee=!1;!ee;)if(ee=F.type.is(A),!F.nextSibling())return $}for(;;){if(I!=null&&F.type.is(I))return $;if(F.type.is(S)&&$.push(F.node),!F.nextSibling())return I==null?$:[]}}function wi(te,S,A=S.length-1){for(let I=te.parent;A>=0;I=I.parent){if(!I)return!1;if(!I.type.isAnonymous){if(S[A]&&S[A]!=I.name)return!1;A--}}return!0}class ui{constructor(S,A,I,F){this.parent=S,this.buffer=A,this.index=I,this.start=F}}class Dt extends ge{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(S,A,I){super(),this.context=S,this._parent=A,this.index=I,this.type=S.buffer.set.types[S.buffer.buffer[I]]}child(S,A,I){let{buffer:F}=this.context,$=F.findChild(this.index+4,F.buffer[this.index+3],S,A-this.context.start,I);return $<0?null:new Dt(this.context,this,$)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(S){return this.child(1,S,2)}childBefore(S){return this.child(-1,S,-2)}enter(S,A,I=0){if(I&Ke.ExcludeBuffers)return null;let{buffer:F}=this.context,$=F.findChild(this.index+4,F.buffer[this.index+3],A>0?1:-1,S-this.context.start,A);return $<0?null:new Dt(this.context,this,$)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(S){return this._parent?null:this.context.parent.nextChild(this.context.index+S,S,0,4)}get nextSibling(){let{buffer:S}=this.context,A=S.buffer[this.index+3];return A<(this._parent?S.buffer[this._parent.index+3]:S.buffer.length)?new Dt(this.context,this._parent,A):this.externalSibling(1)}get prevSibling(){let{buffer:S}=this.context,A=this._parent?this._parent.index+4:0;return this.index==A?this.externalSibling(-1):new Dt(this.context,this._parent,S.findChild(A,this.index,-1,0,4))}get tree(){return null}toTree(){let S=[],A=[],{buffer:I}=this.context,F=this.index+4,$=I.buffer[this.index+3];if($>F){let ee=I.buffer[this.index+1];S.push(I.slice(F,$,ee)),A.push(0)}return new it(this.type,S,A,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function di(te){if(!te.length)return null;let S=0,A=te[0];for(let $=1;$<te.length;$++){let ee=te[$];(ee.from>A.from||ee.to<A.to)&&(A=ee,S=$)}let I=A instanceof ct&&A.index<0?null:A.parent,F=te.slice();return I?F[S]=I:F.splice(S,1),new Li(F,A)}class Li{constructor(S,A){this.heads=S,this.node=A}get next(){return di(this.heads)}}function It(te,S,A){let I=te.resolveInner(S,A),F=null;for(let $=I instanceof ct?I:I.context.parent;$;$=$.parent)if($.index<0){let ee=$.parent;(F||(F=[I])).push(ee.resolve(S,A)),$=ee}else{let ee=X.get($.tree);if(ee&&ee.overlay&&ee.overlay[0].from<=S&&ee.overlay[ee.overlay.length-1].to>=S){let re=new ct(ee.tree,ee.overlay[0].from+$.from,-1,$);(F||(F=[I])).push(Zt(re,S,A,!1))}}return F?di(F):I}class Lt{get name(){return this.type.name}constructor(S,A=0){if(this.mode=A,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,S instanceof ct)this.yieldNode(S);else{this._tree=S.context.parent,this.buffer=S.context;for(let I=S._parent;I;I=I._parent)this.stack.unshift(I.index);this.bufferNode=S,this.yieldBuf(S.index)}}yieldNode(S){return S?(this._tree=S,this.type=S.type,this.from=S.from,this.to=S.to,!0):!1}yieldBuf(S,A){this.index=S;let{start:I,buffer:F}=this.buffer;return this.type=A||F.set.types[F.buffer[S]],this.from=I+F.buffer[S+1],this.to=I+F.buffer[S+2],!0}yield(S){return S?S instanceof ct?(this.buffer=null,this.yieldNode(S)):(this.buffer=S.context,this.yieldBuf(S.index,S.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(S,A,I){if(!this.buffer)return this.yield(this._tree.nextChild(S<0?this._tree._tree.children.length-1:0,S,A,I,this.mode));let{buffer:F}=this.buffer,$=F.findChild(this.index+4,F.buffer[this.index+3],S,A-this.buffer.start,I);return $<0?!1:(this.stack.push(this.index),this.yieldBuf($))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(S){return this.enterChild(1,S,2)}childBefore(S){return this.enterChild(-1,S,-2)}enter(S,A,I=this.mode){return this.buffer?I&Ke.ExcludeBuffers?!1:this.enterChild(1,S,A):this.yield(this._tree.enter(S,A,I))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ke.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let S=this.mode&Ke.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(S)}sibling(S){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+S,S,0,4,this.mode)):!1;let{buffer:A}=this.buffer,I=this.stack.length-1;if(S<0){let F=I<0?0:this.stack[I]+4;if(this.index!=F)return this.yieldBuf(A.findChild(F,this.index,-1,0,4))}else{let F=A.buffer[this.index+3];if(F<(I<0?A.buffer.length:A.buffer[this.stack[I]+3]))return this.yieldBuf(F)}return I<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+S,S,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(S){let A,I,{buffer:F}=this;if(F){if(S>0){if(this.index<F.buffer.buffer.length)return!1}else for(let $=0;$<this.index;$++)if(F.buffer.buffer[$+3]<this.index)return!1;({index:A,parent:I}=F)}else({index:A,_parent:I}=this._tree);for(;I;{index:A,_parent:I}=I)if(A>-1)for(let $=A+S,ee=S<0?-1:I._tree.children.length;$!=ee;$+=S){let re=I._tree.children[$];if(this.mode&Ke.IncludeAnonymous||re instanceof gt||!re.type.isAnonymous||Pt(re))return!1}return!0}move(S,A){if(A&&this.enterChild(S,0,4))return!0;for(;;){if(this.sibling(S))return!0;if(this.atLastNode(S)||!this.parent())return!1}}next(S=!0){return this.move(1,S)}prev(S=!0){return this.move(-1,S)}moveTo(S,A=0){for(;(this.from==this.to||(A<1?this.from>=S:this.from>S)||(A>-1?this.to<=S:this.to<S))&&this.parent(););for(;this.enterChild(1,S,A););return this}get node(){if(!this.buffer)return this._tree;let S=this.bufferNode,A=null,I=0;if(S&&S.context==this.buffer){e:for(let F=this.index,$=this.stack.length;$>=0;){for(let ee=S;ee;ee=ee._parent)if(ee.index==F){if(F==this.index)return ee;A=ee,I=$+1;break e}F=this.stack[--$]}}for(let F=I;F<this.stack.length;F++)A=new Dt(this.buffer,A,this.stack[F]);return this.bufferNode=new Dt(this.buffer,A,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(S,A){for(let I=0;;){let F=!1;if(this.type.isAnonymous||S(this)!==!1){if(this.firstChild()){I++;continue}this.type.isAnonymous||(F=!0)}for(;F&&A&&A(this),F=this.type.isAnonymous,!this.nextSibling();){if(!I)return;this.parent(),I--,F=!0}}}matchContext(S){if(!this.buffer)return wi(this.node,S);let{buffer:A}=this.buffer,{types:I}=A.set;for(let F=S.length-1,$=this.stack.length-1;F>=0;$--){if($<0)return wi(this.node,S,F);let ee=I[A.buffer[this.stack[$]]];if(!ee.isAnonymous){if(S[F]&&S[F]!=ee.name)return!1;F--}}return!0}}function Pt(te){return te.children.some(S=>S instanceof gt||!S.type.isAnonymous||Pt(S))}function St(te){var S;let{buffer:A,nodeSet:I,maxBufferLength:F=m,reused:$=[],minRepeatType:ee=I.types.length}=te,re=Array.isArray(A)?new _e(A,A.length):A,we=I.types,He=0,Le=0;function Qe(nt,Xe,We,Jt,rt,st){let{id:vt,start:ot,end:Gt,size:Ht}=re,ut=Le;for(;Ht<0;)if(re.next(),Ht==-1){let Ni=$[vt];We.push(Ni),Jt.push(ot-nt);return}else if(Ht==-3){He=vt;return}else if(Ht==-4){Le=vt;return}else throw new RangeError(`Unrecognized record size: ${Ht}`);let bt=we[vt],qt,pi,tn=ot-nt;if(Gt-ot<=F&&(pi=Kt(re.pos-Xe,rt))){let Ni=new Uint16Array(pi.size-pi.skip),Bt=re.pos-pi.size,ji=Ni.length;for(;re.pos>Bt;)ji=Ut(pi.start,Ni,ji);qt=new gt(Ni,Gt-pi.start,I),tn=pi.start-nt}else{let Ni=re.pos-Ht;re.next();let Bt=[],ji=[],li=vt>=ee?vt:-1,Zi=0,vn=Gt;for(;re.pos>Ni;)li>=0&&re.id==li&&re.size>=0?(re.end<=vn-F&&(si(Bt,ji,ot,Zi,re.end,vn,li,ut),Zi=Bt.length,vn=re.end),re.next()):st>2500?tt(ot,Ni,Bt,ji):Qe(ot,Ni,Bt,ji,li,st+1);if(li>=0&&Zi>0&&Zi<Bt.length&&si(Bt,ji,ot,Zi,ot,vn,li,ut),Bt.reverse(),ji.reverse(),li>-1&&Zi>0){let Ii=ft(bt);qt=ni(bt,Bt,ji,0,Bt.length,0,Gt-ot,Ii,Ii)}else qt=ei(bt,Bt,ji,Gt-ot,ut-Gt)}We.push(qt),Jt.push(tn)}function tt(nt,Xe,We,Jt){let rt=[],st=0,vt=-1;for(;re.pos>Xe;){let{id:ot,start:Gt,end:Ht,size:ut}=re;if(ut>4)re.next();else{if(vt>-1&&Gt<vt)break;vt<0&&(vt=Ht-F),rt.push(ot,Gt,Ht),st++,re.next()}}if(st){let ot=new Uint16Array(st*4),Gt=rt[rt.length-2];for(let Ht=rt.length-3,ut=0;Ht>=0;Ht-=3)ot[ut++]=rt[Ht],ot[ut++]=rt[Ht+1]-Gt,ot[ut++]=rt[Ht+2]-Gt,ot[ut++]=ut;We.push(new gt(ot,rt[2]-Gt,I)),Jt.push(Gt-nt)}}function ft(nt){return(Xe,We,Jt)=>{let rt=0,st=Xe.length-1,vt,ot;if(st>=0&&(vt=Xe[st])instanceof it){if(!st&&vt.type==nt&&vt.length==Jt)return vt;(ot=vt.prop(B.lookAhead))&&(rt=We[st]+vt.length+ot)}return ei(nt,Xe,We,Jt,rt)}}function si(nt,Xe,We,Jt,rt,st,vt,ot){let Gt=[],Ht=[];for(;nt.length>Jt;)Gt.push(nt.pop()),Ht.push(Xe.pop()+We-rt);nt.push(ei(I.types[vt],Gt,Ht,st-rt,ot-st)),Xe.push(rt-We)}function ei(nt,Xe,We,Jt,rt=0,st){if(He){let vt=[B.contextHash,He];st=st?[vt].concat(st):[vt]}if(rt>25){let vt=[B.lookAhead,rt];st=st?[vt].concat(st):[vt]}return new it(nt,Xe,We,Jt,st)}function Kt(nt,Xe){let We=re.fork(),Jt=0,rt=0,st=0,vt=We.end-F,ot={size:0,start:0,skip:0};e:for(let Gt=We.pos-nt;We.pos>Gt;){let Ht=We.size;if(We.id==Xe&&Ht>=0){ot.size=Jt,ot.start=rt,ot.skip=st,st+=4,Jt+=4,We.next();continue}let ut=We.pos-Ht;if(Ht<0||ut<Gt||We.start<vt)break;let bt=We.id>=ee?4:0,qt=We.start;for(We.next();We.pos>ut;){if(We.size<0)if(We.size==-3)bt+=4;else break e;else We.id>=ee&&(bt+=4);We.next()}rt=qt,Jt+=Ht,st+=bt}return(Xe<0||Jt==nt)&&(ot.size=Jt,ot.start=rt,ot.skip=st),ot.size>4?ot:void 0}function Ut(nt,Xe,We){let{id:Jt,start:rt,end:st,size:vt}=re;if(re.next(),vt>=0&&Jt<ee){let ot=We;if(vt>4){let Gt=re.pos-(vt-4);for(;re.pos>Gt;)We=Ut(nt,Xe,We)}Xe[--We]=ot,Xe[--We]=st-nt,Xe[--We]=rt-nt,Xe[--We]=Jt}else vt==-3?He=Jt:vt==-4&&(Le=Jt);return We}let Mt=[],Ft=[];for(;re.pos>0;)Qe(te.start||0,te.bufferStart||0,Mt,Ft,-1,0);let Si=(S=te.length)!==null&&S!==void 0?S:Mt.length?Ft[0]+Mt[0].length:0;return new it(we[te.topID],Mt.reverse(),Ft.reverse(),Si)}const ci=new WeakMap;function ii(te,S){if(!te.isAnonymous||S instanceof gt||S.type!=te)return 1;let A=ci.get(S);if(A==null){A=1;for(let I of S.children){if(I.type!=te||!(I instanceof it)){A=1;break}A+=ii(te,I)}ci.set(S,A)}return A}function ni(te,S,A,I,F,$,ee,re,we){let He=0;for(let si=I;si<F;si++)He+=ii(te,S[si]);let Le=Math.ceil(He*1.5/8),Qe=[],tt=[];function ft(si,ei,Kt,Ut,Mt){for(let Ft=Kt;Ft<Ut;){let Si=Ft,nt=ei[Ft],Xe=ii(te,si[Ft]);for(Ft++;Ft<Ut;Ft++){let We=ii(te,si[Ft]);if(Xe+We>=Le)break;Xe+=We}if(Ft==Si+1){if(Xe>Le){let We=si[Si];ft(We.children,We.positions,0,We.children.length,ei[Si]+Mt);continue}Qe.push(si[Si])}else{let We=ei[Ft-1]+si[Ft-1].length-nt;Qe.push(ni(te,si,ei,Si,Ft,nt,We,null,we))}tt.push(nt+Mt-$)}}return ft(S,A,I,F,0),(re||we)(Qe,tt,ee)}class Ye{constructor(){this.map=new WeakMap}setBuffer(S,A,I){let F=this.map.get(S);F||this.map.set(S,F=new Map),F.set(A,I)}getBuffer(S,A){let I=this.map.get(S);return I&&I.get(A)}set(S,A){S instanceof Dt?this.setBuffer(S.context.buffer,S.index,A):S instanceof ct&&this.map.set(S.tree,A)}get(S){return S instanceof Dt?this.getBuffer(S.context.buffer,S.index):S instanceof ct?this.map.get(S.tree):void 0}cursorSet(S,A){S.buffer?this.setBuffer(S.buffer.buffer,S.index,A):this.map.set(S.tree,A)}cursorGet(S){return S.buffer?this.getBuffer(S.buffer.buffer,S.index):this.map.get(S.tree)}}class Ti{constructor(S,A,I,F,$=!1,ee=!1){this.from=S,this.to=A,this.tree=I,this.offset=F,this.open=($?1:0)|(ee?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(S,A=[],I=!1){let F=[new Ti(0,S.length,S,0,!1,I)];for(let $ of A)$.to>S.length&&F.push($);return F}static applyChanges(S,A,I=128){if(!A.length)return S;let F=[],$=1,ee=S.length?S[0]:null;for(let re=0,we=0,He=0;;re++){let Le=re<A.length?A[re]:null,Qe=Le?Le.fromA:1e9;if(Qe-we>=I)for(;ee&&ee.from<Qe;){let tt=ee;if(we>=tt.from||Qe<=tt.to||He){let ft=Math.max(tt.from,we)-He,si=Math.min(tt.to,Qe)-He;tt=ft>=si?null:new Ti(ft,si,tt.tree,tt.offset+He,re>0,!!Le)}if(tt&&F.push(tt),ee.to>Qe)break;ee=$<S.length?S[$++]:null}if(!Le)break;we=Le.toA,He=Le.toA-Le.toB}return F}}class Je{startParse(S,A,I){return typeof S=="string"&&(S=new ce(S)),I=I?I.length?I.map(F=>new he(F.from,F.to)):[new he(0,0)]:[new he(0,S.length)],this.createParse(S,A||[],I)}parse(S,A,I){let F=this.startParse(S,A,I);for(;;){let $=F.advance();if($)return $}}}class ce{constructor(S){this.string=S}get length(){return this.string.length}chunk(S){return this.string.slice(S)}get lineChunks(){return!1}read(S,A){return this.string.slice(S,A)}}function xe(te){return(S,A,I,F)=>new Ne(S,te,A,I,F)}class ze{constructor(S,A,I,F,$){this.parser=S,this.parse=A,this.overlay=I,this.target=F,this.from=$}}function Me(te){if(!te.length||te.some(S=>S.from>=S.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(te))}class Oe{constructor(S,A,I,F,$,ee,re){this.parser=S,this.predicate=A,this.mounts=I,this.index=F,this.start=$,this.target=ee,this.prev=re,this.depth=0,this.ranges=[]}}const $t=new B({perNode:!0});class Ne{constructor(S,A,I,F,$){this.nest=A,this.input=I,this.fragments=F,this.ranges=$,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=S}advance(){if(this.baseParse){let I=this.baseParse.advance();if(!I)return null;if(this.baseParse=null,this.baseTree=I,this.startInner(),this.stoppedAt!=null)for(let F of this.inner)F.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let I=this.baseTree;return this.stoppedAt!=null&&(I=new it(I.type,I.children,I.positions,I.length,I.propValues.concat([[$t,this.stoppedAt]]))),I}let S=this.inner[this.innerDone],A=S.parse.advance();if(A){this.innerDone++;let I=Object.assign(Object.create(null),S.target.props);I[B.mounted.id]=new X(A,S.overlay,S.parser),S.target.props=I}return null}get parsedPos(){if(this.baseParse)return 0;let S=this.input.length;for(let A=this.innerDone;A<this.inner.length;A++)this.inner[A].from<S&&(S=Math.min(S,this.inner[A].parse.parsedPos));return S}stopAt(S){if(this.stoppedAt=S,this.baseParse)this.baseParse.stopAt(S);else for(let A=this.innerDone;A<this.inner.length;A++)this.inner[A].parse.stopAt(S)}startInner(){let S=new yt(this.fragments),A=null,I=null,F=new Lt(new ct(this.baseTree,this.ranges[0].from,0,null),Ke.IncludeAnonymous|Ke.IgnoreMounts);e:for(let $,ee;;){let re=!0,we;if(this.stoppedAt!=null&&F.from>=this.stoppedAt)re=!1;else if(S.hasNode(F)){if(A){let He=A.mounts.find(Le=>Le.frag.from<=F.from&&Le.frag.to>=F.to&&Le.mount.overlay);if(He)for(let Le of He.mount.overlay){let Qe=Le.from+He.pos,tt=Le.to+He.pos;Qe>=F.from&&tt<=F.to&&!A.ranges.some(ft=>ft.from<tt&&ft.to>Qe)&&A.ranges.push({from:Qe,to:tt})}}re=!1}else if(I&&(ee=_t(I.ranges,F.from,F.to)))re=ee!=2;else if(!F.type.isAnonymous&&($=this.nest(F,this.input))&&(F.from<F.to||!$.overlay)){F.tree||Bi(F);let He=S.findMounts(F.from,$.parser);if(typeof $.overlay=="function")A=new Oe($.parser,$.overlay,He,this.inner.length,F.from,F.tree,A);else{let Le=oi(this.ranges,$.overlay||(F.from<F.to?[new he(F.from,F.to)]:[]));Le.length&&Me(Le),(Le.length||!$.overlay)&&this.inner.push(new ze($.parser,Le.length?$.parser.startParse(this.input,Gi(He,Le),Le):$.parser.startParse(""),$.overlay?$.overlay.map(Qe=>new he(Qe.from-F.from,Qe.to-F.from)):null,F.tree,Le.length?Le[0].from:F.from)),$.overlay?Le.length&&(I={ranges:Le,depth:0,prev:I}):re=!1}}else A&&(we=A.predicate(F))&&(we===!0&&(we=new he(F.from,F.to)),we.from<we.to&&A.ranges.push(we));if(re&&F.firstChild())A&&A.depth++,I&&I.depth++;else for(;!F.nextSibling();){if(!F.parent())break e;if(A&&!--A.depth){let He=oi(this.ranges,A.ranges);He.length&&(Me(He),this.inner.splice(A.index,0,new ze(A.parser,A.parser.startParse(this.input,Gi(A.mounts,He),He),A.ranges.map(Le=>new he(Le.from-A.start,Le.to-A.start)),A.target,He[0].from))),A=A.prev}I&&!--I.depth&&(I=I.prev)}}}}function _t(te,S,A){for(let I of te){if(I.from>=A)break;if(I.to>S)return I.from<=S&&I.to>=A?2:1}return 0}function et(te,S,A,I,F,$){if(S<A){let ee=te.buffer[S+1];I.push(te.slice(S,A,ee)),F.push(ee-$)}}function Bi(te){let{node:S}=te,A=[],I=S.context.buffer;do A.push(te.index),te.parent();while(!te.tree);let F=te.tree,$=F.children.indexOf(I),ee=F.children[$],re=ee.buffer,we=[$];function He(Le,Qe,tt,ft,si,ei){let Kt=A[ei],Ut=[],Mt=[];et(ee,Le,Kt,Ut,Mt,ft);let Ft=re[Kt+1],Si=re[Kt+2];we.push(Ut.length);let nt=ei?He(Kt+4,re[Kt+3],ee.set.types[re[Kt]],Ft,Si-Ft,ei-1):S.toTree();return Ut.push(nt),Mt.push(Ft-ft),et(ee,re[Kt+3],Qe,Ut,Mt,ft),new it(tt,Ut,Mt,si)}F.children[$]=He(0,re.length,Fe.none,0,ee.length,A.length-1);for(let Le of we){let Qe=te.tree.children[Le],tt=te.tree.positions[Le];te.yield(new ct(Qe,tt+te.from,Le,te._tree))}}class zt{constructor(S,A){this.offset=A,this.done=!1,this.cursor=S.cursor(Ke.IncludeAnonymous|Ke.IgnoreMounts)}moveTo(S){let{cursor:A}=this,I=S-this.offset;for(;!this.done&&A.from<I;)A.to>=S&&A.enter(I,1,Ke.IgnoreOverlays|Ke.ExcludeBuffers)||A.next(!1)||(this.done=!0)}hasNode(S){if(this.moveTo(S.from),!this.done&&this.cursor.from+this.offset==S.from&&this.cursor.tree)for(let A=this.cursor.tree;;){if(A==S.tree)return!0;if(A.children.length&&A.positions[0]==0&&A.children[0]instanceof it)A=A.children[0];else break}return!1}}class yt{constructor(S){var A;if(this.fragments=S,this.curTo=0,this.fragI=0,S.length){let I=this.curFrag=S[0];this.curTo=(A=I.tree.prop($t))!==null&&A!==void 0?A:I.to,this.inner=new zt(I.tree,-I.offset)}else this.curFrag=this.inner=null}hasNode(S){for(;this.curFrag&&S.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=S.from&&this.curTo>=S.to&&this.inner.hasNode(S)}nextFrag(){var S;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let A=this.curFrag=this.fragments[this.fragI];this.curTo=(S=A.tree.prop($t))!==null&&S!==void 0?S:A.to,this.inner=new zt(A.tree,-A.offset)}}findMounts(S,A){var I;let F=[];if(this.inner){this.inner.cursor.moveTo(S,1);for(let $=this.inner.cursor.node;$;$=$.parent){let ee=(I=$.tree)===null||I===void 0?void 0:I.prop(B.mounted);if(ee&&ee.parser==A)for(let re=this.fragI;re<this.fragments.length;re++){let we=this.fragments[re];if(we.from>=$.to)break;we.tree==this.curFrag.tree&&F.push({frag:we,pos:$.from-we.offset,mount:ee})}}}return F}}function oi(te,S){let A=null,I=S;for(let F=1,$=0;F<te.length;F++){let ee=te[F-1].to,re=te[F].from;for(;$<I.length;$++){let we=I[$];if(we.from>=re)break;we.to<=ee||(A||(I=A=S.slice()),we.from<ee?(A[$]=new he(we.from,ee),we.to>re&&A.splice($+1,0,new he(re,we.to))):we.to>re?A[$--]=new he(re,we.to):A.splice($--,1))}}return I}function en(te,S,A,I){let F=0,$=0,ee=!1,re=!1,we=-1e9,He=[];for(;;){let Le=F==te.length?1e9:ee?te[F].to:te[F].from,Qe=$==S.length?1e9:re?S[$].to:S[$].from;if(ee!=re){let tt=Math.max(we,A),ft=Math.min(Le,Qe,I);tt<ft&&He.push(new he(tt,ft))}if(we=Math.min(Le,Qe),we==1e9)break;Le==we&&(ee?(ee=!1,F++):ee=!0),Qe==we&&(re?(re=!1,$++):re=!0)}return He}function Gi(te,S){let A=[];for(let{pos:I,mount:F,frag:$}of te){let ee=I+(F.overlay?F.overlay[0].from:0),re=ee+F.tree.length,we=Math.max($.from,ee),He=Math.min($.to,re);if(F.overlay){let Le=F.overlay.map(tt=>new he(tt.from+I,tt.to+I)),Qe=en(S,Le,we,He);for(let tt=0,ft=we;;tt++){let si=tt==Qe.length,ei=si?He:Qe[tt].from;if(ei>ft&&A.push(new Ti(ft,ei,F.tree,-ee,$.from>=ft||$.openStart,$.to<=ei||$.openEnd)),si)break;ft=Qe[tt].to}}else A.push(new Ti(we,He,F.tree,-ee,$.from>=ee||$.openStart,$.to<=re||$.openEnd))}return A}},49913:(yn,Wt,q)=>{q.d(Wt,{DM:()=>_e,_A:()=>Ye,az:()=>Ke,pn:()=>wt});var m=q(79066);let Se=0;class he{constructor(ce,xe,ze){this.set=ce,this.base=xe,this.modified=ze,this.id=Se++}static define(ce){if(ce!=null&&ce.base)throw new Error("Can not derive from a modified tag");let xe=new he([],null,[]);if(xe.set.push(xe),ce)for(let ze of ce.set)xe.set.push(ze);return xe}static defineModifier(){let ce=new X;return xe=>xe.modified.indexOf(ce)>-1?xe:X.get(xe.base||xe,xe.modified.concat(ce).sort((ze,Me)=>ze.id-Me.id))}}let B=0;class X{constructor(){this.instances=[],this.id=B++}static get(ce,xe){if(!xe.length)return ce;let ze=xe[0].instances.find(Ne=>Ne.base==ce&&Ae(xe,Ne.modified));if(ze)return ze;let Me=[],Oe=new he(Me,ce,xe);for(let Ne of xe)Ne.instances.push(Oe);let $t=Fe(xe);for(let Ne of ce.set)if(!Ne.modified.length)for(let _t of $t)Me.push(X.get(Ne,_t));return Oe}}function Ae(Je,ce){return Je.length==ce.length&&Je.every((xe,ze)=>xe==ce[ze])}function Fe(Je){let ce=[[]];for(let xe=0;xe<Je.length;xe++)for(let ze=0,Me=ce.length;ze<Me;ze++)ce.push(ce[ze].concat(Je[xe]));return ce.sort((xe,ze)=>ze.length-xe.length)}function wt(Je){let ce=Object.create(null);for(let xe in Je){let ze=Je[xe];Array.isArray(ze)||(ze=[ze]);for(let Me of xe.split(" "))if(Me){let Oe=[],$t=2,Ne=Me;for(let zt=0;;){if(Ne=="..."&&zt>0&&zt+3==Me.length){$t=1;break}let yt=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(Ne);if(!yt)throw new RangeError("Invalid path: "+Me);if(Oe.push(yt[0]=="*"?"":yt[0][0]=='"'?JSON.parse(yt[0]):yt[0]),zt+=yt[0].length,zt==Me.length)break;let oi=Me[zt++];if(zt==Me.length&&oi=="!"){$t=0;break}if(oi!="/")throw new RangeError("Invalid path: "+Me);Ne=Me.slice(zt)}let _t=Oe.length-1,et=Oe[_t];if(!et)throw new RangeError("Invalid path: "+Me);let Bi=new xt(ze,$t,_t>0?Oe.slice(0,_t):null);ce[et]=Bi.sort(ce[et])}}return ht.add(ce)}const ht=new m.uY;class xt{constructor(ce,xe,ze,Me){this.tags=ce,this.mode=xe,this.context=ze,this.next=Me}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(ce){return!ce||ce.depth<this.depth?(this.next=ce,this):(ce.next=this.sort(ce.next),ce)}get depth(){return this.context?this.context.length:0}}xt.empty=new xt([],2,null);function Ke(Je,ce){let xe=Object.create(null);for(let Oe of Je)if(!Array.isArray(Oe.tag))xe[Oe.tag.id]=Oe.class;else for(let $t of Oe.tag)xe[$t.id]=Oe.class;let{scope:ze,all:Me=null}=ce||{};return{style:Oe=>{let $t=Me;for(let Ne of Oe)for(let _t of Ne.set){let et=xe[_t.id];if(et){$t=$t?$t+" "+et:et;break}}return $t},scope:ze}}function it(Je,ce){let xe=null;for(let ze of Je){let Me=ze.style(ce);Me&&(xe=xe?xe+" "+Me:Me)}return xe}function _e(Je,ce,xe,ze=0,Me=Je.length){let Oe=new fi(ze,Array.isArray(ce)?ce:[ce],xe);Oe.highlightRange(Je.cursor(),ze,Me,"",Oe.highlighters),Oe.flush(Me)}function gt(Je,ce,xe,ze,Me,Oe=0,$t=Je.length){let Ne=Oe;function _t(et,Bi){if(!(et<=Ne)){for(let zt=Je.slice(Ne,et),yt=0;;){let oi=zt.indexOf(`
`,yt),en=oi<0?zt.length:oi;if(en>yt&&ze(zt.slice(yt,en),Bi),oi<0)break;Me(),yt=oi+1}Ne=et}}_e(ce,xe,(et,Bi,zt)=>{_t(et,""),_t(Bi,zt)},Oe,$t),_t($t,"")}class fi{constructor(ce,xe,ze){this.at=ce,this.highlighters=xe,this.span=ze,this.class=""}startSpan(ce,xe){xe!=this.class&&(this.flush(ce),ce>this.at&&(this.at=ce),this.class=xe)}flush(ce){ce>this.at&&this.class&&this.span(this.at,ce,this.class)}highlightRange(ce,xe,ze,Me,Oe){let{type:$t,from:Ne,to:_t}=ce;if(Ne>=ze||_t<=xe)return;$t.isTop&&(Oe=this.highlighters.filter(oi=>!oi.scope||oi.scope($t)));let et=Me,Bi=Zt(ce)||xt.empty,zt=it(Oe,Bi.tags);if(zt&&(et&&(et+=" "),et+=zt,Bi.mode==1&&(Me+=(Me?" ":"")+zt)),this.startSpan(Math.max(xe,Ne),et),Bi.opaque)return;let yt=ce.tree&&ce.tree.prop(m.uY.mounted);if(yt&&yt.overlay){let oi=ce.node.enter(yt.overlay[0].from+Ne,1),en=this.highlighters.filter(te=>!te.scope||te.scope(yt.tree.type)),Gi=ce.firstChild();for(let te=0,S=Ne;;te++){let A=te<yt.overlay.length?yt.overlay[te]:null,I=A?A.from+Ne:_t,F=Math.max(xe,S),$=Math.min(ze,I);if(F<$&&Gi)for(;ce.from<$&&(this.highlightRange(ce,F,$,Me,Oe),this.startSpan(Math.min($,ce.to),et),!(ce.to>=I||!ce.nextSibling())););if(!A||I>ze)break;S=A.to+Ne,S>xe&&(this.highlightRange(oi.cursor(),Math.max(xe,A.from+Ne),Math.min(ze,S),"",en),this.startSpan(Math.min(ze,S),et))}Gi&&ce.parent()}else if(ce.firstChild()){yt&&(Me="");do if(!(ce.to<=xe)){if(ce.from>=ze)break;this.highlightRange(ce,xe,ze,Me,Oe),this.startSpan(Math.min(ze,ce.to),et)}while(ce.nextSibling());ce.parent()}}}function Zt(Je){let ce=Je.type.prop(ht);for(;ce&&ce.context&&!Je.matchContext(ce.context);)ce=ce.next;return ce||null}const ge=he.define,ct=ge(),Yt=ge(),wi=ge(Yt),ui=ge(Yt),Dt=ge(),di=ge(Dt),Li=ge(Dt),It=ge(),Lt=ge(It),Pt=ge(),St=ge(),ci=ge(),ii=ge(ci),ni=ge(),Ye={comment:ct,lineComment:ge(ct),blockComment:ge(ct),docComment:ge(ct),name:Yt,variableName:ge(Yt),typeName:wi,tagName:ge(wi),propertyName:ui,attributeName:ge(ui),className:ge(Yt),labelName:ge(Yt),namespace:ge(Yt),macroName:ge(Yt),literal:Dt,string:di,docString:ge(di),character:ge(di),attributeValue:ge(di),number:Li,integer:ge(Li),float:ge(Li),bool:ge(Dt),regexp:ge(Dt),escape:ge(Dt),color:ge(Dt),url:ge(Dt),keyword:Pt,self:ge(Pt),null:ge(Pt),atom:ge(Pt),unit:ge(Pt),modifier:ge(Pt),operatorKeyword:ge(Pt),controlKeyword:ge(Pt),definitionKeyword:ge(Pt),moduleKeyword:ge(Pt),operator:St,derefOperator:ge(St),arithmeticOperator:ge(St),logicOperator:ge(St),bitwiseOperator:ge(St),compareOperator:ge(St),updateOperator:ge(St),definitionOperator:ge(St),typeOperator:ge(St),controlOperator:ge(St),punctuation:ci,separator:ge(ci),bracket:ii,angleBracket:ge(ii),squareBracket:ge(ii),paren:ge(ii),brace:ge(ii),content:It,heading:Lt,heading1:ge(Lt),heading2:ge(Lt),heading3:ge(Lt),heading4:ge(Lt),heading5:ge(Lt),heading6:ge(Lt),contentSeparator:ge(It),list:ge(It),quote:ge(It),emphasis:ge(It),strong:ge(It),link:ge(It),monospace:ge(It),strikethrough:ge(It),inserted:ge(),deleted:ge(),changed:ge(),invalid:ge(),meta:ni,documentMeta:ge(ni),annotation:ge(ni),processingInstruction:ge(ni),definition:he.defineModifier(),constant:he.defineModifier(),function:he.defineModifier(),standard:he.defineModifier(),local:he.defineModifier(),special:he.defineModifier()},Ti=Ke([{tag:Ye.link,class:"tok-link"},{tag:Ye.heading,class:"tok-heading"},{tag:Ye.emphasis,class:"tok-emphasis"},{tag:Ye.strong,class:"tok-strong"},{tag:Ye.keyword,class:"tok-keyword"},{tag:Ye.atom,class:"tok-atom"},{tag:Ye.bool,class:"tok-bool"},{tag:Ye.url,class:"tok-url"},{tag:Ye.labelName,class:"tok-labelName"},{tag:Ye.inserted,class:"tok-inserted"},{tag:Ye.deleted,class:"tok-deleted"},{tag:Ye.literal,class:"tok-literal"},{tag:Ye.string,class:"tok-string"},{tag:Ye.number,class:"tok-number"},{tag:[Ye.regexp,Ye.escape,Ye.special(Ye.string)],class:"tok-string2"},{tag:Ye.variableName,class:"tok-variableName"},{tag:Ye.local(Ye.variableName),class:"tok-variableName tok-local"},{tag:Ye.definition(Ye.variableName),class:"tok-variableName tok-definition"},{tag:Ye.special(Ye.variableName),class:"tok-variableName2"},{tag:Ye.definition(Ye.propertyName),class:"tok-propertyName tok-definition"},{tag:Ye.typeName,class:"tok-typeName"},{tag:Ye.namespace,class:"tok-namespace"},{tag:Ye.className,class:"tok-className"},{tag:Ye.macroName,class:"tok-macroName"},{tag:Ye.propertyName,class:"tok-propertyName"},{tag:Ye.operator,class:"tok-operator"},{tag:Ye.comment,class:"tok-comment"},{tag:Ye.meta,class:"tok-meta"},{tag:Ye.invalid,class:"tok-invalid"},{tag:Ye.punctuation,class:"tok-punctuation"}])},98104:(yn,Wt,q)=>{q.d(Wt,{G:()=>X});const m="\u037C",Se=typeof Symbol=="undefined"?"__"+m:Symbol.for(m),he=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),B=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};class X{constructor(ht,xt){this.rules=[];let{finish:Ke}=xt||{};function it(gt){return/^@/.test(gt)?[gt]:gt.split(/,\s*/)}function _e(gt,fi,Zt,ge){let ct=[],Yt=/^@(\w+)\b/.exec(gt[0]),wi=Yt&&Yt[1]=="keyframes";if(Yt&&fi==null)return Zt.push(gt[0]+";");for(let ui in fi){let Dt=fi[ui];if(/&/.test(ui))_e(ui.split(/,\s*/).map(di=>gt.map(Li=>di.replace(/&/,Li))).reduce((di,Li)=>di.concat(Li)),Dt,Zt);else if(Dt&&typeof Dt=="object"){if(!Yt)throw new RangeError("The value of a property ("+ui+") should be a primitive value.");_e(it(ui),Dt,ct,wi)}else Dt!=null&&ct.push(ui.replace(/_.*/,"").replace(/[A-Z]/g,di=>"-"+di.toLowerCase())+": "+Dt+";")}(ct.length||wi)&&Zt.push((Ke&&!Yt&&!ge?gt.map(Ke):gt).join(", ")+" {"+ct.join(" ")+"}")}for(let gt in ht)_e(it(gt),ht[gt],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let ht=B[Se]||1;return B[Se]=ht+1,m+ht.toString(36)}static mount(ht,xt,Ke){let it=ht[he],_e=Ke&&Ke.nonce;it?_e&&it.setNonce(_e):it=new Fe(ht,_e),it.mount(Array.isArray(xt)?xt:[xt])}}let Ae=new Map;class Fe{constructor(ht,xt){let Ke=ht.ownerDocument||ht,it=Ke.defaultView;if(!ht.head&&ht.adoptedStyleSheets&&it.CSSStyleSheet){let _e=Ae.get(Ke);if(_e)return ht.adoptedStyleSheets=[_e.sheet,...ht.adoptedStyleSheets],ht[he]=_e;this.sheet=new it.CSSStyleSheet,ht.adoptedStyleSheets=[this.sheet,...ht.adoptedStyleSheets],Ae.set(Ke,this)}else{this.styleTag=Ke.createElement("style"),xt&&this.styleTag.setAttribute("nonce",xt);let _e=ht.head||ht;_e.insertBefore(this.styleTag,_e.firstChild)}this.modules=[],ht[he]=this}mount(ht){let xt=this.sheet,Ke=0,it=0;for(let _e=0;_e<ht.length;_e++){let gt=ht[_e],fi=this.modules.indexOf(gt);if(fi<it&&fi>-1&&(this.modules.splice(fi,1),it--,fi=-1),fi==-1){if(this.modules.splice(it++,0,gt),xt)for(let Zt=0;Zt<gt.rules.length;Zt++)xt.insertRule(gt.rules[Zt],Ke++)}else{for(;it<fi;)Ke+=this.modules[it++].rules.length;Ke+=gt.rules.length,it++}}if(!xt){let _e="";for(let gt=0;gt<this.modules.length;gt++)_e+=this.modules[gt].getRules()+`
`;this.styleTag.textContent=_e}}setNonce(ht){this.styleTag&&this.styleTag.getAttribute("nonce")!=ht&&this.styleTag.setAttribute("nonce",ht)}}}}]);})();

//# sourceMappingURL=9743.7e4a2f35.chunk.js.map